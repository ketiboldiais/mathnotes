# 𝑢-Substitution

In terms of symbolic manipulation, integration is much, much harder &mdash;
if not impossible &mdash; compared to differentiation. As such, whenever we
divine integrals, we must always do so gently and carefully. Fortunately,
there are a few methods that can help us accomplish the task. One such
method is the **method of substitution**. To illustrate this method,
consider the following problem:

> **problem**. Evaluate the indefinite integral:
>
> $$
> 	\int x^3(x^4 + 2)^5 dx
> $$

On its face, it looks like we can apply the power rule backwards. The
trouble, however, is that fifth power. Expanding the ${(x^4+2)^5}$ is
messy.[^messy_note]

[^messy_note]:
    It comes out to:
    ${ x^{20} + 10x^{16} + 40x^{12} + 80x^8 + 80x^4 + 32 }$

The idea is to first define a new function for the messiest term:

$$
	u = x^4 + 2
$$

Then we differentiate:

$$
	\begin{aligned} d(u) &= d(x^4 + 2) \\ du &= 4x^3~dx \end{aligned}
$$

We can then _substitute_ to simplify the indefinite integral. First, since
${u = x^4 + 2,}$ we substitute:

$$
	\begin{aligned} \int x^3(x^4+2)^5~dx &= \int \textcolor{firebrick}{(x^4 + 2)}^5 x^3~dx\\ &= \textcolor{firebrick}{u}^5 x^3~dx \end{aligned}
$$

Next, given that ${du = 4x^3~dx,}$ we know that:

$$
	\dfrac{du}{4} = x^3~dx
$$

Thus:

$$
	\begin{aligned} \int x^3(x^4+2)^5~dx &= \int \textcolor{firebrick}{(x^4 + 2)}^5 \textcolor{teal}{x^3~dx}\\ &= \textcolor{firebrick}{u}^5 \cdot \textcolor{teal}{\dfrac{1}{4}~du} \end{aligned}
$$

Thus, we have the integral:

$$
	\int \dfrac{u^5~du}{4}
$$

This is much easier to integrate:

$$
	\int \dfrac{u^5~du}{4} = \dfrac{1}{24} u^6 + C
$$

Now we have to change back to our original variable ${x.}$ Since we
substituted ${u = x^4 + 2,}$ we have:

$$
	\int x^3(x^4 + 2)^5~dx = \dfrac{1}{24}(x^4 + 2)^6 + C
$$

## Premonitory Substitution

Sometimes, the substitution method is either (1) too long to perform, or
(2) doesn't appear to yield further progress. For example, consider the
following problem:

> **problem**. Evaluate the indefinite integral:
>
> $$
> 	\int \dfrac{x~dx}{\sqrt{1+x^2}}
> $$

In this case, let's substitute ${1+x^2:}$

$$
	u = 1+x^2
$$

Differentiating, we get:

$$
	\begin{aligned} d(u) &= d(1+x^2) \\ du &= 2x~dx \end{aligned}
$$

Expressing ${x~dx}$ in terms of ${du:}$

$$
	\dfrac{du}{2} = x~dx
$$

And substituting all our findings:

$$
	\int \dfrac{\dfrac{du}{2}}{\sqrt{u}} = \int \dfrac{1}{2} \cdot \dfrac{du}{\sqrt{u}}
$$

This doesn't seem to have helped. We've gotten an integral that looks just
as nasty as the original. Fortunately, there's a modified version of the
subsitution we can use &mdash; **premonitory substitution**. The idea is
that we first look at the integral:

$$
	\int \dfrac{x~dx}{\sqrt{1+x^2}}
$$

We easily see that the troublesome part is that radicand in the bottom, so
we make a _guess_, or _premonition_, that the substituted form will look
something like:

$$
	(1+x^2)^{\frac{1}{2}}
$$

With this guess, we just differentiate and see if it works:

$$
	\begin{aligned} \dfrac{d}{dx} [(1+x^2)^{\frac{1}{2}}] &= \dfrac{1}{2}(1+x^2)^{- \frac{1}{2}}(2x) \\[1em] &= \dfrac{x}{\sqrt{1+x^2}} \end{aligned}
$$

Lo and behold, there's our original expression. The answer is thus:

$$
	\int \dfrac{x~dx}{\sqrt{1+x^2}} = \dfrac{x}{\sqrt{1+x^2}} + C
$$

Let's look at another example:

$$
	\int e^{6x}~dx
$$

We start with a guess for the answer:

$$
	e^{6x}
$$

If we differentiate this answer:

$$
	\dfrac{d}{dx}(e^{6x}) = 6e^{6x}
$$

Just looking at this derivative, all we have to do is get rid of the ${6.}$
Thus, the answer is:

$$
	\int e^{6x}~dx = \dfrac{1}{6}e^{6x} + C
$$

Let's look at another example:

> **problem**. Evaluate the indefinite integral:
>
> $$
> 	\int xe^{-x^2}~dx
> $$

Let's start with a guess:

$$
	e^{-x^2}
$$

Differentiating this guess:

$$
	\dfrac{d}{dx}e^{-x^2} = e^{-x^2}(-2x)
$$

Examining this derivative, we see that we're off by a factor of ${-2.}$ So,
we have the derivative:

$$
	\int xe^{-x^2}~dx = - \dfrac{1}{2} e^{-x^2} + C
$$

Let's look at another problem.

> **problem**. Evaluate the indefinite integral:
>
> $$
> 	\int \sin x \cos x ~dx
> $$

We begin with a guess.

$$
	\sin^2 x
$$

Then we differentiate:

$$
	\dfrac{d}{dx} \sin^2 x = 2 \sin x \cos x
$$

We see that we're off by a factor of ${2,}$ so our answer is:

$$
	\int \sin x \cos x~dx = \dfrac{1}{2}\sin^2 x + C
$$

This problem, however, could've been approached differently and yielded a
different answer. If our guess were instead:

$$
	\cos^2x
$$

we would've gotten the derivative:

$$
	\dfrac{d}{dx} \cos^2x = 2 \cos x(- \sin x)
$$

Thus, another answer is:

$$
	\int \sin x \cos x~dx = -\dfrac{1}{2} \cos^2x + C
$$

This is interesting. How are we getting two different answers? It turns out
that these two answers are actually just different forms of the answer. If
we set the answers equal to one another:

$$
	\begin{aligned} \dfrac{1}{2} \sin^2 x + C_1 &= -\dfrac{1}{2} \cos^2 x + C_2 \\[1em] \left(\dfrac{1}{2} \sin^2 x + C_1\right) - \left(-\dfrac{1}{2} \cos^2 x + C_2\right) &= 0 \\[1em] \dfrac{1}{2} \sin^2 x + C_1 + \dfrac{1}{2} \cos^2 x - C_2 &= 0 \\[1em] \dfrac{1}{2} \sin^2 x + \dfrac{1}{2} \cos^2 x + C_1 - C_2 &= 0 \\[1em] \dfrac{1}{2}(\sin^2 x + \cos^2 x) + C_1 - C_2 &= 0 \\[1em] \dfrac{1}{2}(1) + C_1 - C_2 &= 0 \\[1em] C_1 - C_2 &= -\dfrac{1}{2} \\[1em] \end{aligned}
$$

The difference between the two answers is a constant. In other words, the
only difference between these two answers is their constant ${C.}$ This
tells us that the two formulas:

$$
	\begin{aligned} &(\text{1a})~~~~\int \sin x \cos x~dx = -\dfrac{1}{2} \cos^2x + C \\[1.5em] &(\text{1b})~~~~\int \sin x \cos x~dx = \dfrac{1}{2}\sin^2 x + C \end{aligned}
$$

are different forms of the answer, merely differing from one another by
${-\dfrac{1}{2}.}$

Here's another example:

> **problem**. Evaluate the indefinite integral:
>
> $$
> 	\int \dfrac{dx}{x \ln x}
> $$

Here, we might be tempted to make a guess, but this is best solved with
just plain substitution. Remember, premonitory substitution is what we use
when it's apparent that plain substitution doesn't work. Recall what we
said earlier about integration: _We must take care when integrating._

_Do not_ rush into premonitory substitution. Here, a clear substitution is:

$$
	u = \ln x
$$

The differential here is simpler:

$$
	du = \dfrac{dx}{x}
$$

Applying the substitution:

$$
	\begin{aligned} \int \dfrac{dx}{x \ln x} &= \int \underbrace{\dfrac{1}{\ln x}}_{\dfrac{1}{u}} ~\cdot~ \underbrace{\dfrac{dx}{x}}_{\normalsize du} \\[4em] &= \int \dfrac{du}{u} \end{aligned}
$$

Evaluating the substituted integral:

$$
	\int \dfrac{du}{u} = \ln u + C
$$

Re-substituting:

$$
	\begin{aligned} \int \dfrac{du}{u} &= \ln u + C \\[1em] &= \ln (\ln x) + C \end{aligned}
$$

Thus, we have the answer:

$$
	\int \dfrac{dx}{x \ln x} = \ln (\ln x) + C
$$

Or more correctly:

$$
	\int \dfrac{dx}{x \ln x} = \ln\lvert \ln x \rvert + C
$$
