# Quadratic Approximations

When linear approximations are insufficient, we must turn to _quadratic
approximations_. For example, in economics and finance, models often rely
on logarithmic or quadratic scales to reduce complexity. Understanding
these models requires reducing computations to quadratic approximations.

Quadratic approximations are just an extension of linear approximations.
We're merely taking an extra step in detail. The general formula:

$$
	f(x) \approx f(x_0) + f'(x_0) \cdot (x-x_0) + \dfrac{f''(x_0)}{2}(x-x_0)^2
$$

Where is that ${(1/2)f''(0)}$ factor coming from? Recall that a parabola is
a quadratic. For the parabola's quadratic approximation to work, it must be
itself:

$$
	f(x) = a + bx + cx^2
$$

Differentiating the function above:

$$
	f'(x) = b + 2cx
$$

Differentiating a second time:

$$
	f''(x) = 2c
$$

Next, we want to determine ${a,}$ ${b,}$ and ${c}$ by evaluating the
formula at zero:

$$
	\begin{aligned} f(0) = a + b(0) + c(0)^2 = a \\ f'(0) = b + 2c(0) = b \\ f''(0) = 2c \end{aligned}
$$

Notice that the final approximation, ${f''(0)}$ is ${2c.}$ To recover ${c}$
then, we must divide by ${2.}$

$$
	\begin{aligned} f''(0) &= 2c \\[1em] \dfrac{f''(0)}{2} &= c \end{aligned}
$$

We now have our ${c}$ term: ${c = \dfrac{f''(0)}{2}.}$ This explains why we
see the ${1/2}$ term in our quadratic approximation formula:

$$
	f(x) \approx f(x_0) + f'(x_0) \cdot (x - x_0) + \dfrac{f''(x_0)}{2}(x - x_0)^2
$$

Notice that this really is just the linear approximation formula, with the
additional term of a second derivative and a factor of ${2.}$ The linear
part is the first portion, as we've seen, and the quadratic part is the
second portion. Let's apply the formula above to the functin
${f(x) = \ln(1+x).}$ Recall that the linear approximation for this function
is ${\ln(1+x) \approx x.}$ Following our formula, we begin by laying out
the derivatives:

$$
	\begin{aligned} &f(x) = \ln(1+x) \\[1em] &f'(x) = \dfrac{1}{1+x} \\[1em] &f''(x) = -\dfrac{1}{(1+x)^2} \end{aligned}
$$

Then, we evaluate the functions at ${0.}$

$$
	f(0) = 0 \\ f'(0) = 1 \\ f''(0) = -1
$$

Applying our formula, we get:

$$
	\begin{aligned} \ln(1+x) &\approx 0 + 1 \cdot (x - 0) + \dfrac{-1}{2}(x - 0)^2 \\[1em] &\approx x - \dfrac{x^2}{2} \end{aligned}
$$

Thus, we have the quadratic approximation

$$
	\ln(1+x) \approx x - \dfrac{x^2}{2}
$$

Applying the formula above to ${\ln(1.1),}$ we have:

$$
	\begin{aligned} \ln(1.1) &= \ln \left(1 + \dfrac{1}{10}\right) \\[1em] &\approx \dfrac{1}{10} - \dfrac{1}{2}\left( \dfrac{1}{10} \right)^2 &\approx 0.095 \end{aligned}
$$

Recall that ${\ln(1.1) = 0.095310179804325.}$ With quadratic approximation,
we gain a little more accuracy.

Next, let's consider the quadratic approximation for ${f(x) = (1+x)^r.}$
Again we lay out the derivatives:

$$
	\begin{aligned} &f(x) = (1+x)^r \\ &f'(x) = r(1+x)^{r-1} \\ &f''(x) = r(r-1)(x+1)^{r-2} \end{aligned}
$$

Evaluating at ${x = 0,}$ we get:

$$
	\begin{aligned} &f(0) = (1+0) = 1 \\ &f'(0) = r(1+0)^{r-1} = r \\ &f''(0) = r(r-1)(0+1)^{r-2} = r(r-1) \end{aligned}
$$

Plugging in these findings to our quadratic approximation formula, we have:

$$
	\begin{aligned} (1 + x)^r &\approx 1 + r(x-0) + \dfrac{r(r-1)}{2}(x-0)^2 \\[1em] (1 + x)^r &\approx 1 + rx + \dfrac{r(r-1)}{2}x^2 \\[1em] \end{aligned}
$$

Hence, we have the quadratic approximation:

$$
	(1 + x)^r \approx 1 + rx + \dfrac{r(r-1)}{2}x^2
$$

Let's examine the other functions we saw for linear approximation. To do
so, we must gather all of the terms we need:

| ${f}$      | ${f'}$       | ${f''}$      | ${f(0)}$       | ${f'(0)}$        | ${f''(0)}$        |
| ---------- | ------------ | ------------ | -------------- | ---------------- | ----------------- |
| ${\sin x}$ | ${\cos x}$   | ${- \sin x}$ | ${\sin 0 = 0}$ | ${\cos 0 = 1}$   | ${- \sin 0 = 0}$  |
| ${\cos x}$ | ${- \sin x}$ | ${- \cos x}$ | ${\cos 0 = 1}$ | ${- \sin 0 = 0}$ | ${- \cos 0 = -1}$ |
| ${e^x}$    | ${e^x}$      | ${e^x}$      | ${e^0 = 1}$    | ${e^0 = 1}$      | ${e^0 = 1}$       |

Applying the information above, we have the following quadratic
approximations:

$$
	\large \left. \begin{aligned} &\sin x \approx x \\[1em] &\cos x \approx 1 - \dfrac{1}{2}x^2 \\[1em] &e^x \approx 1 + x + \dfrac{1}{2}x^2 \end{aligned} ~\right\vert_{x \approx 0}
$$

Recall that, where ${a_k = \left( 1 + \dfrac{1}{k} \right)^2,}$ we have:

$$
	\lim\limits_{k \to \infty}a_k = e
$$

We determined by first taking the logarithm of both sides:

$$
	\begin{aligned} \ln(a_k) &= k \cdot \ln \left( 1 + \dfrac{1}{k} \right)^2 \\[1em] \end{aligned}
$$

Then, applying the limit:

$$
	\begin{aligned} \ln(a_k) &= \lim\limits_{k \to \infty} k \cdot \ln \left( 1 + \dfrac{1}{k} \right)^2 \\[1em] &= e \end{aligned}
$$

We can achieve the same result with quadratic approximation by first
applying linear approximation. First, we know that:

$$
	\ln(1 + x) \approx x ~\text{ where }~ x = \dfrac{1}{k} \approx 0
$$

It follows then that:

$$
	\begin{aligned} \ln a_k &= k \left( 1 + \dfrac{1}{k} \right) \\[1em] &\approx k \cdot \dfrac{1}{k} \end{aligned}
$$

Thus we have:

$$
	\begin{aligned} \ln a_k &= k \cdot \ln \left( 1 + \dfrac{1}{k} \right) \\[1em] & \approx k \cdot \dfrac{1}{k} \end{aligned}
$$

The value ${k(1/k)}$ is easy to evaluate. It's just ${1.}$ This the linear
approximation.

$$
	\ln\left(\left(1 + \dfrac{1}{k}\right)^2\right) \approx 1
$$

Question: What is the rate of convergence for ${\ln a_k?}$ In other words,
how fast does:

$$
	\ln a_k = k \cdot \ln(1 + \dfrac{1}{k})
$$

approach ${1?}$ Let's rephrase the question by rewriting the expression:

$$
	\ln a_k \to 1 \\[1em] \ln a_k - 1 \to 1 - 1 \\[1em] \underbrace{\ln a_k - 1}_{\text{How big is this?}} \to 0
$$

The answer lies in quadratic approximation.

Again, all of the approximations above depend on the assumption that ${x}$
is near ${0.}$ Summarizing our approximation formulas:

| Function       | Approximation Formula             |
| -------------- | --------------------------------- |
| ${\sin x}$     | ${x}$                             |
| ${\cos x}$     | ${1 - \dfrac{1}{2}x^2}$           |
| ${e^x}$        | ${1 + x + \dfrac{1}{2}x^2}$       |
| ${\ln(1 + x)}$ | ${x - \dfrac{1}{2}x^2}$           |
| ${(1 + x)^2}$  | ${1 + rx + \dfrac{r(r-1)}{2}x^2}$ |

Quadratic approximations can get very nasty. Accordingly, we should only
resort to them if we truly aren't satisfied with a linear approximation.
Consider the following problem:

> Problem. Find the the quadratic approximation for the function
> ${f(x) = e^{-3x}(1+x)^{-1/2}}$ where ${x}$ is near ${0.}$

Carrying out the approximation with the approximation formulas above, we
have:

$$
	\begin{aligned} e^{-3x}(1+x)^{-1/2} &\approx \left(1 + (-3x) + \dfrac{(-3x)^2}{2}\right) \left(1 - \dfrac{1}{2}x + \dfrac{1}{2}\left(- \dfrac{1}{2}\right)\left(- \dfrac{3}{2}\right)x^2\right)\\[1em] & \approx 1 - 3x - \dfrac{1}{2}x + \dfrac{3}{2}x^2 + \dfrac{9}{2}x^2 + \dfrac{3}{8}x^2 \end{aligned}
$$

If we applied the approximation formulas in their entirety, we'd notice
that there are some missing terms. These terms were dropped. Why? Because
these higher order terms get so small that they're negligible. Simplifying
the aproximation above, we have:

$$
	e^{-3x}(1+x)^{-1/2} \approx 1 - \dfrac{7}{2}x + \dfrac{51}{8}x^2
$$

Notice that the term ${1 - \dfrac{7}{2}x}$ is the linear approximation. The
additional term, ${\dfrac{51}{8}x^2}$ is the additional term we obtain from
quadratic approximation.
