import t,{useMemo as e,useRef as n,useEffect as i}from"react";import{scaleLinear as r,max as a,area as s,range as o,scaleBand as l,pie as h,arc as c,stratify as u,tree as d,linkHorizontal as m,cluster as p}from"d3";import f from"@matejmazur/react-katex";import{Canvas as g,useThree as y}from"@react-three/fiber";const x=({className:e="",width:n=200,height:i=200,cwidth:r=100,cheight:a=i/n,margins:s=[10,10,10,10],children:o})=>{const l=e?`hago ${e}`:"hago",h=s[0],c=s[1],u=s[2],d=s[3],m=`0 0 ${n-d-c+d+c} ${i-h-u+h+u}`,p={display:"block",position:"relative",width:`${r}%`,paddingBottom:r*a+"%",backgroundColor:"inherit",overflow:"hidden"};return t.createElement("figure",{className:l},t.createElement("div",{className:"hago_svg_container",style:p},t.createElement("svg",{style:{display:"inline-block",position:"absolute",top:0,left:0},className:"hago_svg",viewBox:m,preserveAspectRatio:"xMinYMin meet"},t.createElement("g",{className:"svgElement",transform:`translate(${d}, ${h})`},o))))},_=({id:e,className:n,arrowColor:i,refX:r=-5,refY:a=0,width:s=6,height:o=6,orient:l="auto"})=>t.createElement("marker",{id:e,className:n,viewBox:"0 -5 10 10",refX:r,refY:a,orient:l,markerWidth:s,markerHeight:o},t.createElement("path",{d:"M0,-5L10,0L0,5Z",fill:i}));function v({val:e,block:n=!0}){return n?t.createElement(f,{block:!0},`${e}`):t.createElement(f,null,`${e}`)}const w=({text:e,width:n=50,offset:i={x:0,y:0},dx:r=0,dy:a=0,height:s=50,fontsize:o=.7,color:l="black",fitContent:h=!1,textAlign:c="center",block:u=!0})=>t.createElement("g",{transform:`translate(${i.x}, ${i.y})`,dx:r,dy:a},t.createElement("foreignObject",{width:n,height:s},t.createElement("div",{style:{fontSize:`${o}rem`,textAlign:`${c}`,height:h?"fit-content":"",width:h?"fit-content":"",padding:0,margin:0,color:l}},t.createElement(v,{val:`${e}`,block:u}))));function M({val:e,fontSize:n=.8,color:i="black",pos:r={x:0,y:0},dx:a=0,dy:s=0,width:o=50,height:l=50,fitContent:h=!1,textAlign:c="center",latex:u=!0,anchor:d="middle",block:m=!0}){return u?t.createElement(w,{text:`${e}`,offset:{x:r.x,y:r.y},fitContent:h,color:i,dx:a,dy:s,width:o,height:l,fontsize:n,textAlign:c,block:m}):t.createElement("text",{textAnchor:d,x:r.x,y:r.y,dx:a,dy:s,fontSize:`${n}rem`,fill:i},e)}const b=({domain:n,range:i,tickSep:a=50,markerStart:s,markerEnd:o,removeEndTicks:l=!0,dx:h=0,dy:c=0,tx:u=0,axisLabelArray:d,fitContent:m=!0,latex:p=!0,textAnchor:f="middle",fontsize:g=.6})=>{const y=e((()=>{const t=r().domain(n).range(i),e=i[1]-i[0],s=a,o=Math.max(1,Math.floor(e/s));return t.ticks(o).map((e=>({value:e,xOffset:t(e)+u})))}),[n.join("-"),i.join("-")]);return t.createElement("g",{className:"hago_x_axis"},t.createElement("path",{d:["M",i[0],1,"v",-1,"H",i[1],"v",1].join(" "),fill:"none",stroke:"black",markerStart:`url(#${s})`,markerEnd:`url(#${o})`}),y.map((({value:e,xOffset:n},i)=>t.createElement("g",{key:e,transform:`translate(${n}, 0)`},!l||0!==i&&i!==y.length-1?t.createElement("line",{y1:-3,y2:3,stroke:"currentColor"}):t.createElement(t.Fragment,null),p?t.createElement(M,{val:d&&d[i]?d[i]:e,pos:{x:h,y:c},fitContent:m,fontSize:.6}):t.createElement("text",{dx:h,y:c,textAnchor:f,fontSize:`${g}rem`},e)))))},E=({domain:n,range:i,tickSep:a=50,markerStart:s,markerEnd:o,removeEndTicks:l=!0,dx:h=0,dy:c=0,offsetTick:u=0,fitContent:d=!0,latex:m=!0,textAnchor:p="end",fontsize:f=.6})=>{const g=e((()=>{const t=r().domain(n).range(i),e=i[0]-i[1],s=a,o=Math.max(1,Math.floor(e/s));return t.ticks(o).map((e=>({value:e,yOffset:t(e)+u})))}),[n.join("-"),i.join("-")]);return t.createElement("g",{className:"hago_y_axis"},t.createElement("path",{d:["M",i[1],-1,"H",0,"v",i[0],"H",0].join(" "),fill:"none",stroke:"black",markerStart:`url(#${s})`,markerEnd:`url(#${o})`}),g.map((({value:e,yOffset:n},i)=>t.createElement("g",{key:e,transform:`translate(0, ${n})`},!l||0!==i&&i!==g.length-1?t.createElement("line",{x1:-3,x2:3,stroke:"currentColor"}):t.createElement(t.Fragment,null),m?t.createElement(M,{val:e,pos:{x:h,y:c},fontSize:.6,fitContent:d}):t.createElement("text",{dx:h,y:c,textAnchor:p,fontSize:`${f}rem`},e)))))},k=(t,e,n)=>{const i=n[0],r=n[1],a=n[2];return{width:t-n[3]-r,height:e-i-a}};function S(t="hago"){return`${t}_${Date.now()}`}function A(t,e){return`translate(${t}, ${e})`}function z(t){return void 0!==t}function N(t){return void 0===t}function T(t){return null!==t}function C(t){return null===t}function L(t){return"string"==typeof t}const $=t=>{let e=t;return!("object"!=typeof t||null===t)&&(()=>{for(;null!==Object.getPrototypeOf(e=Object.getPrototypeOf(e)););return Object.getPrototypeOf(t)===e})()};function P(t){return t.constructor===Function}function R(t){return!isNaN(t)&&"number"==typeof t}function B(t){return t.constructor===Array}function I(t,e){return N(t)?e:`${e} ${t}`}function O(t,e,n){return T(t)&&z(t)?e:n}function D(t){let e=[];for(let n=0;n<t.length;n++){let i=t[n];if($(i))e.push(i);else{let t={val:i};e.push(t)}}return e}function F(t){let e=[];for(let n=0;n<t.length;n++){let i=t[n];if($(i))i.data||(i.data=1),e.push(i);else{let t={val:i,data:1};e.push(t)}}return e}function V(t){let e=[];for(let n=0;n<t.length;n++)if($(t[n]))e.push(t[n]);else{let i={child:t[n][0],parent:t[n][1]};e.push(i)}return e}const j=t=>{let e=[];const n={child:t[0][0],parent:""};let i,r,a,s,o;e.push(n);for(let n=0;n<t.length;n++)o=t[n][0],i=t[n][1][0],r=t[n][1][1],a=C(i)?{child:"",parent:o,hide:!0}:$(i)?{child:i.val,parent:o,...i}:{child:i,parent:o},e.push(a),s=C(r)?{child:"",parent:o,hide:!0}:$(r)?{child:r.val,parent:o,...r}:{child:r,parent:o},e.push(s);return e};function q({cx:e,cy:n,r:i,fill:r,stroke:a}){return t.createElement("circle",{cx:e,cy:n,r:i,fill:r,stroke:a})}function H({fill:e="black"}){return t.createElement("path",{d:"M0,-5L10,0L0,5Z",fill:e})}const U=({id:e,type:n="arrow",className:i,arrowColor:r,radius:a,refX:s=a,refY:o=a,width:l,height:h,cx:c,cy:u,circleFillColor:d="white",circleStrokeColor:m="black",orient:p,viewbox:f="0 -5 10 10"})=>t.createElement("marker",{id:e,className:i,viewBox:f,refX:s,refY:o,orient:p,markerWidth:l,markerHeight:h},(()=>{switch(n){case"arrow":return t.createElement(H,{fill:r});case"circle":return t.createElement(q,{cx:c,cy:u,r:a,fill:d,stroke:m});default:return t.createElement(t.Fragment,null)}})());function W(t,e=25){const n=[1],i=function(t,e){e.children&&e.children.length>0&&(n.length<=t+1&&n.push(0),n[t+1]+=e.children.length,e.children.forEach((function(e){i(t+1,e)})))};i(0,t);return a(n)*e}function Y(t){var e,n,i,r,a;return(null===(n=null===(e=null==t?void 0:t.source)||void 0===e?void 0:e.data)||void 0===n?void 0:n.hide)||(null===(r=null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.data)||void 0===r?void 0:r.hide)||(null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.hide)?"none":"block"}function X({start:e,end:n,color:i="black",strokeWidth:r=1,dash:a=0,markerEnd:s,markerStart:o,shapeRendering:l="auto"}){return t.createElement("line",{x1:e.x,x2:n.x,y1:e.y,y2:n.y,stroke:i,strokeWidth:r,strokeDasharray:a,markerEnd:s?`url(#${s})`:"",markerStart:o?`url(#${o})`:"",shapeRendering:l})}function Z(t,e){return t<e?t:e}function G(t,e){return t>e?t:e}function J(t){return Math.floor(t)===t?0:t.toString().split(".")[1].length||0}function Q(t){let e=-1/0;const n=t.length;for(let i=0;i<n;i++){const n=J(t[i]);e=n>e?n:e}return e}function K(t){let e=t.length,n=e,i=-1/0;for(;e--;)t[e]>i&&(i=t[e],n=e);return{max:i,atIndex:n}}function tt(t){return K(t).max+5/10**(Q(t)+1)}function et(t){let e=t.length,n=e,i=1/0;for(;e--;)t[e]<i&&(i=t[e],n=e);return{min:i,atIndex:n}}function nt(t){return et(t).min-5/10**(Q(t)+1)}function it(t){return t.reduce(((t,e)=>(t[e]=++t[e]||1,t)),{})}function rt(t){const e=t.length,n=it(t);for(let t in n)n[t]=n[t]/e;return n}function at(t){let e=rt(t),n=[],i=[],r=0;for(let t in e)i.push(e[t]),n.push(t),r++;let a={};a[n[0]]=i[0];let s=i[0];for(let t=1;t<r;t++)s=i[t]+a[n[t-1]],a[n[t]]=s;return a}function st(t){const e=Math.sqrt(t);return Math.round(e)}function ot(t){const e=t.length;let n=0;for(let i=0;i<e;i++)n+=t[i];return n}function lt(t){return ot(t)/t.length}function ht(t){if(isNaN(t))return!1;let e=parseFloat(`${t}`);return(0|e)===e}function ct(t){if(ht(t)){return!(1&Math.abs(t))}throw new Error("Value passed is not an integer.")}function ut(t,e,n){let i=t[n],r=e;for(let a=e;a<n;a++)t[a]<i&&([t[a],t[r]]=[t[r],t[a]],r++);return[t[r],t[n]]=[t[n],t[r]],r}function dt(t){let e=[],n=t.length;for(e.push(0),e.push(n-1);e[e.length-1]>=0;){let n=e.pop(),i=e.pop(),r=ut(t,i,n);r-1>i&&(e.push(i),e.push(r-1)),r+1<n&&(e.push(r+1),e.push(n))}return t}function mt(t){const e=dt(t),n=t.length;let i;if(ct(n)){const e=n/2;i=t[e]+t[e+1]>>1}else{i=t[(n+1)/2]}return{median:i,orderedList:e}}function pt(t){let e=1/0;const n=t.length;for(let i=0;i<n;i++){const n=J(t[i]);e=n<e?n:e}return e}function ft(t){const e=t.length,n=Q(t);let i;for(let r=0;r<e;r++){const e=t[r];J(t[r])>=n&&(i=e)}return i}function gt(t,e){let n=[];const i=t.length;for(let r=0;r<i;r++){const i=t[r];J(t[r])===e&&n.push(i)}return n}function yt(t){return K(gt(t,Q(t)))}function xt(t){return et(gt(t,Q(t)))}function _t(t){if(ht(t)){return!!(1&Math.abs(t))}throw new Error("Value passed is not an integer.")}function vt(t,e=-1e4,n=1e4,i=-1e3,r=1e3){return(t-e)/(n-e)*(r-i)+i}function wt(t,e){let n=t%2,i=t>>1,r=`${n}`,a=[r];for(;0!==i;)n=i%2,i>>=1,r=`${n}`,a.push(r);const s=a.length-1;let o="";e&&e>s&&(o=bt(e-=s,o));for(let t=s;t>=0;t--)o+=a[t];return o}function Mt(t,e){let n=t%16,i=t>>4,r=Et(n),a=[r];for(;i>0;)n=i%16,i>>=4,r=n>9&&n<16?Et(n):`${n}`,a.push(r);const s=a.length;let o="0×";if(e&&e>s){o=bt(e-s,o)}for(let t=s-1;t>=0;t--)o+=a[t];return o}function bt(t,e){for(let n=0;n<t;n++)e+="0";return e}function Et(t){switch(t){case 10:return"A";case 11:return"B";case 12:return"C";case 13:return"D";case 14:return"E";case 15:return"F";default:return`${t}`}}function kt(t){let e,n,i,r,a,s,o,l;for(l=t,o=Math.floor(l),n=1,a=0,e=o,r=1;l-o>1e-8*r*r;)l=1/(l-o),o=Math.floor(l),i=n,n=e,s=a,a=r,e=i+o*n,r=s+o*a;return{numerator:e,denominator:r}}function St(t){return Array.isArray(t)&&Array.isArray(t[0][1])}function At(t){return void 0!==t.source&&void 0!==t.source}function zt(t){return void 0!==t.val}function Nt(t){return z(t.f)}function Tt(t){return void 0!==t.link}function Ct(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t}function Lt(t){return z(t.y)}function $t(t){return z(t.x)&&z(t.y)}function Pt(t){return z(t.a&&z(t.val))}function Rt(t){return z(t.x)&&z(t.y)&&z(t.g)}function Bt(t){return B(t)&&2===t.length&&R(t[0])&&R(t[1])}function It(t,e){return n=>{for(let i=0;i<e.length;i++)if(void 0===t(n)[e[i]])return!1;return!0}}pt([1.12,1.14,1.21,1.2,2.3,2.12,2.14]);const Ot=It((t=>t),["startPull","endPull","end"]);function Dt(t){return`C${t.startPull.x},${t.startPull.y} ${t.endPull.x},${t.endPull.y} ${t.end.x},${t.end.y}`}const Ft=It((t=>t),["pull","end"]);function Vt(t){return`Q${t.pull.x},${t.pull.y} ${t.end.x}${t.end.y}`}const jt=It((t=>t),["rx","ry","xRotation","end"]);function qt(t){return`A${t.rx},${t.ry} ${t.xRotation} ${t.end.x},${t.end.y}`}const Ht=It((t=>t),["M"]);function Ut(t){return`L${t.L.x},${t.L.y}`}const Wt=It((t=>t),["L"]);function Yt(t){return`H${t.H.x},${t.H.y}`}const Xt=It((t=>t),["H"]),Zt=It((t=>t),["V"]);function Gt(t){return`V${t.V.x},${t.V.y}`}function Jt({start:e,d:n,fill:i="none",color:r="black",strokeWidth:a=1}){const s=function(t,e){if(Ht(t)){let i=`M${(n=t).M.x},${n.M.y}`;for(let t=0;t<e.length;t++){let n=e[t];Wt(n)?i+=Ut(n):Xt(n)?i+=Yt(n):Zt(n)?i+=Gt(n):Ot(n)?i+=Dt(n):Ft(n)?i+=Vt(n):jt(n)&&(i+=qt(n))}return i}throw new Error("Invalid start value entered");var n}(e,n);return t.createElement("path",{fill:i,stroke:r,strokeWidth:a,d:s})}function Qt({w:e,h:n,pos:i={x:0,y:0},fill:r="none",stroke:a="black"}){return t.createElement("rect",{width:e,height:n,x:i.x,y:i.y,fill:r,stroke:a})}const Kt=Math.PI,te=2*Kt,ee=te-1e-6;function ne(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ie(){return new ne}function re(t){return function(){return t}}function ae(t){this._context=t}function se(t){return new ae(t)}function oe(t){return t[0]}function le(t){return t[1]}function he(t,e){var n=re(!0),i=null,r=se,a=null;function s(s){var o,l,h,c=(s=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(s)).length,u=!1;for(null==i&&(a=r(h=ie())),o=0;o<=c;++o)!(o<c&&n(l=s[o],o,s))===u&&((u=!u)?a.lineStart():a.lineEnd()),u&&a.point(+t(l,o,s),+e(l,o,s));if(h)return a=null,h+""||null}return t="function"==typeof t?t:void 0===t?oe:re(t),e="function"==typeof e?e:void 0===e?le:re(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:re(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:re(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:re(!!t),s):n},s.curve=function(t){return arguments.length?(r=t,null!=i&&(a=r(i)),s):r},s.context=function(t){return arguments.length?(null==t?i=a=null:a=r(i=t),s):i},s}ne.prototype=ie.prototype={constructor:ne,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,s=this._y1,o=n-t,l=i-e,h=a-t,c=s-e,u=h*h+c*c;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>1e-6)if(Math.abs(c*o-l*h)>1e-6&&r){var d=n-a,m=i-s,p=o*o+l*l,f=d*d+m*m,g=Math.sqrt(p),y=Math.sqrt(u),x=r*Math.tan((Kt-Math.acos((p+u-f)/(2*g*y)))/2),_=x/y,v=x/g;Math.abs(_-1)>1e-6&&(this._+="L"+(t+_*h)+","+(e+_*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>h*m)+","+(this._x1=t+v*o)+","+(this._y1=e+v*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,a){t=+t,e=+e,a=!!a;var s=(n=+n)*Math.cos(i),o=n*Math.sin(i),l=t+s,h=e+o,c=1^a,u=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+h:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-h)>1e-6)&&(this._+="L"+l+","+h),n&&(u<0&&(u=u%te+te),u>ee?this._+="A"+n+","+n+",0,1,"+c+","+(t-s)+","+(e-o)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=h):u>1e-6&&(this._+="A"+n+","+n+",0,"+ +(u>=Kt)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}},ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var ce=de(se);function ue(t){this._curve=t}function de(t){function e(e){return new ue(t(e))}return e._curve=t,e}function me(){return function(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(de(t)):e()._curve},t}(he().curve(ce))}ue.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};const pe=(e,n,i,r,a,s)=>{const o=e.domain?e.domain:a,l=e.image?e.image:s,h=function(t,e=2e3,n,i){let r,a,s=[];const o="function"==typeof t,l="number"==typeof t;let h=2*i[0],c=2*i[1];const u=n[1];for(let i=-e;i<e;i++){if(l)r=t,a=i;else{if(!o)throw new Error("Data must be a function or a number.");r=i/e*u,a=t(r)}(isNaN(a)||a<=h||a>=c)&&(a=null),r<n[0]||n[1]<r||s.push({x:r,y:a})}return s}(e.f,r,o,l),c=he().y((t=>i(t.y))).defined((t=>null!==t.y)).x((t=>n(t.x)))(h);return t.createElement("path",{d:c,stroke:e.color||"red",strokeWidth:e.w||1,fill:"none",strokeDasharray:e.dash,shapeRendering:"geometricPrecision"})},fe=(e,n,i,r=2e3,a=[-10,10])=>{const s=function(t,e,n=1e3,i=[-10,10]){let r=[];const a=i[1]*Math.PI,s="function"==typeof t,o="number"==typeof t,l="function"==typeof e,h="number"==typeof e;let c;for(let i=-n;i<n;i++){if(s&&l){let r=i*Math.PI/n*a;c={x:t(r),y:e(r)}}else if(s&&h)c={x:t(i*Math.PI/n*a),y:e};else{if(!l||!o)throw new Error("Improper parametric function format");c={x:t,y:e(i*Math.PI/n*a)}}const u=isNaN(c.y),d=isNaN(c.x);u&&(c.y=null),d&&(c.x=null),r.push(c)}return r}(e.x,e.y,r,a),o=he().y((t=>i(t.y))).defined((t=>null!==t.y)).x((t=>n(t.x))).defined((t=>null!==t.x))(s);return t.createElement("path",{d:o,stroke:"red",fill:"none",shapeRendering:"geometricPrecision"})},ge=(e,n,i,r=1e3,a=[-10,10])=>{let o,l,h,c=e.integrate[0]===-1/0?a[0]:e.integrate[0],u=e.integrate[1]===1/0?a[1]:e.integrate[1],d=e.integrate[2];o="y"===d?0:"x"===d?()=>0:d,e.x&&e.y?(l=e.x,h=e.y):(l=t=>t,h=e.f);const m=function(t,e,n,i,r,a=1e3,s=[-10,10]){let o,l,h,c,u=[];const d="function"==typeof n,m="number"==typeof n,p="function"==typeof e,f="number"==typeof e;for(let g=-a;g<a;g++){let y=g/a*s[1];if("number"==typeof e&&"number"==typeof n)o=e,l=n,h=g,c=g;else if(p&&m)o=t(y),l=n,h=e(o),c=h;else if(f&&d)o=y,l=y,h=0,c=n(l);else{if(!p||!d)throw new Error("Data must be a function or a number.");o=t(y),l=y,h=e(y),c=n(y)}(isNaN(h)||isNaN(c))&&(h=null,c=null),r<y&&y<i&&u.push({x0:o,x1:l,y0:h,y1:c})}return u}(l,h,o,u,c,r,a),p=s().defined((t=>null!==t.y0&&null!==t.y1)).x0((t=>n(t.x0))).y0((t=>i(t.y0))).x1((t=>n(t.x1))).y1((t=>i(t.y1)))(m);return t.createElement("path",{d:p,fill:e.integrationColor||"gold",opacity:.4,stroke:"orange",strokeWidth:1})},ye=(t,e,n,i)=>{let r=[];const a=t.f,s=t.riemann,o=s.i?s.i:i,l=s.dx,h=o[0],c=o[1],u=s.color?s.color:"#54BAB9";let d;const m=s.m?s.m:"midpoint";if("left"===m)d=t=>t/2;else if("right"===m)d=t=>-t/2;else{if("midpoint"!==m)throw new Error(`Invalid m value. Got ${m}, expected: (left|right|midpoint)`);d=t=>t}let p,f=s.f,g=s.orient;if("function"==typeof f||"number"==typeof f)p=f;else if("x"===f)p=0;else{if("y"!==f)throw new Error("Unrecognized riemannData.f value");p=()=>0}const y="function"==typeof p;for(let t=h;t<c;t+=l){let i=t,s=e(i),o=e(i),l={x1:s,y1:n(a(i)),x2:o,y2:n(y?p(i):p),color:u,orientation:g};r.push(l)}const x=r.length;let _,v=0;do{if(void 0===_)_=r[0];else{_=r[v];let t=r[v-1],e=r[v+1]?r[v+1]:r[v],n=_.x1-t.x1;t.r=n,e.r=n,t.tx=d(n),e.tx=d(n)}v++}while(v<x);return r},xe=(t,e,n,i)=>{let r=[];const a=t.x,s=t.y,o=t.riemann,l=o.i?o.i:i,h=o.dx,c=l[0],u=l[1],d=o.color?o.color:"#54BAB9";let m;const p=o.m?o.m:"midpoint";if("left"===p)m=t=>t/2;else if("right"===p)m=t=>-t/2;else{if("midpoint"!==p)throw new Error(`Invalid m value. Got ${p}, expected: (left|right|midpoint)`);m=t=>t}let f,g=o.f;if("function"==typeof g||"number"==typeof g)f=g;else if("x"===g)f=0;else{if("y"!==g)throw new Error("Unrecognized riemannData.xFunction value");f=()=>0}const y="function"==typeof f;let x=[];for(let t=c;t<u;t+=h){let i=t,r=a(i),o=s(i),l={x1:e(r),y1:n(o)};x.push(l)}let _=[];for(let t=c;t<u;t+=h){let i={x2:e(t),y2:n(y?f(t):f)};_.push(i)}const v=x.length;for(let t=0;t<v;t++){let e={x1:x[t].x1,y1:x[t].y1,x2:_[t].x2,y2:_[t].y2,color:d};r.push(e)}const w=r.length;let M,b=0;do{if(void 0===M)M=r[0];else{M=r[b];let t=r[b-1],e=r[b+1]?r[b+1]:r[b],n=M.x1-t.x1;t.r=n,e.r=n,t.tx=m(n),e.tx=m(n)}b++}while(b<w);return r};function _e(t){let e;return e="string"==typeof t?{t:t}:t,e}function ve(t,e){const n=function(t,e){const n=t[0],i=t[1],r=e[0],a=e[1];return parseFloat(((a-i)/(r-n)).toFixed(8))}(t,e),i=t[0],r=t[1]-n*i;let a,s,o=r<0?"-":"+";if(ht(n))a=`${n}`;else{const t=kt(n),e=t.denominator,i=t.numerator;a=`\\dfrac{${Math.abs(e)}}{${Math.abs(i)}}`}if(ht(r))s=`${Math.abs(r)}`;else{const t=kt(r),e=t.denominator,n=t.numerator;s=`\\dfrac{${Math.abs(e)}}{${Math.abs(n)}}`}return{f:t=>n*t+r,formula:`y = ${a}x ${o} ${s}`}}const we=({data:e=[],className:n="Plot2",id:i=S(n),domain:a=[-10,10],range:s=[-10,10],ticks:o=4,xTicks:l=o,yTicks:h=o,axesLabels:c=["𝒙","𝒚"],samples:u,width:d=500,height:m=500,scale:p=100,cwidth:f=p,cheight:g,marginTop:y=30,marginRight:_=30,marginBottom:v=30,marginLeft:M=30,margins:z=[y,_,v,M]})=>{let T=[],C=[],L=[],$=[],P=[],R=[],B=[];const{width:I,height:O}=k(d,m,z),D=10*l,F=10*h,V=r().domain(a).range([0,I]),j=r().domain(s).range([O,0]),q=c[0]?_e(c[0]):_e("x"),H=c[1]?_e(c[1]):_e("x");for(let t=0;t<e.length;t++){let n=e[t];if(n.f){let t=pe(n,V,j,u,a,s);T.push(t),n.secant&&"function"==typeof n.f&&Me(n,R,a,$,V,j,B)}if(n.t&&(n.w=n.w||100,n.h=n.h||100,n.x=n.x||0,n.y=n.y||0,$.push(n)),n.riemann&&n.f){let t=ye(n,V,j,a);P.push(t)}if(n.riemann&&n.x&&n.y){let t=xe(n,V,j,a);P.push(t)}if(n.integrate){let t=ge(n,V,j,u,a);C.push(t)}if(n.p&&R.push(n),n.x&&n.y&&N(n.t)){let t=fe(n,V,j,u,a);T.push(t)}}return P=!!P&&P.flat(),t.createElement(x,{className:n,width:d,height:m,cwidth:f,cheight:g,margins:z},t.createElement("g",{className:"Plot",style:{transformOrigin:"center"}},t.createElement("defs",null,t.createElement("clipPath",{id:`${i}_Plot_clipPath`},t.createElement("rect",{width:I,height:O}))),t.createElement("g",{transform:A(0,j(0)),className:"hago_XAxis"},function(e,n,i){return t.createElement(b,{domain:e,range:[0,n],tickSep:i,dx:0,dy:20,markerStart:e[0]&&"xArrowLeft",markerEnd:e[1]&&"xArrowRight",fitContent:!0,latex:!1})}(a,I,D),q&&function(e,n){return t.createElement("text",{dx:e.x||n+10,dy:e.y||4,textAnchor:e.textAnchor||"start"},e.t)}(q,I)),t.createElement("g",{transform:A(V(0),0),className:"hago_YAxis"},function(e,n,i){return t.createElement(E,{domain:e,range:[n,0],tickSep:i,dy:5,dx:-10,markerStart:e[1]&&"yArrowUp",markerEnd:e[0]&&"yArrowDown",latex:!1})}(s,O,F),H&&function(e){return t.createElement("text",{dx:e.x||0,dy:e.y||-10,textAnchor:e.textAnchor||"middle"},e.t)}(H)),B&&B.map(((e,n)=>t.createElement("g",{key:`sc${i}_${n}`,className:`${e.className}`},t.createElement("path",{d:e.pathDatum,stroke:e.color,fill:"none"})))),R&&function(e,n,i,r){return e.map(((e,a)=>t.createElement("g",{key:`pp${n}_${a}`,transform:A(i(e.p[0]),r(e.p[1])),className:e.class||"hago_PlotPoint"},t.createElement("circle",{r:e.r||2,stroke:e.c||"tomato",fill:e.in?"none":e.c||"tomato"}),e.label&&t.createElement("text",{x:e.dx||1,y:-e.dy||-5,fontSize:"0.7rem"},e.label))))}(R,i,V,j),T&&function(e,n){return e.map(((e,i)=>t.createElement("g",{key:`li${n}_${i}`,clipPath:`url(#${n}_Plot_clipPath)`,className:"hago_PlotPath"},e)))}(T,i),C&&function(e,n){return e.map(((e,i)=>t.createElement("g",{key:`ar${n}_${i}`,clipPath:`url(#${n}_Plot_clipPath)`,className:"integration_area"},e)))}(C,i),L&&function(e,n){return e.map(((e,i)=>t.createElement("g",{key:`ve${n}_${i}`,clipPath:`url(#${n}_Plot_clipPath)`},e)))}(L,i),$&&function(e,n,i,r){return e.map(((e,a)=>t.createElement("g",{key:`ap${n}_${a}`},t.createElement(w,{text:e.t,offset:{x:i(e.x),y:r(e.y)},fontsize:e.fontsize||.8,dx:0,dy:0,width:e.w,height:e.h,color:e.color||"black",fitContent:!0,textAlign:"center",block:!1}))))}($,i,V,j),P&&function(e,n){return e.map(((e,i)=>t.createElement("g",{key:`rm${n}${i}`,className:"riemann_sums",transform:A(e.tx,0),clipPath:`url(#${n}_Plot_clipPath)`},t.createElement("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.color,strokeOpacity:.1,strokeWidth:e.r}),t.createElement("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.color,strokeOpacity:.6,strokeWidth:e.r-1}))))}(P,i)))};function Me(t,e,n,i,r,a,s){let o=t.secant,l=o.class?o.class:"hago_SecantLine",h=o.renderFormula,c=o.x0,u=o.x1,d=t.f(c),m=t.f(u),p=o.c||"teal";const f=[c,d],g=[u,m];o.renderPoints&&(e.push({p:f,label:`(${c}, ${d})`}),e.push({p:g,label:`(${u}, ${m})`}));const y=ve(f,g),x=y.f,_=y.formula;let v=n[0],w=n[1],M=x(v),b=x(w);if(h){const t=function(t,e){const n=t[0],i=t[1];return{x:(e[0]+n)/2,y:(e[1]+i)/2}}(f,g),e={t:_,w:100,h:100,x:t.x,y:t.y,color:"teal"};i.push(e)}v=r(v),M=a(M),c=r(c),d=a(d),u=r(u),m=a(m),w=r(w),b=a(b);let E=`M${v} ${M} L${c} ${d} L${u} ${m} L${w} ${b}`;s.push({pathDatum:E,color:p,className:l})}function be(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ee(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ke(t){let e,n,i;function r(t,i,r=0,a=t.length){if(r<a){if(0!==e(i,i))return a;do{const e=r+a>>>1;n(t[e],i)<0?r=e+1:a=e}while(r<a)}return r}return 2!==t.length?(e=be,n=(e,n)=>be(t(e),n),i=(e,n)=>t(e)-n):(e=t===be||t===Ee?t:Se,n=t,i=t),{left:r,center:function(t,e,n=0,a=t.length){const s=r(t,e,n,a-1);return s>n&&i(t[s-1],e)>-i(t[s],e)?s-1:s},right:function(t,i,r=0,a=t.length){if(r<a){if(0!==e(i,i))return a;do{const e=r+a>>>1;n(t[e],i)<=0?r=e+1:a=e}while(r<a)}return r}}}function Se(){return 0}const Ae=ke(be).right;ke((function(t){return null===t?NaN:+t})).center;var ze=Ae;class Ne extends Map{constructor(t,e=Ce){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(Te(this,t))}has(t){return super.has(Te(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const i=e(n);t.has(i)&&(n=t.get(i),t.delete(i));return n}(this,t))}}function Te({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function Ce(t){return null!==t&&"object"==typeof t?t.valueOf():t}var Le=Math.sqrt(50),$e=Math.sqrt(10),Pe=Math.sqrt(2);function Re(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=Le?10:a>=$e?5:a>=Pe?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=Le?10:a>=$e?5:a>=Pe?2:1)}function Be(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(r);++i<r;)a[i]=t+i*n;return a}function Ie(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const Oe=Symbol("implicit");function De(){var t=new Ne,e=[],n=[],i=Oe;function r(r){let a=t.get(r);if(void 0===a){if(i!==Oe)return i;t.set(r,a=e.push(r)-1)}return n[a%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Ne;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return r},r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return De(e,n).unknown(i)},Ie.apply(r,arguments),r}function Fe(){var t,e,n=De().unknown(void 0),i=n.domain,r=n.range,a=0,s=1,o=!1,l=0,h=0,c=.5;function u(){var n=i().length,u=s<a,d=u?s:a,m=u?a:s;t=(m-d)/Math.max(1,n-l+2*h),o&&(t=Math.floor(t)),d+=(m-d-t*(n-l))*c,e=t*(1-l),o&&(d=Math.round(d),e=Math.round(e));var p=Be(n).map((function(e){return d+t*e}));return r(u?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),u()):i()},n.range=function(t){return arguments.length?([a,s]=t,a=+a,s=+s,u()):[a,s]},n.rangeRound=function(t){return[a,s]=t,a=+a,s=+s,o=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,u()):o},n.padding=function(t){return arguments.length?(l=Math.min(1,h=+t),u()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),u()):l},n.paddingOuter=function(t){return arguments.length?(h=+t,u()):h},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},n.copy=function(){return Fe(i(),[a,s]).round(o).paddingInner(l).paddingOuter(h).align(c)},Ie.apply(u(),arguments)}function Ve(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function je(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function qe(){}var He=1/.7,Ue="\\s*([+-]?\\d+)\\s*",We="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xe=/^#([0-9a-f]{3,8})$/,Ze=new RegExp(`^rgb\\(${Ue},${Ue},${Ue}\\)$`),Ge=new RegExp(`^rgb\\(${Ye},${Ye},${Ye}\\)$`),Je=new RegExp(`^rgba\\(${Ue},${Ue},${Ue},${We}\\)$`),Qe=new RegExp(`^rgba\\(${Ye},${Ye},${Ye},${We}\\)$`),Ke=new RegExp(`^hsl\\(${We},${Ye},${Ye}\\)$`),tn=new RegExp(`^hsla\\(${We},${Ye},${Ye},${We}\\)$`),en={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function nn(){return this.rgb().formatHex()}function rn(){return this.rgb().formatRgb()}function an(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Xe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?sn(e):3===n?new cn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?on(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?on(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ze.exec(t))?new cn(e[1],e[2],e[3],1):(e=Ge.exec(t))?new cn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Je.exec(t))?on(e[1],e[2],e[3],e[4]):(e=Qe.exec(t))?on(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ke.exec(t))?gn(e[1],e[2]/100,e[3]/100,1):(e=tn.exec(t))?gn(e[1],e[2]/100,e[3]/100,e[4]):en.hasOwnProperty(t)?sn(en[t]):"transparent"===t?new cn(NaN,NaN,NaN,0):null}function sn(t){return new cn(t>>16&255,t>>8&255,255&t,1)}function on(t,e,n,i){return i<=0&&(t=e=n=NaN),new cn(t,e,n,i)}function ln(t){return t instanceof qe||(t=an(t)),t?new cn((t=t.rgb()).r,t.g,t.b,t.opacity):new cn}function hn(t,e,n,i){return 1===arguments.length?ln(t):new cn(t,e,n,null==i?1:i)}function cn(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function un(){return`#${fn(this.r)}${fn(this.g)}${fn(this.b)}`}function dn(){const t=mn(this.opacity);return`${1===t?"rgb(":"rgba("}${pn(this.r)}, ${pn(this.g)}, ${pn(this.b)}${1===t?")":`, ${t})`}`}function mn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function pn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fn(t){return((t=pn(t))<16?"0":"")+t.toString(16)}function gn(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new _n(t,e,n,i)}function yn(t){if(t instanceof _n)return new _n(t.h,t.s,t.l,t.opacity);if(t instanceof qe||(t=an(t)),!t)return new _n;if(t instanceof _n)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),s=NaN,o=a-r,l=(a+r)/2;return o?(s=e===a?(n-i)/o+6*(n<i):n===a?(i-e)/o+2:(e-n)/o+4,o/=l<.5?a+r:2-a-r,s*=60):o=l>0&&l<1?0:s,new _n(s,o,l,t.opacity)}function xn(t,e,n,i){return 1===arguments.length?yn(t):new _n(t,e,n,null==i?1:i)}function _n(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function vn(t){return(t=(t||0)%360)<0?t+360:t}function wn(t){return Math.max(0,Math.min(1,t||0))}function Mn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Ve(qe,an,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:nn,formatHex:nn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return yn(this).formatHsl()},formatRgb:rn,toString:rn}),Ve(cn,hn,je(qe,{brighter(t){return t=null==t?He:Math.pow(He,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new cn(pn(this.r),pn(this.g),pn(this.b),mn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:un,formatHex:un,formatHex8:function(){return`#${fn(this.r)}${fn(this.g)}${fn(this.b)}${fn(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:dn,toString:dn})),Ve(_n,xn,je(qe,{brighter(t){return t=null==t?He:Math.pow(He,t),new _n(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new _n(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new cn(Mn(t>=240?t-240:t+120,r,i),Mn(t,r,i),Mn(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new _n(vn(this.h),wn(this.s),wn(this.l),mn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=mn(this.opacity);return`${1===t?"hsl(":"hsla("}${vn(this.h)}, ${100*wn(this.s)}%, ${100*wn(this.l)}%${1===t?")":`, ${t})`}`}}));var bn=t=>()=>t;function En(t){return 1==(t=+t)?kn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):bn(isNaN(e)?n:e)}}function kn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):bn(isNaN(t)?e:t)}var Sn=function t(e){var n=En(e);function i(t,e){var i=n((t=hn(t)).r,(e=hn(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),s=kn(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function An(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}}function zn(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),s=new Array(i);for(n=0;n<r;++n)a[n]=Rn(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<r;++n)s[n]=a[n](t);return s}}function Nn(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Tn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Cn(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Rn(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var Ln=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$n=new RegExp(Ln.source,"g");function Pn(t,e){var n,i,r,a=Ln.lastIndex=$n.lastIndex=0,s=-1,o=[],l=[];for(t+="",e+="";(n=Ln.exec(t))&&(i=$n.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),o[s]?o[s]+=r:o[++s]=r),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:Tn(n,i)})),a=$n.lastIndex;return a<e.length&&(r=e.slice(a),o[s]?o[s]+=r:o[++s]=r),o.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)o[(n=l[i]).i]=n.x(t);return o.join("")})}function Rn(t,e){var n,i=typeof e;return null==e||"boolean"===i?bn(e):("number"===i?Tn:"string"===i?(n=an(e))?(e=n,Sn):Pn:e instanceof an?Sn:e instanceof Date?Nn:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?An:Array.isArray(e)?zn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Cn:Tn)(t,e)}function Bn(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function In(t){return+t}var On=[0,1];function Dn(t){return t}function Fn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Vn(t,e,n){var i=t[0],r=t[1],a=e[0],s=e[1];return r<i?(i=Fn(r,i),a=n(s,a)):(i=Fn(i,r),a=n(a,s)),function(t){return a(i(t))}}function jn(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=Fn(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(e){var n=ze(t,e,1,i)-1;return a[n](r[n](e))}}function qn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Hn(){var t,e,n,i,r,a,s=On,o=On,l=Rn,h=Dn;function c(){var t=Math.min(s.length,o.length);return h!==Dn&&(h=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(s[0],s[t-1])),i=t>2?jn:Vn,r=a=null,u}function u(e){return null==e||isNaN(e=+e)?n:(r||(r=i(s.map(t),o,l)))(t(h(e)))}return u.invert=function(n){return h(e((a||(a=i(o,s.map(t),Tn)))(n)))},u.domain=function(t){return arguments.length?(s=Array.from(t,In),c()):s.slice()},u.range=function(t){return arguments.length?(o=Array.from(t),c()):o.slice()},u.rangeRound=function(t){return o=Array.from(t),l=Bn,c()},u.clamp=function(t){return arguments.length?(h=!!t||Dn,c()):h!==Dn},u.interpolate=function(t){return arguments.length?(l=t,c()):l},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,c()}}function Un(){return Hn()(Dn,Dn)}function Wn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Yn(t){return(t=Wn(Math.abs(t)))?t[1]:NaN}var Xn,Zn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gn(t){if(!(e=Zn.exec(t)))throw new Error("invalid format: "+t);var e;return new Jn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Jn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Qn(t,e){var n=Wn(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Gn.prototype=Jn.prototype,Jn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Kn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Qn(100*t,e),r:Qn,s:function(t,e){var n=Wn(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(Xn=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return a===s?i:a>s?i+new Array(a-s+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+Wn(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ti(t){return t}var ei,ni,ii,ri=Array.prototype.map,ai=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function si(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?ti:(e=ri.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],s=0,o=e[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),a.push(t.substring(r-=o,r+o)),!((l+=o+1)>i));)o=e[s=(s+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?ti:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ri.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"−":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=Gn(t)).fill,n=t.align,u=t.sign,d=t.symbol,m=t.zero,p=t.width,f=t.comma,g=t.precision,y=t.trim,x=t.type;"n"===x?(f=!0,x="g"):Kn[x]||(void 0===g&&(g=12),y=!0,x="g"),(m||"0"===e&&"="===n)&&(m=!0,e="0",n="=");var _="$"===d?r:"#"===d&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",v="$"===d?a:/[%p]/.test(x)?l:"",w=Kn[x],M=/[defgprs%]/.test(x);function b(t){var r,a,l,d=_,b=v;if("c"===x)b=w(t)+b,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:w(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==u&&(E=!1),d=(E?"("===u?u:h:"-"===u||"("===u?"":u)+d,b=("s"===x?ai[8+Xn/3]:"")+b+(E&&"("===u?")":""),M)for(r=-1,a=t.length;++r<a;)if(48>(l=t.charCodeAt(r))||l>57){b=(46===l?s+t.slice(r+1):t.slice(r))+b,t=t.slice(0,r);break}}f&&!m&&(t=i(t,1/0));var k=d.length+t.length+b.length,S=k<p?new Array(p-k+1).join(e):"";switch(f&&m&&(t=i(S+t,S.length?p-b.length:1/0),S=""),n){case"<":t=d+t+b+S;break;case"=":t=d+S+t+b;break;case"^":t=S.slice(0,k=S.length>>1)+d+t+b+S.slice(k);break;default:t=S+d+t+b}return o(t)}return g=void 0===g?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),b.toString=function(){return t+""},b}return{format:u,formatPrefix:function(t,e){var n=u(((t=Gn(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Yn(e)/3))),r=Math.pow(10,-i),a=ai[8+i/3];return function(t){return n(r*t)+a}}}}function oi(t,e,n,i){var r,a=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=Le?r*=10:a>=$e?r*=5:a>=Pe&&(r*=2),e<t?-r:r}(t,e,n);switch((i=Gn(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Yn(e)/3)))-Yn(Math.abs(t)))}(a,s))||(i.precision=r),ii(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Yn(e)-Yn(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Yn(Math.abs(t)))}(a))||(i.precision=r-2*("%"===i.type))}return ni(i)}function li(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,a,s,o=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(s=Re(t,e,n))||!isFinite(s))return[];if(s>0){let n=Math.round(t/s),i=Math.round(e/s);for(n*s<t&&++n,i*s>e&&--i,a=new Array(r=i-n+1);++o<r;)a[o]=(n+o)*s}else{s=-s;let n=Math.round(t*s),i=Math.round(e*s);for(n/s<t&&++n,i/s>e&&--i,a=new Array(r=i-n+1);++o<r;)a[o]=(n+o)/s}return i&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return oi(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,a=e(),s=0,o=a.length-1,l=a[s],h=a[o],c=10;for(h<l&&(r=l,l=h,h=r,r=s,s=o,o=r);c-- >0;){if((r=Re(l,h,n))===i)return a[s]=l,a[o]=h,e(a);if(r>0)l=Math.floor(l/r)*r,h=Math.ceil(h/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,h=Math.floor(h*r)/r}i=r}return t},t}function hi(){var t=Un();return t.copy=function(){return qn(t,hi())},Ie.apply(t,arguments),li(t)}ei=si({thousands:",",grouping:[3],currency:["$",""]}),ni=ei.format,ii=ei.formatPrefix;const ci=({data:e=[],domain:n=[0,2*Math.PI],className:i="Hago_Polar",width:r=500,height:a=500,radius:s=Math.min(r,a)/2-40,scale:l=100,cwidth:h=l,cheight:c,marginTop:u=20,marginRight:d=20,marginBottom:m=20,marginLeft:p=20,margins:f=[u,d,m,p]})=>{const g=function(t,e){const n=e.f;let i=[];return o(t[0],t[1],.01).map((t=>{let e=[t,n(t)];i.push(e)})),i}(n,e[0]),y=k(r,a,f),_=hi().domain([0,.5]).range([0,s]),v=_.ticks(5).slice(1),w=Be(0,360,30),M=me().radius((t=>_(t[1]))).angle((t=>-t[0]+Math.PI/2))(g);return t.createElement(x,{className:i,width:r,height:a,cwidth:h,cheight:c,margins:f},t.createElement("g",{className:"hago_polar_plot",transform:`translate(${y.width/2}, ${y.height/2})`},t.createElement("g",{className:"hago_polar_plot_r_axis"},v.map(((e,n)=>t.createElement("g",{className:"hago_polar_plot_r_axis_ticks",key:`hago_plot_${n}`},t.createElement("circle",{r:_(e),stroke:"lightgrey",fill:"none"}),t.createElement("text",{y:-_(e)-4,transform:"rotate(15)",textAnchor:"middle",fontSize:"0.7rem"},e))))),t.createElement("g",{className:"hago_polar_plot_a_axis"},w.map((e=>t.createElement("g",{transform:`rotate(${-e})`},t.createElement("line",{x2:s,stroke:"lightgrey",strokeDasharray:4}),t.createElement("text",{x:s+6,dy:"0.35em",textAnchor:e<270&&e>90?"end":null,fontSize:"0.7rem",transform:e<270&&e>90?`rotate(180 ${s+6}, 0)`:null},`${e}°`))))),t.createElement("g",{className:"hago_polar_plot_function_plot"},t.createElement("path",{fill:"none",stroke:"red",d:M}))))};function ui({width:e,height:n,stroke:i,fill:r,className:a}){return t.createElement("rect",{width:e,height:n,stroke:i,fill:r,className:a})}const di=({data:e=["f()","g()","h()"],className:n="hago_stack",id:i=S(n),fheight:r=30,fwidth:a=70,width:s=350,height:o=e.length*r,scale:l=100,cwidth:h=l,cheight:c,marginTop:u=10,marginRight:d=10,marginBottom:m=10,marginLeft:p=10,margins:f=[u,d,m,p]})=>{const g=k(s,o,f),y=D(e),v=y.length,w=hi().domain([0,v]).range([0,g.height]);return t.createElement(x,{className:n,width:s,height:o,cwidth:h,cheight:c,margins:f},t.createElement("g",null,t.createElement("defs",null,t.createElement(_,{id:"stackFramePointerArrow",arrowColor:"black",refX:10,refY:0,width:6,height:6})),y.map(((e,n)=>t.createElement("g",{key:`stack_frame_${i}_${n}`,transform:A(g.width/2,w(n)),className:I(e.className,"stack_frame")},t.createElement(ui,{width:a,height:r-10,stroke:"black",fill:"none"}),t.createElement("text",{dx:a/2,textAnchor:"middle",dy:r/2,fontSize:"0.8rem"},e.val),e.ant&&t.createElement("text",{dx:a+5,textAnchor:"start",dy:r/2,fontSize:"0.8rem"},e.ant),e.ptr&&function(e,n,i){return t.createElement("g",{className:"stack_frame_pointer",transform:A(0,e/2-5)},t.createElement(X,{start:{x:-n/3,y:0},end:{x:0,y:0},color:"black",markerEnd:"stackFramePointerArrow"}),t.createElement("text",{fontSize:"0.6rem",dx:-n/2.8,dy:2.5,textAnchor:"end"},i.ptr))}(r,a,e))))))};function mi(t){const e=xn(t+80,.7,.5).rgb();return`rgb(${e.r}, ${e.g}, ${e.b})`}function pi(t,e,n){const i=t.f,r=t.scale?t.scale:1;let a=e[0],s=e[1],o=n[0],l=n[1],h=[];for(let t=a;t<s;t++){let e=[];h.push(e);for(let n=o;n<l;n++)e.push(i(t,n)*r)}return h}function fi(t,e,n){let i=[],r=Math.cos(n),a=Math.sin(n),s=Math.cos(e),o=Math.sin(e);return i[0]=s,i[1]=0,i[2]=o,i[3]=a*o,i[4]=r,i[5]=-a*s,i[6]=-o*r,i[7]=a,i[8]=r*s,[i[0]*t[0]+i[1]*t[1]+i[2]*t[2],i[3]*t[0]+i[4]*t[1]+i[5]*t[2],i[6]*t[0]+i[7]*t[1]+i[8]*t[2]]}function gi(t,e,n,i,r){let a=t,s=function(t=[],e,n,i){let r=t,a=[],s=[],o=function(t){let e,n,i=t,r=[],a=i.length,s=i[0].length;for(let t=0;t<a;t++){r.push(e=[]);for(let r=0;r<s;r++)n=[i[t][r]],e.push(n)}return r}(t),l=r.length,h=r[0].length;for(let t=0;t<l;t++){a.push(s=[]);for(let r=0;r<h;r++)s.push(fi([(t-l/2)/l*e,o[t][r],(r-h/2)/h*e],n,i))}return a}(t,e,i,r),o=s.length,l=s[0].length;const h=e/2,c=n/2;let u,d,m,p,f,g,y,x,_,v,w,M,b=[];for(d=0;d<o-1;d++)for(m=0;m<l-1;m++)u=s[d][m][2]+s[d+1][m][2]+s[d+1][m+1][2]+s[d][m+1][2],p=(s[d][m][0]+h).toFixed(10),f=(s[d][m][1]+c).toFixed(10),g=(s[d+1][m][0]+h).toFixed(10),y=(s[d+1][m][1]+c).toFixed(10),x=(s[d+1][m+1][0]+h).toFixed(10),_=(s[d+1][m+1][1]+c).toFixed(10),v=(s[d][m+1][0]+h).toFixed(10),w=(s[d][m+1][1]+c).toFixed(10),M=`M ${p},${f} L${g},${y}, L${x},${_} L${v},${w} Z`,b.push({path:M,depth:u,data:a[d][m]});return b.sort(((t,e)=>e.depth-t.depth)),b}function yi({data:e=[{f:(t,e)=>t**2-e**2}],id:n,width:i=600,height:r=600,scale:a=100,cwidth:s=a,cheight:o,marginTop:l=60,marginRight:h=60,marginBottom:c=60,marginLeft:u=60,margins:d=[l,h,c,u],xDomain:m=[-20,20],yDomain:p=[-20,20],yRotate:f=.2,zRotate:g=.4}){const y=k(i,r,d);let _,v,w=[];for(let t=0;t<e.length;t++)_=pi(e[t],m,p),v=gi(_,y.width,y.height,f,g),w.push(v);return t.createElement(x,{className:"hago_multiplot",width:i,height:r,cwidth:s,cheight:o,margins:d},t.createElement("g",{className:"multiplot_canvas"},w.map(((e,i)=>t.createElement("g",{key:`${n}_multiplot_${i}`},e.map(((e,i)=>t.createElement("path",{d:e.path,fill:mi(e.data),key:`${n}_${i}`}))))))))}
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const xi=0,_i=1,vi=2,wi=0,Mi=1,bi=2,Ei=3;class ki{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}const Si=[];for(let t=0;t<256;t++)Si[t]=(t<16?"0":"")+t.toString(16);function Ai(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Si[255&t]+Si[t>>8&255]+Si[t>>16&255]+Si[t>>24&255]+"-"+Si[255&e]+Si[e>>8&255]+"-"+Si[e>>16&15|64]+Si[e>>24&255]+"-"+Si[63&n|128]+Si[n>>8&255]+"-"+Si[n>>16&255]+Si[n>>24&255]+Si[255&i]+Si[i>>8&255]+Si[i>>16&255]+Si[i>>24&255]).toLowerCase()}function zi(t,e,n){return Math.max(e,Math.min(n,t))}function Ni(t,e,n){return(1-n)*t+n*e}class Ti{constructor(t=0,e=0){this.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*n-a*i+t.x,this.y=r*i+a*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ci{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,a,s,o,l){const h=this.elements;return h[0]=t,h[1]=i,h[2]=s,h[3]=e,h[4]=r,h[5]=o,h[6]=n,h[7]=a,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,a=n[0],s=n[3],o=n[6],l=n[1],h=n[4],c=n[7],u=n[2],d=n[5],m=n[8],p=i[0],f=i[3],g=i[6],y=i[1],x=i[4],_=i[7],v=i[2],w=i[5],M=i[8];return r[0]=a*p+s*y+o*v,r[3]=a*f+s*x+o*w,r[6]=a*g+s*_+o*M,r[1]=l*p+h*y+c*v,r[4]=l*f+h*x+c*w,r[7]=l*g+h*_+c*M,r[2]=u*p+d*y+m*v,r[5]=u*f+d*x+m*w,r[8]=u*g+d*_+m*M,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],s=t[5],o=t[6],l=t[7],h=t[8];return e*a*h-e*s*l-n*r*h+n*s*o+i*r*l-i*a*o}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],s=t[5],o=t[6],l=t[7],h=t[8],c=h*a-s*l,u=s*o-h*r,d=l*r-a*o,m=e*c+n*u+i*d;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return t[0]=c*p,t[1]=(i*l-h*n)*p,t[2]=(s*n-i*a)*p,t[3]=u*p,t[4]=(h*e-i*o)*p,t[5]=(i*r-s*e)*p,t[6]=d*p,t[7]=(n*o-l*e)*p,t[8]=(a*e-n*r)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,a,s){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*a+l*s)+a+t,-i*l,i*o,-i*(-l*a+o*s)+s+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],a=i[3],s=i[6],o=i[1],l=i[4],h=i[7];return i[0]=e*r+n*o,i[3]=e*a+n*l,i[6]=e*s+n*h,i[1]=-n*r+e*o,i[4]=-n*a+e*l,i[7]=-n*s+e*h,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function Li(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function $i(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Pi(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const Ri={srgb:{"srgb-linear":$i},"srgb-linear":{srgb:Pi}},Bi={legacyMode:!0,get workingColorSpace(){return"srgb-linear"},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(Ri[e]&&void 0!==Ri[e][n]){const i=Ri[e][n];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},Ii={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Oi={r:0,g:0,b:0},Di={h:0,s:0,l:0},Fi={h:0,s:0,l:0};function Vi(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function ji(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class qi{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e="srgb"){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Bi.toWorkingColorSpace(this,e),this}setRGB(t,e,n,i="srgb-linear"){return this.r=t,this.g=e,this.b=n,Bi.toWorkingColorSpace(this,i),this}setHSL(t,e,n,i="srgb-linear"){if(t=function(t,e){return(t%e+e)%e}(t,1),e=zi(e,0,1),n=zi(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=Vi(r,i,t+1/3),this.g=Vi(r,i,t),this.b=Vi(r,i,t-1/3)}return Bi.toWorkingColorSpace(this,i),this}setStyle(t,e="srgb"){function n(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,Bi.toWorkingColorSpace(this,e),n(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,Bi.toWorkingColorSpace(this,e),n(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const i=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,a=parseInt(t[3],10)/100;return n(t[4]),this.setHSL(i,r,a,e)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],n=t.length;if(3===n)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,Bi.toWorkingColorSpace(this,e),this;if(6===n)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,Bi.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e="srgb"){const n=Ii[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=$i(t.r),this.g=$i(t.g),this.b=$i(t.b),this}copyLinearToSRGB(t){return this.r=Pi(t.r),this.g=Pi(t.g),this.b=Pi(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t="srgb"){return Bi.fromWorkingColorSpace(ji(this,Oi),t),zi(255*Oi.r,0,255)<<16^zi(255*Oi.g,0,255)<<8^zi(255*Oi.b,0,255)<<0}getHexString(t="srgb"){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e="srgb-linear"){Bi.fromWorkingColorSpace(ji(this,Oi),e);const n=Oi.r,i=Oi.g,r=Oi.b,a=Math.max(n,i,r),s=Math.min(n,i,r);let o,l;const h=(s+a)/2;if(s===a)o=0,l=0;else{const t=a-s;switch(l=h<=.5?t/(a+s):t/(2-a-s),a){case n:o=(i-r)/t+(i<r?6:0);break;case i:o=(r-n)/t+2;break;case r:o=(n-i)/t+4}o/=6}return t.h=o,t.s=l,t.l=h,t}getRGB(t,e="srgb-linear"){return Bi.fromWorkingColorSpace(ji(this,Oi),e),t.r=Oi.r,t.g=Oi.g,t.b=Oi.b,t}getStyle(t="srgb"){return Bi.fromWorkingColorSpace(ji(this,Oi),t),"srgb"!==t?`color(${t} ${Oi.r} ${Oi.g} ${Oi.b})`:`rgb(${255*Oi.r|0},${255*Oi.g|0},${255*Oi.b|0})`}offsetHSL(t,e,n){return this.getHSL(Di),Di.h+=t,Di.s+=e,Di.l+=n,this.setHSL(Di.h,Di.s,Di.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Di),t.getHSL(Fi);const n=Ni(Di.h,Fi.h,e),i=Ni(Di.s,Fi.s,e),r=Ni(Di.l,Fi.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let Hi;qi.NAMES=Ii;class Ui{constructor(t=null){this.isSource=!0,this.uuid=Ai(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(Wi(i[e].image)):t.push(Wi(i[e]))}else t=Wi(i);n.url=t}return e||(t.images[this.uuid]=n),n}}function Wi(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?class{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Hi&&(Hi=Li("canvas")),Hi.width=t.width,Hi.height=t.height;const n=Hi.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Hi}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Li("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*$i(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*$i(e[t]/255)):e[t]=$i(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Yi=0;class Xi extends ki{constructor(t=Xi.DEFAULT_IMAGE,e=Xi.DEFAULT_MAPPING,n=1001,i=1001,r=1006,a=1008,s=1023,o=1009,l=1,h=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Yi++}),this.uuid=Ai(),this.name="",this.source=new Ui(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new Ti(0,0),this.repeat=new Ti(1,1),this.center=new Ti(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}Xi.DEFAULT_IMAGE=null,Xi.DEFAULT_MAPPING=300;class Zi{constructor(t=0,e=0,n=0,i=1){this.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*e+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*e+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*e+a[7]*n+a[11]*i+a[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const a=.01,s=.1,o=t.elements,l=o[0],h=o[4],c=o[8],u=o[1],d=o[5],m=o[9],p=o[2],f=o[6],g=o[10];if(Math.abs(h-u)<a&&Math.abs(c-p)<a&&Math.abs(m-f)<a){if(Math.abs(h+u)<s&&Math.abs(c+p)<s&&Math.abs(m+f)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,y=(g+1)/2,x=(h+u)/4,_=(c+p)/4,v=(m+f)/4;return t>o&&t>y?t<a?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=x/n,r=_/n):o>y?o<a?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=x/i,r=v/i):y<a?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(y),n=_/r,i=v/r),this.set(n,i,r,e),this}let y=Math.sqrt((f-m)*(f-m)+(c-p)*(c-p)+(u-h)*(u-h));return Math.abs(y)<.001&&(y=1),this.x=(f-m)/y,this.y=(c-p)/y,this.z=(u-h)/y,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Gi{constructor(t=0,e=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,a,s){let o=n[i+0],l=n[i+1],h=n[i+2],c=n[i+3];const u=r[a+0],d=r[a+1],m=r[a+2],p=r[a+3];if(0===s)return t[e+0]=o,t[e+1]=l,t[e+2]=h,void(t[e+3]=c);if(1===s)return t[e+0]=u,t[e+1]=d,t[e+2]=m,void(t[e+3]=p);if(c!==p||o!==u||l!==d||h!==m){let t=1-s;const e=o*u+l*d+h*m+c*p,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),a=Math.atan2(r,e*n);t=Math.sin(t*a)/r,s=Math.sin(s*a)/r}const r=s*n;if(o=o*t+u*r,l=l*t+d*r,h=h*t+m*r,c=c*t+p*r,t===1-s){const t=1/Math.sqrt(o*o+l*l+h*h+c*c);o*=t,l*=t,h*=t,c*=t}}t[e]=o,t[e+1]=l,t[e+2]=h,t[e+3]=c}static multiplyQuaternionsFlat(t,e,n,i,r,a){const s=n[i],o=n[i+1],l=n[i+2],h=n[i+3],c=r[a],u=r[a+1],d=r[a+2],m=r[a+3];return t[e]=s*m+h*c+o*d-l*u,t[e+1]=o*m+h*u+l*c-s*d,t[e+2]=l*m+h*d+s*u-o*c,t[e+3]=h*m-s*c-o*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,r=t._z,a=t._order,s=Math.cos,o=Math.sin,l=s(n/2),h=s(i/2),c=s(r/2),u=o(n/2),d=o(i/2),m=o(r/2);switch(a){case"XYZ":this._x=u*h*c+l*d*m,this._y=l*d*c-u*h*m,this._z=l*h*m+u*d*c,this._w=l*h*c-u*d*m;break;case"YXZ":this._x=u*h*c+l*d*m,this._y=l*d*c-u*h*m,this._z=l*h*m-u*d*c,this._w=l*h*c+u*d*m;break;case"ZXY":this._x=u*h*c-l*d*m,this._y=l*d*c+u*h*m,this._z=l*h*m+u*d*c,this._w=l*h*c-u*d*m;break;case"ZYX":this._x=u*h*c-l*d*m,this._y=l*d*c+u*h*m,this._z=l*h*m-u*d*c,this._w=l*h*c+u*d*m;break;case"YZX":this._x=u*h*c+l*d*m,this._y=l*d*c+u*h*m,this._z=l*h*m-u*d*c,this._w=l*h*c-u*d*m;break;case"XZY":this._x=u*h*c-l*d*m,this._y=l*d*c-u*h*m,this._z=l*h*m+u*d*c,this._w=l*h*c+u*d*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],a=e[1],s=e[5],o=e[9],l=e[2],h=e[6],c=e[10],u=n+s+c;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(h-o)*t,this._y=(r-l)*t,this._z=(a-i)*t}else if(n>s&&n>c){const t=2*Math.sqrt(1+n-s-c);this._w=(h-o)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(r+l)/t}else if(s>c){const t=2*Math.sqrt(1+s-n-c);this._w=(r-l)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(o+h)/t}else{const t=2*Math.sqrt(1+c-n-s);this._w=(a-i)/t,this._x=(r+l)/t,this._y=(o+h)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(zi(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,a=t._w,s=e._x,o=e._y,l=e._z,h=e._w;return this._x=n*h+a*s+i*l-r*o,this._y=i*h+a*o+r*s-n*l,this._z=r*h+a*l+n*o-i*s,this._w=a*h-n*s-i*o-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,a=this._w;let s=a*t._w+n*t._x+i*t._y+r*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;const o=1-s*s;if(o<=Number.EPSILON){const t=1-e;return this._w=t*a+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(o),h=Math.atan2(l,s),c=Math.sin((1-e)*h)/l,u=Math.sin(e*h)/l;return this._w=a*c+this._w*u,this._x=n*c+this._x*u,this._y=i*c+this._y*u,this._z=r*c+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ji{constructor(t=0,e=0,n=0){this.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ki.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Ki.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,a=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*a,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,s=t.z,o=t.w,l=o*e+a*i-s*n,h=o*n+s*e-r*i,c=o*i+r*n-a*e,u=-r*e-a*n-s*i;return this.x=l*o+u*-r+h*-s-c*-a,this.y=h*o+u*-a+c*-r-l*-s,this.z=c*o+u*-s+l*-a-h*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,a=e.x,s=e.y,o=e.z;return this.x=i*o-r*s,this.y=r*a-n*o,this.z=n*s-i*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Qi.copy(this).projectOnVector(t),this.sub(Qi)}reflect(t){return this.sub(Qi.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(zi(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qi=new Ji,Ki=new Gi;class tr{constructor(t=new Ji(1/0,1/0,1/0),e=new Ji(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,s=-1/0;for(let o=0,l=t.length;o<l;o+=3){const l=t[o],h=t[o+1],c=t[o+2];l<e&&(e=l),h<n&&(n=h),c<i&&(i=c),l>r&&(r=l),h>a&&(a=h),c>s&&(s=c)}return this.min.set(e,n,i),this.max.set(r,a,s),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,s=-1/0;for(let o=0,l=t.count;o<l;o++){const l=t.getX(o),h=t.getY(o),c=t.getZ(o);l<e&&(e=l),h<n&&(n=h),c<i&&(i=c),l>r&&(r=l),h>a&&(a=h),c>s&&(s=c)}return this.min.set(e,n,i),this.max.set(r,a,s),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=nr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,i=e.count;n<i;n++)nr.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(nr)}else null===n.boundingBox&&n.computeBoundingBox(),ir.copy(n.boundingBox),ir.applyMatrix4(t.matrixWorld),this.union(ir);const i=t.children;for(let t=0,n=i.length;t<n;t++)this.expandByObject(i[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,nr),nr.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(cr),ur.subVectors(this.max,cr),rr.subVectors(t.a,cr),ar.subVectors(t.b,cr),sr.subVectors(t.c,cr),or.subVectors(ar,rr),lr.subVectors(sr,ar),hr.subVectors(rr,sr);let e=[0,-or.z,or.y,0,-lr.z,lr.y,0,-hr.z,hr.y,or.z,0,-or.x,lr.z,0,-lr.x,hr.z,0,-hr.x,-or.y,or.x,0,-lr.y,lr.x,0,-hr.y,hr.x,0];return!!pr(e,rr,ar,sr,ur)&&(e=[1,0,0,0,1,0,0,0,1],!!pr(e,rr,ar,sr,ur)&&(dr.crossVectors(or,lr),e=[dr.x,dr.y,dr.z],pr(e,rr,ar,sr,ur)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return nr.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(nr).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(er[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),er[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),er[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),er[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),er[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),er[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),er[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),er[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(er)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const er=[new Ji,new Ji,new Ji,new Ji,new Ji,new Ji,new Ji,new Ji],nr=new Ji,ir=new tr,rr=new Ji,ar=new Ji,sr=new Ji,or=new Ji,lr=new Ji,hr=new Ji,cr=new Ji,ur=new Ji,dr=new Ji,mr=new Ji;function pr(t,e,n,i,r){for(let a=0,s=t.length-3;a<=s;a+=3){mr.fromArray(t,a);const s=r.x*Math.abs(mr.x)+r.y*Math.abs(mr.y)+r.z*Math.abs(mr.z),o=e.dot(mr),l=n.dot(mr),h=i.dot(mr);if(Math.max(-Math.max(o,l,h),Math.min(o,l,h))>s)return!1}return!0}const fr=new tr,gr=new Ji,yr=new Ji,xr=new Ji;class _r{constructor(t=new Ji,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):fr.setFromPoints(t).getCenter(n);let i=0;for(let e=0,r=t.length;e<r;e++)i=Math.max(i,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){xr.subVectors(t,this.center);const e=xr.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(xr.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return!0===this.center.equals(t.center)?yr.set(0,0,1).multiplyScalar(t.radius):yr.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(gr.copy(t.center).add(yr)),this.expandByPoint(gr.copy(t.center).sub(yr)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const vr=new Ji,wr=new Ji,Mr=new Ji,br=new Ji,Er=new Ji,kr=new Ji,Sr=new Ji;class Ar{constructor(t=new Ji,e=new Ji(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,vr)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=vr.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(vr.copy(this.direction).multiplyScalar(e).add(this.origin),vr.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){wr.copy(t).add(e).multiplyScalar(.5),Mr.copy(e).sub(t).normalize(),br.copy(this.origin).sub(wr);const r=.5*t.distanceTo(e),a=-this.direction.dot(Mr),s=br.dot(this.direction),o=-br.dot(Mr),l=br.lengthSq(),h=Math.abs(1-a*a);let c,u,d,m;if(h>0)if(c=a*o-s,u=a*s-o,m=r*h,c>=0)if(u>=-m)if(u<=m){const t=1/h;c*=t,u*=t,d=c*(c+a*u+2*s)+u*(a*c+u+2*o)+l}else u=r,c=Math.max(0,-(a*u+s)),d=-c*c+u*(u+2*o)+l;else u=-r,c=Math.max(0,-(a*u+s)),d=-c*c+u*(u+2*o)+l;else u<=-m?(c=Math.max(0,-(-a*r+s)),u=c>0?-r:Math.min(Math.max(-r,-o),r),d=-c*c+u*(u+2*o)+l):u<=m?(c=0,u=Math.min(Math.max(-r,-o),r),d=u*(u+2*o)+l):(c=Math.max(0,-(a*r+s)),u=c>0?r:Math.min(Math.max(-r,-o),r),d=-c*c+u*(u+2*o)+l);else u=a>0?-r:r,c=Math.max(0,-(a*u+s)),d=-c*c+u*(u+2*o)+l;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),i&&i.copy(Mr).multiplyScalar(u).add(wr),d}intersectSphere(t,e){vr.subVectors(t.center,this.origin);const n=vr.dot(this.direction),i=vr.dot(vr)-n*n,r=t.radius*t.radius;if(i>r)return null;const a=Math.sqrt(r-i),s=n-a,o=n+a;return s<0&&o<0?null:s<0?this.at(o,e):this.at(s,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,a,s,o;const l=1/this.direction.x,h=1/this.direction.y,c=1/this.direction.z,u=this.origin;return l>=0?(n=(t.min.x-u.x)*l,i=(t.max.x-u.x)*l):(n=(t.max.x-u.x)*l,i=(t.min.x-u.x)*l),h>=0?(r=(t.min.y-u.y)*h,a=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,a=(t.min.y-u.y)*h),n>a||r>i?null:((r>n||n!=n)&&(n=r),(a<i||i!=i)&&(i=a),c>=0?(s=(t.min.z-u.z)*c,o=(t.max.z-u.z)*c):(s=(t.max.z-u.z)*c,o=(t.min.z-u.z)*c),n>o||s>i?null:((s>n||n!=n)&&(n=s),(o<i||i!=i)&&(i=o),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,vr)}intersectTriangle(t,e,n,i,r){Er.subVectors(e,t),kr.subVectors(n,t),Sr.crossVectors(Er,kr);let a,s=this.direction.dot(Sr);if(s>0){if(i)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}br.subVectors(this.origin,t);const o=a*this.direction.dot(kr.crossVectors(br,kr));if(o<0)return null;const l=a*this.direction.dot(Er.cross(br));if(l<0)return null;if(o+l>s)return null;const h=-a*br.dot(Sr);return h<0?null:this.at(h/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class zr{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,a,s,o,l,h,c,u,d,m,p,f){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=m,g[11]=p,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new zr).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/Nr.setFromMatrixColumn(t,0).length(),r=1/Nr.setFromMatrixColumn(t,1).length(),a=1/Nr.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,r=t.z,a=Math.cos(n),s=Math.sin(n),o=Math.cos(i),l=Math.sin(i),h=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){const t=a*h,n=a*c,i=s*h,r=s*c;e[0]=o*h,e[4]=-o*c,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-s*o,e[2]=r-t*l,e[6]=i+n*l,e[10]=a*o}else if("YXZ"===t.order){const t=o*h,n=o*c,i=l*h,r=l*c;e[0]=t+r*s,e[4]=i*s-n,e[8]=a*l,e[1]=a*c,e[5]=a*h,e[9]=-s,e[2]=n*s-i,e[6]=r+t*s,e[10]=a*o}else if("ZXY"===t.order){const t=o*h,n=o*c,i=l*h,r=l*c;e[0]=t-r*s,e[4]=-a*c,e[8]=i+n*s,e[1]=n+i*s,e[5]=a*h,e[9]=r-t*s,e[2]=-a*l,e[6]=s,e[10]=a*o}else if("ZYX"===t.order){const t=a*h,n=a*c,i=s*h,r=s*c;e[0]=o*h,e[4]=i*l-n,e[8]=t*l+r,e[1]=o*c,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=s*o,e[10]=a*o}else if("YZX"===t.order){const t=a*o,n=a*l,i=s*o,r=s*l;e[0]=o*h,e[4]=r-t*c,e[8]=i*c+n,e[1]=c,e[5]=a*h,e[9]=-s*h,e[2]=-l*h,e[6]=n*c+i,e[10]=t-r*c}else if("XZY"===t.order){const t=a*o,n=a*l,i=s*o,r=s*l;e[0]=o*h,e[4]=-c,e[8]=l*h,e[1]=t*c+r,e[5]=a*h,e[9]=n*c-i,e[2]=i*c-n,e[6]=s*h,e[10]=r*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Cr,t,Lr)}lookAt(t,e,n){const i=this.elements;return Rr.subVectors(t,e),0===Rr.lengthSq()&&(Rr.z=1),Rr.normalize(),$r.crossVectors(n,Rr),0===$r.lengthSq()&&(1===Math.abs(n.z)?Rr.x+=1e-4:Rr.z+=1e-4,Rr.normalize(),$r.crossVectors(n,Rr)),$r.normalize(),Pr.crossVectors(Rr,$r),i[0]=$r.x,i[4]=Pr.x,i[8]=Rr.x,i[1]=$r.y,i[5]=Pr.y,i[9]=Rr.y,i[2]=$r.z,i[6]=Pr.z,i[10]=Rr.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,a=n[0],s=n[4],o=n[8],l=n[12],h=n[1],c=n[5],u=n[9],d=n[13],m=n[2],p=n[6],f=n[10],g=n[14],y=n[3],x=n[7],_=n[11],v=n[15],w=i[0],M=i[4],b=i[8],E=i[12],k=i[1],S=i[5],A=i[9],z=i[13],N=i[2],T=i[6],C=i[10],L=i[14],$=i[3],P=i[7],R=i[11],B=i[15];return r[0]=a*w+s*k+o*N+l*$,r[4]=a*M+s*S+o*T+l*P,r[8]=a*b+s*A+o*C+l*R,r[12]=a*E+s*z+o*L+l*B,r[1]=h*w+c*k+u*N+d*$,r[5]=h*M+c*S+u*T+d*P,r[9]=h*b+c*A+u*C+d*R,r[13]=h*E+c*z+u*L+d*B,r[2]=m*w+p*k+f*N+g*$,r[6]=m*M+p*S+f*T+g*P,r[10]=m*b+p*A+f*C+g*R,r[14]=m*E+p*z+f*L+g*B,r[3]=y*w+x*k+_*N+v*$,r[7]=y*M+x*S+_*T+v*P,r[11]=y*b+x*A+_*C+v*R,r[15]=y*E+x*z+_*L+v*B,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],a=t[1],s=t[5],o=t[9],l=t[13],h=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+r*o*c-i*l*c-r*s*u+n*l*u+i*s*d-n*o*d)+t[7]*(+e*o*d-e*l*u+r*a*u-i*a*d+i*l*h-r*o*h)+t[11]*(+e*l*c-e*s*d-r*a*c+n*a*d+r*s*h-n*l*h)+t[15]*(-i*s*h-e*o*c+e*s*u+i*a*c-n*a*u+n*o*h)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],s=t[5],o=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],m=t[12],p=t[13],f=t[14],g=t[15],y=c*f*l-p*u*l+p*o*d-s*f*d-c*o*g+s*u*g,x=m*u*l-h*f*l-m*o*d+a*f*d+h*o*g-a*u*g,_=h*p*l-m*c*l+m*s*d-a*p*d-h*s*g+a*c*g,v=m*c*o-h*p*o-m*s*u+a*p*u+h*s*f-a*c*f,w=e*y+n*x+i*_+r*v;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/w;return t[0]=y*M,t[1]=(p*u*r-c*f*r-p*i*d+n*f*d+c*i*g-n*u*g)*M,t[2]=(s*f*r-p*o*r+p*i*l-n*f*l-s*i*g+n*o*g)*M,t[3]=(c*o*r-s*u*r-c*i*l+n*u*l+s*i*d-n*o*d)*M,t[4]=x*M,t[5]=(h*f*r-m*u*r+m*i*d-e*f*d-h*i*g+e*u*g)*M,t[6]=(m*o*r-a*f*r-m*i*l+e*f*l+a*i*g-e*o*g)*M,t[7]=(a*u*r-h*o*r+h*i*l-e*u*l-a*i*d+e*o*d)*M,t[8]=_*M,t[9]=(m*c*r-h*p*r-m*n*d+e*p*d+h*n*g-e*c*g)*M,t[10]=(a*p*r-m*s*r+m*n*l-e*p*l-a*n*g+e*s*g)*M,t[11]=(h*s*r-a*c*r-h*n*l+e*c*l+a*n*d-e*s*d)*M,t[12]=v*M,t[13]=(h*p*i-m*c*i+m*n*u-e*p*u-h*n*f+e*c*f)*M,t[14]=(m*s*i-a*p*i-m*n*o+e*p*o+a*n*f-e*s*f)*M,t[15]=(a*c*i-h*s*i+h*n*o-e*c*o-a*n*u+e*s*u)*M,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,a=t.x,s=t.y,o=t.z,l=r*a,h=r*s;return this.set(l*a+n,l*s-i*o,l*o+i*s,0,l*s+i*o,h*s+n,h*o-i*a,0,l*o-i*s,h*o+i*a,r*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,a){return this.set(1,n,r,0,t,1,a,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,a=e._y,s=e._z,o=e._w,l=r+r,h=a+a,c=s+s,u=r*l,d=r*h,m=r*c,p=a*h,f=a*c,g=s*c,y=o*l,x=o*h,_=o*c,v=n.x,w=n.y,M=n.z;return i[0]=(1-(p+g))*v,i[1]=(d+_)*v,i[2]=(m-x)*v,i[3]=0,i[4]=(d-_)*w,i[5]=(1-(u+g))*w,i[6]=(f+y)*w,i[7]=0,i[8]=(m+x)*M,i[9]=(f-y)*M,i[10]=(1-(u+p))*M,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=Nr.set(i[0],i[1],i[2]).length();const a=Nr.set(i[4],i[5],i[6]).length(),s=Nr.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Tr.copy(this);const o=1/r,l=1/a,h=1/s;return Tr.elements[0]*=o,Tr.elements[1]*=o,Tr.elements[2]*=o,Tr.elements[4]*=l,Tr.elements[5]*=l,Tr.elements[6]*=l,Tr.elements[8]*=h,Tr.elements[9]*=h,Tr.elements[10]*=h,e.setFromRotationMatrix(Tr),n.x=r,n.y=a,n.z=s,this}makePerspective(t,e,n,i,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const s=this.elements,o=2*r/(e-t),l=2*r/(n-i),h=(e+t)/(e-t),c=(n+i)/(n-i),u=-(a+r)/(a-r),d=-2*a*r/(a-r);return s[0]=o,s[4]=0,s[8]=h,s[12]=0,s[1]=0,s[5]=l,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=u,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,n,i,r,a){const s=this.elements,o=1/(e-t),l=1/(n-i),h=1/(a-r),c=(e+t)*o,u=(n+i)*l,d=(a+r)*h;return s[0]=2*o,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-u,s[2]=0,s[6]=0,s[10]=-2*h,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Nr=new Ji,Tr=new zr,Cr=new Ji(0,0,0),Lr=new Ji(1,1,1),$r=new Ji,Pr=new Ji,Rr=new Ji,Br=new zr,Ir=new Gi;class Or{constructor(t=0,e=0,n=0,i=Or.DefaultOrder){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],a=i[4],s=i[8],o=i[1],l=i[5],h=i[9],c=i[2],u=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(zi(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-a,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-zi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,r),this._z=0);break;case"ZXY":this._x=Math.asin(zi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-zi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(zi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,r)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-zi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(s,r)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Br.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Br,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Ir.setFromEuler(this),this.setFromQuaternion(Ir,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Or.DefaultOrder="XYZ",Or.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Dr{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Fr=0;const Vr=new Ji,jr=new Gi,qr=new zr,Hr=new Ji,Ur=new Ji,Wr=new Ji,Yr=new Gi,Xr=new Ji(1,0,0),Zr=new Ji(0,1,0),Gr=new Ji(0,0,1),Jr={type:"added"},Qr={type:"removed"};class Kr extends ki{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Fr++}),this.uuid=Ai(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kr.DefaultUp.clone();const t=new Ji,e=new Or,n=new Gi,i=new Ji(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new zr},normalMatrix:{value:new Ci}}),this.matrix=new zr,this.matrixWorld=new zr,this.matrixAutoUpdate=Kr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Dr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return jr.setFromAxisAngle(t,e),this.quaternion.multiply(jr),this}rotateOnWorldAxis(t,e){return jr.setFromAxisAngle(t,e),this.quaternion.premultiply(jr),this}rotateX(t){return this.rotateOnAxis(Xr,t)}rotateY(t){return this.rotateOnAxis(Zr,t)}rotateZ(t){return this.rotateOnAxis(Gr,t)}translateOnAxis(t,e){return Vr.copy(t).applyQuaternion(this.quaternion),this.position.add(Vr.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Xr,t)}translateY(t){return this.translateOnAxis(Zr,t)}translateZ(t){return this.translateOnAxis(Gr,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(qr.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Hr.copy(t):Hr.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ur.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qr.lookAt(Ur,Hr,this.up):qr.lookAt(Hr,Ur,this.up),this.quaternion.setFromRotationMatrix(qr),i&&(qr.extractRotation(i.matrixWorld),jr.setFromRotationMatrix(qr),this.quaternion.premultiply(jr.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Jr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Qr)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Qr)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),qr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),qr.multiply(t.parent.matrixWorld)),t.applyMatrix4(qr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ur,t,Wr),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ur,Yr,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=a(t.geometries),i=a(t.materials),r=a(t.textures),s=a(t.images),o=a(t.shapes),l=a(t.skeletons),h=a(t.animations),c=a(t.nodes);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),s.length>0&&(n.images=s),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),h.length>0&&(n.animations=h),c.length>0&&(n.nodes=c)}return n.object=i,n;function a(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}}Kr.DefaultUp=new Ji(0,1,0),Kr.DefaultMatrixAutoUpdate=!0;const ta=new Ji,ea=new Ji,na=new Ji,ia=new Ji,ra=new Ji,aa=new Ji,sa=new Ji,oa=new Ji,la=new Ji,ha=new Ji;class ca{constructor(t=new Ji,e=new Ji,n=new Ji){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),ta.subVectors(t,e),i.cross(ta);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){ta.subVectors(i,e),ea.subVectors(n,e),na.subVectors(t,e);const a=ta.dot(ta),s=ta.dot(ea),o=ta.dot(na),l=ea.dot(ea),h=ea.dot(na),c=a*l-s*s;if(0===c)return r.set(-2,-1,-1);const u=1/c,d=(l*o-s*h)*u,m=(a*h-s*o)*u;return r.set(1-d-m,m,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,ia),ia.x>=0&&ia.y>=0&&ia.x+ia.y<=1}static getUV(t,e,n,i,r,a,s,o){return this.getBarycoord(t,e,n,i,ia),o.set(0,0),o.addScaledVector(r,ia.x),o.addScaledVector(a,ia.y),o.addScaledVector(s,ia.z),o}static isFrontFacing(t,e,n,i){return ta.subVectors(n,e),ea.subVectors(t,e),ta.cross(ea).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return ta.subVectors(this.c,this.b),ea.subVectors(this.a,this.b),.5*ta.cross(ea).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ca.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ca.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return ca.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return ca.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ca.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let a,s;ra.subVectors(i,n),aa.subVectors(r,n),oa.subVectors(t,n);const o=ra.dot(oa),l=aa.dot(oa);if(o<=0&&l<=0)return e.copy(n);la.subVectors(t,i);const h=ra.dot(la),c=aa.dot(la);if(h>=0&&c<=h)return e.copy(i);const u=o*c-h*l;if(u<=0&&o>=0&&h<=0)return a=o/(o-h),e.copy(n).addScaledVector(ra,a);ha.subVectors(t,r);const d=ra.dot(ha),m=aa.dot(ha);if(m>=0&&d<=m)return e.copy(r);const p=d*l-o*m;if(p<=0&&l>=0&&m<=0)return s=l/(l-m),e.copy(n).addScaledVector(aa,s);const f=h*m-d*c;if(f<=0&&c-h>=0&&d-m>=0)return sa.subVectors(r,i),s=(c-h)/(c-h+(d-m)),e.copy(i).addScaledVector(sa,s);const g=1/(f+p+u);return a=p*g,s=u*g,e.copy(n).addScaledVector(ra,a).addScaledVector(aa,s)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let ua=0;class da extends ki{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ua++}),this.uuid=Ai(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}da.fromType=function(){return null};const ma=new Ji,pa=new Ti;class fa{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new qi),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new Ti),e[n++]=r.x,e[n++]=r.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new Ji),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new Zi),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)pa.fromBufferAttribute(this,e),pa.applyMatrix3(t),this.setXY(e,pa.x,pa.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)ma.fromBufferAttribute(this,e),ma.applyMatrix3(t),this.setXYZ(e,ma.x,ma.y,ma.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)ma.fromBufferAttribute(this,e),ma.applyMatrix4(t),this.setXYZ(e,ma.x,ma.y,ma.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)ma.fromBufferAttribute(this,e),ma.applyNormalMatrix(t),this.setXYZ(e,ma.x,ma.y,ma.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)ma.fromBufferAttribute(this,e),ma.transformDirection(t),this.setXYZ(e,ma.x,ma.y,ma.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),35044!==this.usage&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}class ga extends fa{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class ya extends fa{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class xa extends fa{constructor(t,e,n){super(new Float32Array(t),e,n)}}let _a=0;const va=new zr,wa=new Kr,Ma=new Ji,ba=new tr,Ea=new tr,ka=new Ji;class Sa extends ki{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_a++}),this.uuid=Ai(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(function(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}(t)?ya:ga)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Ci).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return va.makeRotationFromQuaternion(t),this.applyMatrix4(va),this}rotateX(t){return va.makeRotationX(t),this.applyMatrix4(va),this}rotateY(t){return va.makeRotationY(t),this.applyMatrix4(va),this}rotateZ(t){return va.makeRotationZ(t),this.applyMatrix4(va),this}translate(t,e,n){return va.makeTranslation(t,e,n),this.applyMatrix4(va),this}scale(t,e,n){return va.makeScale(t,e,n),this.applyMatrix4(va),this}lookAt(t){return wa.lookAt(t),wa.updateMatrix(),this.applyMatrix4(wa.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ma).negate(),this.translate(Ma.x,Ma.y,Ma.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new xa(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new tr);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ji(-1/0,-1/0,-1/0),new Ji(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];ba.setFromBufferAttribute(n),this.morphTargetsRelative?(ka.addVectors(this.boundingBox.min,ba.min),this.boundingBox.expandByPoint(ka),ka.addVectors(this.boundingBox.max,ba.max),this.boundingBox.expandByPoint(ka)):(this.boundingBox.expandByPoint(ba.min),this.boundingBox.expandByPoint(ba.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new _r);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ji,1/0);if(t){const n=this.boundingSphere.center;if(ba.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Ea.setFromBufferAttribute(n),this.morphTargetsRelative?(ka.addVectors(ba.min,Ea.min),ba.expandByPoint(ka),ka.addVectors(ba.max,Ea.max),ba.expandByPoint(ka)):(ba.expandByPoint(Ea.min),ba.expandByPoint(Ea.max))}ba.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)ka.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(ka));if(e)for(let r=0,a=e.length;r<a;r++){const a=e[r],s=this.morphTargetsRelative;for(let e=0,r=a.count;e<r;e++)ka.fromBufferAttribute(a,e),s&&(Ma.fromBufferAttribute(t,e),ka.add(Ma)),i=Math.max(i,n.distanceToSquared(ka))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,i=e.position.array,r=e.normal.array,a=e.uv.array,s=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new fa(new Float32Array(4*s),4));const o=this.getAttribute("tangent").array,l=[],h=[];for(let t=0;t<s;t++)l[t]=new Ji,h[t]=new Ji;const c=new Ji,u=new Ji,d=new Ji,m=new Ti,p=new Ti,f=new Ti,g=new Ji,y=new Ji;function x(t,e,n){c.fromArray(i,3*t),u.fromArray(i,3*e),d.fromArray(i,3*n),m.fromArray(a,2*t),p.fromArray(a,2*e),f.fromArray(a,2*n),u.sub(c),d.sub(c),p.sub(m),f.sub(m);const r=1/(p.x*f.y-f.x*p.y);isFinite(r)&&(g.copy(u).multiplyScalar(f.y).addScaledVector(d,-p.y).multiplyScalar(r),y.copy(d).multiplyScalar(p.x).addScaledVector(u,-f.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[n].add(g),h[t].add(y),h[e].add(y),h[n].add(y))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let t=0,e=_.length;t<e;++t){const e=_[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)x(n[t+0],n[t+1],n[t+2])}const v=new Ji,w=new Ji,M=new Ji,b=new Ji;function E(t){M.fromArray(r,3*t),b.copy(M);const e=l[t];v.copy(e),v.sub(M.multiplyScalar(M.dot(e))).normalize(),w.crossVectors(b,e);const n=w.dot(h[t])<0?-1:1;o[4*t]=v.x,o[4*t+1]=v.y,o[4*t+2]=v.z,o[4*t+3]=n}for(let t=0,e=_.length;t<e;++t){const e=_[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)E(n[t+0]),E(n[t+1]),E(n[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new fa(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new Ji,r=new Ji,a=new Ji,s=new Ji,o=new Ji,l=new Ji,h=new Ji,c=new Ji;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),m=t.getX(u+1),p=t.getX(u+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,m),a.fromBufferAttribute(e,p),h.subVectors(a,r),c.subVectors(i,r),h.cross(c),s.fromBufferAttribute(n,d),o.fromBufferAttribute(n,m),l.fromBufferAttribute(n,p),s.add(h),o.add(h),l.add(h),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(m,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,s=e.count;t<s;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),a.fromBufferAttribute(e,t+2),h.subVectors(a,r),c.subVectors(i,r),h.cross(c),n.setXYZ(t+0,h.x,h.y,h.z),n.setXYZ(t+1,h.x,h.y,h.z),n.setXYZ(t+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i].array,a=t.attributes[i],s=a.array,o=a.itemSize*e,l=Math.min(s.length,r.length-o);for(let t=0,e=o;t<l;t++,e++)r[e]=s[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)ka.fromBufferAttribute(t,e),ka.normalize(),t.setXYZ(e,ka.x,ka.y,ka.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,a=new n.constructor(e.length*i);let s=0,o=0;for(let r=0,l=e.length;r<l;r++){s=t.isInterleavedBufferAttribute?e[r]*t.data.stride+t.offset:e[r]*i;for(let t=0;t<i;t++)a[o++]=n[s++]}return new fa(a,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Sa,n=this.index.array,i=this.attributes;for(const r in i){const a=t(i[r],n);e.setAttribute(r,a)}const r=this.morphAttributes;for(const i in r){const a=[],s=r[i];for(let e=0,i=s.length;e<i;e++){const i=t(s[e],n);a.push(i)}e.morphAttributes[i]=a}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let t=0,n=a.length;t<n;t++){const n=a[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const i=n[e];t.data.attributes[e]=i.toJSON(t.data)}const i={};let r=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],a=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];a.push(i.toJSON(t.data))}a.length>0&&(i[e]=a,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const s=this.boundingSphere;return null!==s&&(t.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const t in i){const n=i[t];this.setAttribute(t,n.clone(e))}const r=t.morphAttributes;for(const t in r){const n=[],i=r[t];for(let t=0,r=i.length;t<r;t++)n.push(i[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let t=0,e=a.length;t<e;t++){const e=a[t];this.addGroup(e.start,e.count,e.materialIndex)}const s=t.boundingBox;null!==s&&(this.boundingBox=s.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}function Aa(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function za(t){const e={};for(let n=0;n<t.length;n++){const i=Aa(t[n]);for(const t in i)e[t]=i[t]}return e}class Na extends da{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Aa(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?e.uniforms[n]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[n]={type:"m4",value:i.toArray()}:e.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}const Ta="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",Ca="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",La="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",$a="#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Pa="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",Ra="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",Ba="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",Ia="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",Oa="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",Da="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Fa="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",Va="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",ja="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",qa="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Ha="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Ua="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Wa="#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",Ya="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Xa="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",Za="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",Ga="#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Ja="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Qa="#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",Ka="#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",ts="#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",es="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",ns="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",is="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",rs="#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",as="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",ss="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",os="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",ls={common:{diffuse:{value:new qi(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ci},uv2Transform:{value:new Ci},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ti(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ci}},sprite:{diffuse:{value:new qi(16777215)},opacity:{value:1},center:{value:new Ti(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ci}}},hs={basic:{uniforms:za([ls.common,ls.specularmap,ls.envmap,ls.aomap,ls.lightmap,ls.fog]),vertexShader:ja,fragmentShader:qa},lambert:{uniforms:za([ls.common,ls.specularmap,ls.envmap,ls.aomap,ls.lightmap,ls.emissivemap,ls.fog,ls.lights,{emissive:{value:new qi(0)}}]),vertexShader:Ha,fragmentShader:Ua},phong:{uniforms:za([ls.common,ls.specularmap,ls.envmap,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.fog,ls.lights,{emissive:{value:new qi(0)},specular:{value:new qi(1118481)},shininess:{value:30}}]),vertexShader:Ga,fragmentShader:Ja},standard:{uniforms:za([ls.common,ls.envmap,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.roughnessmap,ls.metalnessmap,ls.fog,ls.lights,{emissive:{value:new qi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qa,fragmentShader:Ka},toon:{uniforms:za([ls.common,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.gradientmap,ls.fog,ls.lights,{emissive:{value:new qi(0)}}]),vertexShader:ts,fragmentShader:es},matcap:{uniforms:za([ls.common,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.fog,{matcap:{value:null}}]),vertexShader:Wa,fragmentShader:Ya},points:{uniforms:za([ls.points,ls.fog]),vertexShader:ns,fragmentShader:is},dashed:{uniforms:za([ls.common,ls.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fa,fragmentShader:Va},depth:{uniforms:za([ls.common,ls.displacementmap]),vertexShader:Pa,fragmentShader:Ra},normal:{uniforms:za([ls.common,ls.bumpmap,ls.normalmap,ls.displacementmap,{opacity:{value:1}}]),vertexShader:Xa,fragmentShader:Za},sprite:{uniforms:za([ls.sprite,ls.fog]),vertexShader:ss,fragmentShader:os},background:{uniforms:{uvTransform:{value:new Ci},t2D:{value:null}},vertexShader:Ta,fragmentShader:Ca},cube:{uniforms:za([ls.envmap,{opacity:{value:1}}]),vertexShader:La,fragmentShader:$a},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Oa,fragmentShader:Da},distanceRGBA:{uniforms:za([ls.common,ls.displacementmap,{referencePosition:{value:new Ji},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ba,fragmentShader:Ia},shadow:{uniforms:za([ls.lights,ls.fog,{color:{value:new qi(0)},opacity:{value:1}}]),vertexShader:rs,fragmentShader:as}};hs.physical={uniforms:za([hs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ti(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new qi(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ti},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new qi(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new qi(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Qa,fragmentShader:Ka},new Xi,new class extends Xi{constructor(t=null,e=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},new class extends Xi{constructor(t=null,e=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},new class extends Xi{constructor(t,e,n,i,r,a,s,o,l,h){super(t=void 0!==t?t:[],e=void 0!==e?e:301,n,i,r,a,s,o,l,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}};class cs extends da{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const us=new Ji,ds=new Ji,ms=new zr,ps=new Ar,fs=new _r;class gs extends Kr{constructor(t=new Sa,e=new cs){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)us.fromBufferAttribute(e,t-1),ds.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=us.distanceTo(ds);t.setAttribute("lineDistance",new xa(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),fs.copy(n.boundingSphere),fs.applyMatrix4(i),fs.radius+=r,!1===t.ray.intersectsSphere(fs))return;ms.copy(i).invert(),ps.copy(t.ray).applyMatrix4(ms);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=new Ji,h=new Ji,c=new Ji,u=new Ji,d=this.isLineSegments?2:1,m=n.index,p=n.attributes.position;if(null!==m){for(let n=Math.max(0,a.start),i=Math.min(m.count,a.start+a.count)-1;n<i;n+=d){const i=m.getX(n),r=m.getX(n+1);l.fromBufferAttribute(p,i),h.fromBufferAttribute(p,r);if(ps.distanceSqToSegment(l,h,u,c)>o)continue;u.applyMatrix4(this.matrixWorld);const a=t.ray.origin.distanceTo(u);a<t.near||a>t.far||e.push({distance:a,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,a.start),i=Math.min(p.count,a.start+a.count)-1;n<i;n+=d){l.fromBufferAttribute(p,n),h.fromBufferAttribute(p,n+1);if(ps.distanceSqToSegment(l,h,u,c)>o)continue;u.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(u);i<t.near||i>t.far||e.push({distance:i,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}const ys=new Ji,xs=new Ji;class _s extends gs{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)ys.fromBufferAttribute(e,t),xs.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+ys.distanceTo(xs);t.setAttribute("lineDistance",new xa(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}new Ji,new Ji,new Ji,new Ji,new ca;class vs extends da{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new qi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ti(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}const ws={ShadowMaterial:class extends da{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new qi(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}},SpriteMaterial:class extends da{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new qi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}},RawShaderMaterial:class extends Na{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},ShaderMaterial:Na,PointsMaterial:class extends da{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}},MeshPhysicalMaterial:class extends vs{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ti(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return zi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new qi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new qi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new qi(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}},MeshStandardMaterial:vs,MeshPhongMaterial:class extends da{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new qi(16777215),this.specular=new qi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ti(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}},MeshToonMaterial:class extends da{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ti(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},MeshNormalMaterial:class extends da{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ti(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}},MeshLambertMaterial:class extends da{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new qi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},MeshDepthMaterial:class extends da{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},MeshDistanceMaterial:class extends da{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Ji,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}},MeshBasicMaterial:class extends da{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},MeshMatcapMaterial:class extends da{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ti(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}},LineDashedMaterial:class extends cs{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}},LineBasicMaterial:cs,Material:da};da.fromType=function(t){return new ws[t]};const Ms="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),/(WCOD+)?/.source.replace("WCOD",Ms),/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]");class bs{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(zi(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Es extends _s{constructor(t=10,e=10,n=4473924,i=8947848){n=new qi(n),i=new qi(i);const r=e/2,a=t/e,s=t/2,o=[],l=[];for(let t=0,h=0,c=-s;t<=e;t++,c+=a){o.push(-s,0,c,s,0,c),o.push(c,0,-s,c,0,s);const e=t===r?n:i;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const h=new Sa;h.setAttribute("position",new xa(o,3)),h.setAttribute("color",new xa(l,3));super(h,new cs({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class ks extends _s{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Sa;n.setAttribute("position",new xa(e,3)),n.setAttribute("color",new xa([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new cs({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const i=new qi,r=this.geometry.attributes.color.array;return i.set(t),i.toArray(r,0),i.toArray(r,3),i.set(e),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const Ss=new Uint32Array(512),As=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(Ss[t]=0,Ss[256|t]=32768,As[t]=24,As[256|t]=24):e<-14?(Ss[t]=1024>>-e-14,Ss[256|t]=1024>>-e-14|32768,As[t]=-e-1,As[256|t]=-e-1):e<=15?(Ss[t]=e+15<<10,Ss[256|t]=e+15<<10|32768,As[t]=13,As[256|t]=13):e<128?(Ss[t]=31744,Ss[256|t]=64512,As[t]=24,As[256|t]=24):(Ss[t]=31744,Ss[256|t]=64512,As[t]=13,As[256|t]=13)}const zs=new Uint32Array(2048),Ns=new Uint32Array(64),Ts=new Uint32Array(64);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0==(8388608&e);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,zs[t]=e|n}for(let t=1024;t<2048;++t)zs[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)Ns[t]=t<<23;Ns[31]=1199570944,Ns[32]=2147483648;for(let t=33;t<63;++t)Ns[t]=2147483648+(t-32<<23);Ns[63]=3347054592;for(let t=1;t<64;++t)32!==t&&(Ts[t]=1024);"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"141"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="141");class Cs extends Sa{constructor(t=((t,e,n)=>n.set(t,e,Math.cos(t)*Math.sin(e))),e=8,n=8){super(),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};const i=[],r=[],a=[],s=[],o=1e-5,l=new Ji,h=new Ji,c=new Ji,u=new Ji,d=new Ji;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const m=e+1;for(let i=0;i<=n;i++){const m=i/n;for(let n=0;n<=e;n++){const i=n/e;t(i,m,h),r.push(h.x,h.y,h.z),i-o>=0?(t(i-o,m,c),u.subVectors(h,c)):(t(i+o,m,c),u.subVectors(c,h)),m-o>=0?(t(i,m-o,c),d.subVectors(h,c)):(t(i,m+o,c),d.subVectors(c,h)),l.crossVectors(u,d).normalize(),a.push(l.x,l.y,l.z),s.push(i,m)}}for(let t=0;t<n;t++)for(let n=0;n<e;n++){const e=t*m+n,r=t*m+n+1,a=(t+1)*m+n+1,s=(t+1)*m+n;i.push(e,r,s),i.push(r,a,s)}this.setIndex(i),this.setAttribute("position",new xa(r,3)),this.setAttribute("normal",new xa(a,3)),this.setAttribute("uv",new xa(s,2))}}const Ls={type:"change"},$s={type:"start"},Ps={type:"end"};class Rs extends ki{constructor(t,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ji,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:xi,MIDDLE:_i,RIGHT:vi},this.touches={ONE:wi,TWO:bi},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return s.phi},this.getAzimuthalAngle=function(){return s.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",q),this._domElementKeyEvents=t},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Ls),n.update(),r=i.NONE},this.update=function(){const e=new Ji,u=(new Gi).setFromUnitVectors(t.up,new Ji(0,1,0)),d=u.clone().invert(),m=new Ji,p=new Gi,f=2*Math.PI;return function(){const t=n.object.position;e.copy(t).sub(n.target),e.applyQuaternion(u),s.setFromVector3(e),n.autoRotate&&r===i.NONE&&b(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(s.theta+=o.theta*n.dampingFactor,s.phi+=o.phi*n.dampingFactor):(s.theta+=o.theta,s.phi+=o.phi);let g=n.minAzimuthAngle,y=n.maxAzimuthAngle;return isFinite(g)&&isFinite(y)&&(g<-Math.PI?g+=f:g>Math.PI&&(g-=f),y<-Math.PI?y+=f:y>Math.PI&&(y-=f),s.theta=g<=y?Math.max(g,Math.min(y,s.theta)):s.theta>(g+y)/2?Math.max(g,s.theta):Math.min(y,s.theta)),s.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,s.phi)),s.makeSafe(),s.radius*=l,s.radius=Math.max(n.minDistance,Math.min(n.maxDistance,s.radius)),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),e.setFromSpherical(s),e.applyQuaternion(d),t.copy(n.target).add(e),n.object.lookAt(n.target),!0===n.enableDamping?(o.theta*=1-n.dampingFactor,o.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(o.set(0,0,0),h.set(0,0,0)),l=1,!!(c||m.distanceToSquared(n.object.position)>a||8*(1-p.dot(n.object.quaternion))>a)&&(n.dispatchEvent(Ls),m.copy(n.object.position),p.copy(n.object.quaternion),c=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",H),n.domElement.removeEventListener("pointerdown",O),n.domElement.removeEventListener("pointercancel",V),n.domElement.removeEventListener("wheel",j),n.domElement.removeEventListener("pointermove",D),n.domElement.removeEventListener("pointerup",F),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",q)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let r=i.NONE;const a=1e-6,s=new bs,o=new bs;let l=1;const h=new Ji;let c=!1;const u=new Ti,d=new Ti,m=new Ti,p=new Ti,f=new Ti,g=new Ti,y=new Ti,x=new Ti,_=new Ti,v=[],w={};function M(){return Math.pow(.95,n.zoomSpeed)}function b(t){o.theta-=t}function E(t){o.phi-=t}const k=function(){const t=new Ji;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),h.add(t)}}(),S=function(){const t=new Ji;return function(e,i){!0===n.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),h.add(t)}}(),A=function(){const t=new Ji;return function(e,i){const r=n.domElement;if(n.object.isPerspectiveCamera){const a=n.object.position;t.copy(a).sub(n.target);let s=t.length();s*=Math.tan(n.object.fov/2*Math.PI/180),k(2*e*s/r.clientHeight,n.object.matrix),S(2*i*s/r.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(k(e*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),S(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function z(t){n.object.isPerspectiveCamera?l/=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(t){n.object.isPerspectiveCamera?l*=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function T(t){u.set(t.clientX,t.clientY)}function C(t){p.set(t.clientX,t.clientY)}function L(){if(1===v.length)u.set(v[0].pageX,v[0].pageY);else{const t=.5*(v[0].pageX+v[1].pageX),e=.5*(v[0].pageY+v[1].pageY);u.set(t,e)}}function $(){if(1===v.length)p.set(v[0].pageX,v[0].pageY);else{const t=.5*(v[0].pageX+v[1].pageX),e=.5*(v[0].pageY+v[1].pageY);p.set(t,e)}}function P(){const t=v[0].pageX-v[1].pageX,e=v[0].pageY-v[1].pageY,n=Math.sqrt(t*t+e*e);y.set(0,n)}function R(t){if(1==v.length)d.set(t.pageX,t.pageY);else{const e=Y(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);d.set(n,i)}m.subVectors(d,u).multiplyScalar(n.rotateSpeed);const e=n.domElement;b(2*Math.PI*m.x/e.clientHeight),E(2*Math.PI*m.y/e.clientHeight),u.copy(d)}function B(t){if(1===v.length)f.set(t.pageX,t.pageY);else{const e=Y(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);f.set(n,i)}g.subVectors(f,p).multiplyScalar(n.panSpeed),A(g.x,g.y),p.copy(f)}function I(t){const e=Y(t),i=t.pageX-e.x,r=t.pageY-e.y,a=Math.sqrt(i*i+r*r);x.set(0,a),_.set(0,Math.pow(x.y/y.y,n.zoomSpeed)),z(_.y),y.copy(x)}function O(t){!1!==n.enabled&&(0===v.length&&(n.domElement.setPointerCapture(t.pointerId),n.domElement.addEventListener("pointermove",D),n.domElement.addEventListener("pointerup",F)),function(t){v.push(t)}(t),"touch"===t.pointerType?function(t){switch(W(t),v.length){case 1:switch(n.touches.ONE){case wi:if(!1===n.enableRotate)return;L(),r=i.TOUCH_ROTATE;break;case Mi:if(!1===n.enablePan)return;$(),r=i.TOUCH_PAN;break;default:r=i.NONE}break;case 2:switch(n.touches.TWO){case bi:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&P(),n.enablePan&&$(),r=i.TOUCH_DOLLY_PAN;break;case Ei:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&P(),n.enableRotate&&L(),r=i.TOUCH_DOLLY_ROTATE;break;default:r=i.NONE}break;default:r=i.NONE}r!==i.NONE&&n.dispatchEvent($s)}(t):function(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case _i:if(!1===n.enableZoom)return;!function(t){y.set(t.clientX,t.clientY)}(t),r=i.DOLLY;break;case xi:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;C(t),r=i.PAN}else{if(!1===n.enableRotate)return;T(t),r=i.ROTATE}break;case vi:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;T(t),r=i.ROTATE}else{if(!1===n.enablePan)return;C(t),r=i.PAN}break;default:r=i.NONE}r!==i.NONE&&n.dispatchEvent($s)}(t))}function D(t){!1!==n.enabled&&("touch"===t.pointerType?function(t){switch(W(t),r){case i.TOUCH_ROTATE:if(!1===n.enableRotate)return;R(t),n.update();break;case i.TOUCH_PAN:if(!1===n.enablePan)return;B(t),n.update();break;case i.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(t){n.enableZoom&&I(t),n.enablePan&&B(t)}(t),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(t){n.enableZoom&&I(t),n.enableRotate&&R(t)}(t),n.update();break;default:r=i.NONE}}(t):function(t){if(!1===n.enabled)return;switch(r){case i.ROTATE:if(!1===n.enableRotate)return;!function(t){d.set(t.clientX,t.clientY),m.subVectors(d,u).multiplyScalar(n.rotateSpeed);const e=n.domElement;b(2*Math.PI*m.x/e.clientHeight),E(2*Math.PI*m.y/e.clientHeight),u.copy(d),n.update()}(t);break;case i.DOLLY:if(!1===n.enableZoom)return;!function(t){x.set(t.clientX,t.clientY),_.subVectors(x,y),_.y>0?z(M()):_.y<0&&N(M()),y.copy(x),n.update()}(t);break;case i.PAN:if(!1===n.enablePan)return;!function(t){f.set(t.clientX,t.clientY),g.subVectors(f,p).multiplyScalar(n.panSpeed),A(g.x,g.y),p.copy(f),n.update()}(t)}}(t))}function F(t){U(t),0===v.length&&(n.domElement.releasePointerCapture(t.pointerId),n.domElement.removeEventListener("pointermove",D),n.domElement.removeEventListener("pointerup",F)),n.dispatchEvent(Ps),r=i.NONE}function V(t){U(t)}function j(t){!1!==n.enabled&&!1!==n.enableZoom&&r===i.NONE&&(t.preventDefault(),n.dispatchEvent($s),function(t){t.deltaY<0?N(M()):t.deltaY>0&&z(M()),n.update()}(t),n.dispatchEvent(Ps))}function q(t){!1!==n.enabled&&!1!==n.enablePan&&function(t){let e=!1;switch(t.code){case n.keys.UP:A(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:A(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:A(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:A(-n.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),n.update())}(t)}function H(t){!1!==n.enabled&&t.preventDefault()}function U(t){delete w[t.pointerId];for(let e=0;e<v.length;e++)if(v[e].pointerId==t.pointerId)return void v.splice(e,1)}function W(t){let e=w[t.pointerId];void 0===e&&(e=new Ti,w[t.pointerId]=e),e.set(t.pageX,t.pageY)}function Y(t){const e=t.pointerId===v[0].pointerId?v[1]:v[0];return w[e.pointerId]}n.domElement.addEventListener("contextmenu",H),n.domElement.addEventListener("pointerdown",O),n.domElement.addEventListener("pointercancel",V),n.domElement.addEventListener("wheel",j,{passive:!1}),this.update()}}function Bs({paramFunction:e,scale:i,segments:r}){const a=n(),s=new Cs(e,r,r,!0);return t.createElement("mesh",{ref:a,scale:i,geometry:s},t.createElement("meshNormalMaterial",{side:2}))}const Is=()=>{const{camera:t,gl:e}=y();return i((()=>{const n=new Rs(t,e.domElement);return n.minDistance=5,n.maxDistance=20,()=>{n.dispose()}}),[t,e]),null};function Os({cameraParams:e={fov:60,position:[12,5,12],near:.1,far:30},z:n,segments:i=100,xMin:r=-10,gridColor:a="lightgrey",xMax:s=10,xRange:o=s-r,yMin:l=-10,yMax:h=10,yRange:c=h-l,scale:u=.3,size:d=[500,500]}){const m={width:d[0],height:d[1]};return t.createElement("div",{className:"hago"},t.createElement("div",{style:m},t.createElement(g,{camera:e,onCreated:({camera:t})=>t.lookAt(0,0,0)},t.createElement(Is,null),t.createElement("pointLight",{position:[0,250,0],color:16777215}),t.createElement("primitive",{object:new ks(10)}),t.createElement("primitive",{object:new Es(10,20,a,a)}),t.createElement(Bs,{paramFunction:function(t,e,i){var a=n(t=o*t+r,e=c*e+l);return isNaN(a)?i.set(0,0,0):i.set(t,a,e)},scale:u,segments:i}))))}function Ds(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function Fs(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=js)):void 0===e&&(e=Vs);for(var n,i,r,a,s,o=new Us(t),l=[o];n=l.pop();)if((r=e(n.data))&&(s=(r=Array.from(r)).length))for(n.children=r,a=s-1;a>=0;--a)l.push(i=r[a]=new Us(r[a])),i.parent=n,i.depth=n.depth+1;return o.eachBefore(Hs)}function Vs(t){return t.children}function js(t){return Array.isArray(t)?t[1]:null}function qs(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Hs(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Us(t){this.data=t,this.depth=this.height=0,this.parent=null}function Ws(t){return null==t?null:function(t){if("function"!=typeof t)throw new Error;return t}(t)}Us.prototype=Fs.prototype={constructor:Us,count:function(){return this.eachAfter(Ds)},each:function(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this},eachAfter:function(t,e){for(var n,i,r,a=this,s=[a],o=[],l=-1;a=s.pop();)if(o.push(a),n=a.children)for(i=0,r=n.length;i<r;++i)s.push(n[i]);for(;a=o.pop();)t.call(e,a,++l,this);return this},eachBefore:function(t,e){for(var n,i,r=this,a=[r],s=-1;r=a.pop();)if(t.call(e,r,++s,this),n=r.children)for(i=n.length-1;i>=0;--i)a.push(n[i]);return this},find:function(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;t=n.pop(),e=i.pop();for(;t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Fs(this).eachBefore(qs)},[Symbol.iterator]:function*(){var t,e,n,i,r=this,a=[r];do{for(t=a.reverse(),a=[];r=t.pop();)if(yield r,e=r.children)for(n=0,i=e.length;n<i;++n)a.push(e[n])}while(a.length)}};var Ys={depth:-1},Xs={},Zs={};function Gs(t){return t.id}function Js(t){return t.parentId}function Qs(){var t,e=Gs,n=Js;function i(i){var r,a,s,o,l,h,c,u,d=Array.from(i),m=e,p=n,f=new Map;if(null!=t){const e=d.map(((e,n)=>function(t){let e=(t=`${t}`).length;to(t,e-1)&&!to(t,e-2)&&(t=t.slice(0,-1));return"/"===t[0]?t:`/${t}`}(t(e,n,i)))),n=e.map(Ks),r=new Set(e).add("");for(const t of n)r.has(t)||(r.add(t),e.push(t),n.push(Ks(t)),d.push(Zs));m=(t,n)=>e[n],p=(t,e)=>n[e]}for(s=0,r=d.length;s<r;++s)a=d[s],h=d[s]=new Us(a),null!=(c=m(a,s,i))&&(c+="")&&(u=h.id=c,f.set(u,f.has(u)?Xs:h)),null!=(c=p(a,s,i))&&(c+="")&&(h.parent=c);for(s=0;s<r;++s)if(c=(h=d[s]).parent){if(!(l=f.get(c)))throw new Error("missing: "+c);if(l===Xs)throw new Error("ambiguous: "+c);l.children?l.children.push(h):l.children=[h],h.parent=l}else{if(o)throw new Error("multiple roots");o=h}if(!o)throw new Error("no root");if(null!=t){for(;o.data===Zs&&1===o.children.length;)o=o.children[0],--r;for(let t=d.length-1;t>=0&&(h=d[t],h.data===Zs);--t)h.data=null}if(o.parent=Ys,o.eachBefore((function(t){t.depth=t.parent.depth+1,--r})).eachBefore(Hs),o.parent=null,r>0)throw new Error("cycle");return o}return i.id=function(t){return arguments.length?(e=Ws(t),i):e},i.parentId=function(t){return arguments.length?(n=Ws(t),i):n},i.path=function(e){return arguments.length?(t=Ws(e),i):t},i}function Ks(t){let e=t.length;if(e<2)return"";for(;--e>1&&!to(t,e););return t.slice(0,e)}function to(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}function eo(t,e){return t.parent===e.parent?1:2}function no(t){var e=t.children;return e?e[0]:t.t}function io(t){var e=t.children;return e?e[e.length-1]:t.t}function ro(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function ao(t,e,n){return t.a.parent===e.parent?t.a:n}function so(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function oo(){var t=eo,e=1,n=1,i=null;function r(r){var l=function(t){for(var e,n,i,r,a,s=new so(t,0),o=[s];e=o.pop();)if(i=e._.children)for(e.children=new Array(a=i.length),r=a-1;r>=0;--r)o.push(n=e.children[r]=new so(i[r],r)),n.parent=e;return(s.parent=new so(null,0)).children=[s],s}(r);if(l.eachAfter(a),l.parent.m=-l.z,l.eachBefore(s),i)r.eachBefore(o);else{var h=r,c=r,u=r;r.eachBefore((function(t){t.x<h.x&&(h=t),t.x>c.x&&(c=t),t.depth>u.depth&&(u=t)}));var d=h===c?1:t(h,c)/2,m=d-h.x,p=e/(c.x+d+m),f=n/(u.depth||1);r.eachBefore((function(t){t.x=(t.x+m)*p,t.y=t.depth*f}))}return r}function a(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,r=t.children,a=r.length;--a>=0;)(e=r[a]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;r?(e.z=r.z+t(e._,r._),e.m=e.z-a):e.z=a}else r&&(e.z=r.z+t(e._,r._));e.parent.A=function(e,n,i){if(n){for(var r,a=e,s=e,o=n,l=a.parent.children[0],h=a.m,c=s.m,u=o.m,d=l.m;o=io(o),a=no(a),o&&a;)l=no(l),(s=io(s)).a=e,(r=o.z+u-a.z-h+t(o._,a._))>0&&(ro(ao(o,e,i),e,r),h+=r,c+=r),u+=o.m,h+=a.m,d+=l.m,c+=s.m;o&&!io(s)&&(s.t=o,s.m+=u-c),a&&!no(l)&&(l.t=a,l.m+=h-d,i=e)}return i}(e,r,e.parent.A||i[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function o(t){t.x*=e,t.y=t.depth*n}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r}function lo(t){let e,n;if(null!=t.children){let i=t.children[0],r=t.children[1];e=null!=i.data.hide&&i.data.hide?0:i.height+1,n=null!=r.data.hide&&r.data.hide?0:r.height+1}else e=t.height+1,n=t.height+1;return e-n}function ho({data:e=[[1,2],[2,3],[2,4]],nodes:n,id:i,nodeFontSize:r=.6,nodeRadius:a=7,width:s=250,height:o=250,scale:l=100,slim:h=0,cwidth:c=l,cheight:u,marginTop:d=20,marginBottom:m=20,marginRight:p=20,marginLeft:f=20,margins:g=[d,p+h,m,f+h],edgeLength:y,markLevels:_=!1,markDepth:v=!1,markHeight:w=!1,markHeightBF:b=!1,heightStartsAt:E=0}){const S=k(s,o,g),A=n||function(t){let e;return e=St(t)?j(t):V(t),e}(e),z=Qs().id((t=>t.child)).parentId((t=>t.parent))(A),N=y||W(z),T=oo().size([S.width,N]).separation(((t,e)=>t.parent===e.parent?1:1.1));T(z);const C=z.links(),L=z.descendants();return t.createElement(x,{className:"tree",width:s,height:o,cwidth:c,cheight:u,margins:g},t.createElement("g",{className:"hago_tree"},function(e,n,i,r){return e?t.createElement("g",{className:"hago_tree_levels"},function(t){const e=[];let n=t[0].depth;e.push(t[0]);for(let i=0;i<t.length;i++)t[i].depth>n&&(e.push(t[i]),n=t[i].depth);return e}(n).map((e=>t.createElement("g",null,t.createElement(M,{val:e.depth+1,pos:{x:0,y:e.y+3},color:"lightgrey",fontSize:r-.2}),t.createElement("line",{x1:-i.width+i.width+10,y1:e.y,x2:i.width,y2:e.y,stroke:"lightgrey"}))))):t.createElement(t.Fragment,null)}(_,L,S,r),function(e,n,i,r,a){return e?t.createElement("g",{className:"hago_tree_depth_marks"},n.map(((e,n)=>t.createElement(M,{val:e.depth,pos:{x:e.x,y:e.y},key:`${i}_${n}`,dy:-r-r/2,fontSize:a-.2})))):t.createElement(t.Fragment,null)}(v,L,i,a,r),function(e,n){return t.createElement("g",{className:"hago_tree_edges"},e.map(((e,i)=>t.createElement("g",{className:"hago_tree_edge",key:`${n}_tree_edge_${i}`},t.createElement("line",{x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y,display:Y(e),stroke:"currentColor"})))))}(C,i),function(e,n,i=5){return t.createElement("g",{className:"hago_tree_nodes"},e.map((e=>t.createElement("g",{transform:`translate(${e.x}, ${e.y})`,display:Y(e)},t.createElement("circle",{stroke:"currentColor",r:i,fill:"white"}),t.createElement("text",{textAnchor:"middle",fontSize:`${n}rem`,dy:"0.3em"},e.id)))))}(L,r,a),function(e,n,i,r,a){return e?t.createElement("g",{className:"hago_tree_height_marks"},n.filter((t=>!t.data.hide)).map((e=>t.createElement(M,{val:e.height+i,pos:{x:e.x,y:e.y},dx:r+r/2,dy:r/2,fontSize:a-.2})))):t.createElement(t.Fragment,null)}(w,L,E,a,r),function(e,n,i,r){return e?t.createElement("g",{className:"hago_tree_height_balance_factor_marks"},n.filter((t=>!t.data.hide)).map((e=>t.createElement("g",{className:Math.abs(lo(e))>1?"imbalanced":"balanced"},t.createElement(M,{val:lo(e),fontSize:i-.2,pos:{x:e.x,y:e.y},dy:-r-r/2}))))):t.createElement(t.Fragment,null)}(b,L,r,a)))}function co({data:e=[1,2,3,4],reverseIndex:n=!1,startIndex:i=0,className:r="hago_StaticArray",id:a=S(r),width:s=.574045*e.length**2+22.878*e.length+45.8824,height:o=s,scale:l=100,cwidth:h=l,cheight:c=.5,marginTop:u=30,marginRight:d=30,marginBottom:m=30,marginLeft:p=30,margins:f=[u,d,m,p]}){const g=k(s,o,f),y=F(e),_=Fe().domain(y).range([0,g.width]).paddingInner(.1),v=_.bandwidth();return t.createElement(x,{className:r,width:s,height:o,cwidth:h,cheight:c,margins:f},t.createElement("defs",null,t.createElement(U,{id:"Hago_StaticArray_Pointer",refX:0,refY:0,width:5,height:5,orient:"auto"})),y.map(((e,r)=>t.createElement("g",{className:I(e.class,"hago_StaticArray_element"),key:`${a}_${r}`,transform:A(_(e),0)},t.createElement("rect",{fill:"white",stroke:"black",width:v,height:v}),t.createElement("g",{className:"hago_StaticArray_element_text"},t.createElement("text",{textAnchor:"middle",fontSize:"0.7rem",dx:v/2,dy:v/1.5},e.val)),t.createElement("g",{className:"hago_StaticArray_index_text"},t.createElement("text",{textAnchor:"middle",fontSize:"0.6rem",dx:v/2,dy:1.5*v},n?y.length-1-(r-i):r+i)),e.ant&&t.createElement("g",{className:"hago_StaticArray_annotation"},t.createElement("text",{textAnchor:"middle",fontSize:"0.6rem",dx:v/2,dy:-v/2},e.ant||e.ant.val)),e.ptr&&t.createElement("g",{className:"hago_StaticArray_pointer",transform:A(-v/1.65,2.3*v)},t.createElement("text",{dx:5,dy:-3,textAnchor:"middle",fontSize:"0.6rem"},e.ptr),t.createElement(X,{start:{x:0,y:0},end:{x:0,y:-f[2]/2.5},color:"black",markerEnd:"Hago_StaticArray_Pointer"}))))))}function uo(e,n,i,r,a){return t.createElement("g",{className:"hago_LinkedList_datafield"},t.createElement("rect",{width:e,height:n,stroke:"black",fill:"white"}),function(e,n,i){return t.createElement("g",{className:"hago_LinkedList_text_data"},t.createElement("text",{fontSize:"0.55rem",dx:n/2.5,dy:i/1.25},e.val))}(i,e,n),r?function(e,n,i){return t.createElement("g",{className:"hago_LinkedList_text_index"},t.createElement("text",{fontSize:"0.55rem",dx:n/2.5,dy:2*i},e))}(a,e,n):t.createElement(t.Fragment,null))}function mo({data:e=[1,2,3,4,5],className:n="LinkedList",id:i=S(n),width:r=30.1049*e.length+70.1515,height:a=40,scale:s=100,cwidth:o=s,cheight:l,marginTop:h=10,marginRight:c=40,marginBottom:u=10,marginLeft:d=20,margins:m=[h,c,u,d],isIndexed:p=!0}){const f=k(r,a,m),g=F(e),y=Fe().domain(g).rangeRound([0,f.width]).paddingInner(.5),_=y.bandwidth();return t.createElement(x,{className:n,width:r,height:a,cwidth:o,cheight:l,margins:m},function(e){return t.createElement("defs",null,t.createElement(U,{id:`${e}_LinkedList_Arrowhead`,refX:9,refY:0,width:5,height:5,orient:"auto"}),t.createElement(U,{id:`${e}_LinkedList_LinkOrigin`,type:"circle",circleFillColor:"black",radius:2,refX:3,refY:3,width:4,height:4,cx:3,cy:3,viewbox:"0 0 6 6"}))}(i),g.map(((e,n)=>t.createElement("g",{key:`${i}_${n}`,className:I(e.class,"hago_LinkedList_node"),transform:A(y(e),0)},uo(_,10,e,p,n),function(e,n,i){return t.createElement("g",{className:"hago_LinkedList_nextfield",transform:A(e.bandwidth(),0)},t.createElement("rect",{stroke:"black",fill:"white",width:n/2,height:i}))}(y,_,10),function(e,n,i,r){return t.createElement("g",{className:"hago_LinkedList_links"},t.createElement("line",{stroke:"black",x1:e+e/4,y1:n/2,x2:e+i.bandwidth(),y2:n/2,markerEnd:`url(#${r}_LinkedList_Arrowhead)`,markerStart:`url(#${r}_LinkedList_LinkOrigin)`}))}(_,10,y,i)))))}function po({data:e=[1,2,3,4,5,6,7,8,9],className:n="hago_queue",id:i=S(n),fontSize:r=.6,width:a=300,height:s=a,scale:o=100,cwidth:l=o,cheight:h,marginTop:c=20,marginRight:u=50,marginBottom:d=20,marginLeft:m=50,margins:p=[c,u,d,m]}){const f=F(e),g=f.length,y=k(a,s,p),_=Fe().domain(f).range([0,y.width]).paddingInner(.1),v=Fe().domain(f).range([y.height/2,0]),w=_.bandwidth(),M=v.bandwidth();return t.createElement(x,{className:n,width:a,height:s,cwidth:l,cheight:h,margins:p},t.createElement("g",{className:"hago_queue_elements"},t.createElement("defs",null,t.createElement(U,{id:`${i}_Queue_Enter_Arrowhead`,className:"hago_queue_arrow",refX:9,refY:0,width:5,height:5,orient:"auto",arrowColor:"lightgrey"}),t.createElement(U,{id:`${i}_Queue_Exit_Arrowhead`,className:"hago_queue_arrow",refX:9,refY:0,width:5,height:5,orient:"auto",arrowColor:"lightgrey"})),t.createElement("g",{className:"hago_queue_front_label"},t.createElement("text",{fontSize:r-.15+"rem",dx:-w},"out"),t.createElement(X,{start:{x:y.width,y:0},end:{x:0,y:0},markerEnd:`${i}_Queue_Enter_Arrowhead`,color:"lightgrey"})),f.map(((e,n)=>t.createElement("g",{key:`${i}_${n}`,transform:A(_(e),M)},t.createElement("rect",{width:w,height:M,fill:"white",stroke:"black"}),t.createElement("text",{fontSize:`${r}rem`,textAnchor:"middle",dx:w/2,dy:M/1.5},e.val),t.createElement("g",{className:"hago_Queue_enqueue_index"},t.createElement("text",{fontSize:r-.2+"rem",textAnchor:"middle",dx:w/2,dy:1.6*M},g-1-n))))),t.createElement("g",{className:"hago_queue_rear_label",transform:A(y.width,0)},t.createElement("text",{fontSize:r-.15+"rem",dx:w/2,dy:3*M},"in")),t.createElement(X,{start:{x:0,y:3*M},end:{x:y.width,y:3*M},markerEnd:`${i}_Queue_Exit_Arrowhead`,color:"lightgrey"})))}function fo(t,e=1,n=4,i=1){let r=[];const a=/vdots[0-9]+/;let s=e;for(let e=0;e<t.length;e++)s=go(t,e,a,s,r,n,i);return r}function go(t,e,n,i,r,a,s){if("string"==typeof t[e]&&n.test(t[e])){let n={a:"⋮",val:"⋮",display:"none"};i=i+parseInt(/[0-9]+/.exec(t[e])[0])-1,r.push(n)}else if(Pt(t[e]))r.push(t[e]),i+=t[e].s;else if(zt(t[e])){let n={a:Mt(i,a),val:t[e].val,id:t[e].id?t[e].id:"",className:t[e].className?t[e].className:"memory_cell",s:t[e].s?t[e].s:s,display:"block"};r.push(n),i+=n.s}else{if(!Ct(t[e]))throw new Error("Invalid data input.");{let n={a:Mt(i,a),val:t[e],s:s,display:"block"};r.push(n),i+=n.s}}return i}function yo({data:e=[1,2,3,4,5],className:n="hago_mem",id:i=S(n),endian:r="little",addressLength:a=2,cellWidth:s=20*a,cellHeight:o=20*a,dataSize:l=1,startAddressAt:h=0,width:c=40*e.length,height:u=e.length*o,scale:d=100,cwidth:m=d,cheight:p,marginTop:f=o,marginRight:g=o,marginBottom:y=o,marginLeft:_=o,margins:v=[f,g,y,_]}){const w=k(c,u,v),M=fo(e,h,a,l),b=fo(e).length,E="little"===r?[w.height,0]:[0,w.height],z=hi().domain([0,b]).range(E);return t.createElement(x,{className:n,width:c,height:u,cwidth:m,cheight:p,margins:v},t.createElement("g",{transform:A(w.width/2,0)},M.map(((e,n)=>t.createElement("g",{className:e.className,key:`${i}_cell_${n}`,transform:A(0,z(n))},t.createElement("g",{className:"memory_cell_address"},t.createElement("rect",{width:s,height:o/2,stroke:"black",fill:"none",display:e.display}),t.createElement("text",{dx:s>>1,dy:o/3,fontSize:"0.7rem",textAnchor:"middle"},`${e.a}`)),t.createElement("g",{className:"memory_cell_value",transform:A(s,0)},t.createElement("rect",{width:s,height:o/2,stroke:"black",fill:"none",display:e.display}),t.createElement("text",{fontSize:"0.7rem",textAnchor:"middle",dx:s>>1,dy:o/3},`${e.val}`)),t.createElement("g",{className:"memory_cell_value",transform:A(2*s,0)},e.id&&t.createElement("text",{dx:5,dy:o/3,fontSize:"0.7rem",textAnchor:"start"},e.id)))))))}function xo(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a,s,o,l,h,c,u,d,m=t._root,p={data:i},f=t._x0,g=t._y0,y=t._x1,x=t._y1;if(!m)return t._root=p,t;for(;m.length;)if((h=e>=(a=(f+y)/2))?f=a:y=a,(c=n>=(s=(g+x)/2))?g=s:x=s,r=m,!(m=m[u=c<<1|h]))return r[u]=p,t;if(o=+t._x.call(null,m.data),l=+t._y.call(null,m.data),e===o&&n===l)return p.next=m,r?r[u]=p:t._root=p,t;do{r=r?r[u]=new Array(4):t._root=new Array(4),(h=e>=(a=(f+y)/2))?f=a:y=a,(c=n>=(s=(g+x)/2))?g=s:x=s}while((u=c<<1|h)==(d=(l>=s)<<1|o>=a));return r[d]=m,r[u]=p,t}function _o(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function vo(t){return t[0]}function wo(t){return t[1]}function Mo(t,e,n){var i=new bo(null==e?vo:e,null==n?wo:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function bo(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function Eo(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}so.prototype=Object.create(Us.prototype);var ko=Mo.prototype=bo.prototype;function So(t){return function(){return t}}function Ao(t){return 1e-6*(t()-.5)}function zo(t){return t.x+t.vx}function No(t){return t.y+t.vy}function To(t){return t.index}function Co(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}ko.copy=function(){var t,e,n=new bo(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Eo(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=Eo(e));return n},ko.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return xo(this.cover(e,n),e,n,t)},ko.addAll=function(t){var e,n,i,r,a=t.length,s=new Array(a),o=new Array(a),l=1/0,h=1/0,c=-1/0,u=-1/0;for(n=0;n<a;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(s[n]=i,o[n]=r,i<l&&(l=i),i>c&&(c=i),r<h&&(h=r),r>u&&(u=r));if(l>c||h>u)return this;for(this.cover(l,h).cover(c,u),n=0;n<a;++n)xo(this,s[n],o[n],t[n]);return this},ko.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var s,o,l=r-n||1,h=this._root;n>t||t>=r||i>e||e>=a;)switch(o=(e<i)<<1|t<n,(s=new Array(4))[o]=h,h=s,l*=2,o){case 0:r=n+l,a=i+l;break;case 1:n=r-l,a=i+l;break;case 2:r=n+l,i=a-l;break;case 3:n=r-l,i=a-l}this._root&&this._root.length&&(this._root=h)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this},ko.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},ko.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ko.find=function(t,e,n){var i,r,a,s,o,l,h,c=this._x0,u=this._y0,d=this._x1,m=this._y1,p=[],f=this._root;for(f&&p.push(new _o(f,c,u,d,m)),null==n?n=1/0:(c=t-n,u=e-n,d=t+n,m=e+n,n*=n);l=p.pop();)if(!(!(f=l.node)||(r=l.x0)>d||(a=l.y0)>m||(s=l.x1)<c||(o=l.y1)<u))if(f.length){var g=(r+s)/2,y=(a+o)/2;p.push(new _o(f[3],g,y,s,o),new _o(f[2],r,y,g,o),new _o(f[1],g,a,s,y),new _o(f[0],r,a,g,y)),(h=(e>=y)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-h],p[p.length-1-h]=l)}else{var x=t-+this._x.call(null,f.data),_=e-+this._y.call(null,f.data),v=x*x+_*_;if(v<n){var w=Math.sqrt(n=v);c=t-w,u=e-w,d=t+w,m=e+w,i=f.data}}return i},ko.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,i,r,a,s,o,l,h,c,u,d,m=this._root,p=this._x0,f=this._y0,g=this._x1,y=this._y1;if(!m)return this;if(m.length)for(;;){if((h=a>=(o=(p+g)/2))?p=o:g=o,(c=s>=(l=(f+y)/2))?f=l:y=l,e=m,!(m=m[u=c<<1|h]))return this;if(!m.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(n=e,d=u)}for(;m.data!==t;)if(i=m,!(m=m.next))return this;return(r=m.next)&&delete m.next,i?(r?i.next=r:delete i.next,this):e?(r?e[u]=r:delete e[u],(m=e[0]||e[1]||e[2]||e[3])&&m===(e[3]||e[2]||e[1]||e[0])&&!m.length&&(n?n[d]=m:this._root=m),this):(this._root=r,this)},ko.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},ko.root=function(){return this._root},ko.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},ko.visit=function(t){var e,n,i,r,a,s,o=[],l=this._root;for(l&&o.push(new _o(l,this._x0,this._y0,this._x1,this._y1));e=o.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,a=e.x1,s=e.y1)&&l.length){var h=(i+a)/2,c=(r+s)/2;(n=l[3])&&o.push(new _o(n,h,c,a,s)),(n=l[2])&&o.push(new _o(n,i,c,h,s)),(n=l[1])&&o.push(new _o(n,h,r,a,c)),(n=l[0])&&o.push(new _o(n,i,r,h,c))}return this},ko.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new _o(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var a,s=e.x0,o=e.y0,l=e.x1,h=e.y1,c=(s+l)/2,u=(o+h)/2;(a=r[0])&&n.push(new _o(a,s,o,c,u)),(a=r[1])&&n.push(new _o(a,c,o,l,u)),(a=r[2])&&n.push(new _o(a,s,u,c,h)),(a=r[3])&&n.push(new _o(a,c,u,l,h))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},ko.x=function(t){return arguments.length?(this._x=t,this):this._x},ko.y=function(t){return arguments.length?(this._y=t,this):this._y};var Lo={value:()=>{}};function $o(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Po(i)}function Po(t){this._=t}function Ro(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Bo(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Io(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Lo,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Po.prototype=$o.prototype={constructor:Po,on:function(t,e){var n,i=this._,r=Ro(t+"",i),a=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=r[a]).type)i[n]=Io(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Io(i[n],t.name,null);return this}for(;++a<s;)if((n=(t=r[a]).type)&&(n=Bo(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Po(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};var Oo,Do,Fo=0,Vo=0,jo=0,qo=0,Ho=0,Uo=0,Wo="object"==typeof performance&&performance.now?performance:Date,Yo="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xo(){return Ho||(Yo(Zo),Ho=Wo.now()+Uo)}function Zo(){Ho=0}function Go(){this._call=this._time=this._next=null}function Jo(t,e,n){var i=new Go;return i.restart(t,e,n),i}function Qo(){Ho=(qo=Wo.now())+Uo,Fo=Vo=0;try{!function(){Xo(),++Fo;for(var t,e=Oo;e;)(t=Ho-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Fo}()}finally{Fo=0,function(){var t,e,n=Oo,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Oo=e);Do=t,tl(i)}(),Ho=0}}function Ko(){var t=Wo.now(),e=t-qo;e>1e3&&(Uo-=e,qo=t)}function tl(t){Fo||(Vo&&(Vo=clearTimeout(Vo)),t-Ho>24?(t<1/0&&(Vo=setTimeout(Qo,t-Wo.now()-Uo)),jo&&(jo=clearInterval(jo))):(jo||(qo=Wo.now(),jo=setInterval(Ko,1e3)),Fo=1,Yo(Qo)))}Go.prototype=Jo.prototype={constructor:Go,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Xo():+n)+(null==e?0:+e),this._next||Do===this||(Do?Do._next=this:Oo=this,Do=this),this._call=t,this._time=n,tl()},stop:function(){this._call&&(this._call=null,this._time=1/0,tl())}};const el=4294967296;function nl(t){return t.x}function il(t){return t.y}var rl=Math.PI*(3-Math.sqrt(5));function al(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,s=.6,o=new Map,l=Jo(u),h=$o("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%el)/el}();function u(){d(),h.call("tick",e),n<i&&(l.stop(),h.call("end",e))}function d(i){var l,h,c=t.length;void 0===i&&(i=1);for(var u=0;u<i;++u)for(n+=(a-n)*r,o.forEach((function(t){t(n)})),l=0;l<c;++l)null==(h=t[l]).fx?h.x+=h.vx*=s:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=s:(h.y=h.fy,h.vy=0);return e}function m(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+n),a=n*rl;e.x=r*Math.cos(a),e.y=r*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),m(),e={tick:d,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,m(),o.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(c=t,o.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?o.delete(t):o.set(t,p(n)),e):o.get(t)},find:function(e,n,i){var r,a,s,o,l,h=0,c=t.length;for(null==i?i=1/0:i*=i,h=0;h<c;++h)(s=(r=e-(o=t[h]).x)*r+(a=n-o.y)*a)<i&&(l=o,i=s);return l},on:function(t,n){return arguments.length>1?(h.on(t,n),e):h.on(t)}}}function sl(t){let e=t.source.x,n=t.source.y,i=t.target.x,r=t.target.y,a=i-e,s=r-n,o=Math.sqrt(a*a+s*s),l=o,h=o,c=1,u=0;return function(t){const e=t.source.x,n=t.source.y,i=t.target.x,r=t.target.y;return e===i&&n===r}(t)&&(c=-45,u=1,l=12,h=12,i+=1,r+=1),`M${e},${n}A${l},${h} ${c},${u},1 ${i},${r}`}function ol({data:e=[[1,2],[2,4],[5,6],[7,6],[6,8],[8,9],[11,2],[0,9],[12,2]],className:n="hago_graph",isDirected:i=!1,id:r=S(n),straightEdge:a=!0,width:s=500,height:o=500,scale:l=100,cwidth:h=l,cheight:c,radius:u=10,fontSize:d=.8,textOffsetX:m=0,textOffsetY:p=u/2,blast:f=10,edgeLength:g=50,repulsion:y=.01,marginTop:_=50,marginBottom:v=50,marginRight:w=50,marginLeft:M=50,margins:b=[_,w,v,M]}){const E=k(s,o,b),z=function(t){let e,n=[];for(let i=0;i<t.length;i++)if(void 0!==t[i].link){let r=t[i].link;e={source:r[0],target:r[1],...r},n.push(e)}else if(At(t[i]))n.push(e);else{const e=t[i],r=e.length?e.length:0;if(r>0)for(let t=0;t<r;t++){const i={source:e[t],target:e[(t+1)%r]};n.push(i)}}return n}(e),N=function(t){let e,n,i,r={};for(let a=0;a<t.length;a++){if(i=t[a],i.source){let t=i.source;e={id:t,...i},i.source=r[t]||(r[t]=e)}if(i.target){let t=i.target;n={id:t,...i},i.target=r[t]||(r[t]=n)}}return Object.values(r)}(z),T=function(t,e){var n,i=1;function r(){var r,a,s=n.length,o=0,l=0;for(r=0;r<s;++r)o+=(a=n[r]).x,l+=a.y;for(o=(o/s-t)*i,l=(l/s-e)*i,r=0;r<s;++r)(a=n[r]).x-=o,a.y-=l}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r.strength=function(t){return arguments.length?(i=+t,r):i},r}().x(E.width/2).y(E.height/2),C=function(){var t,e,n,i,r,a=So(-30),s=1,o=1/0,l=.81;function h(n){var r,a=t.length,s=Mo(t,nl,il).visitAfter(u);for(i=n,r=0;r<a;++r)e=t[r],s.visit(d)}function c(){if(t){var e,n,i=t.length;for(r=new Array(i),e=0;e<i;++e)n=t[e],r[n.index]=+a(n,e,t)}}function u(t){var e,n,i,a,s,o=0,l=0;if(t.length){for(i=a=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(o+=e.value,l+=n,i+=n*e.x,a+=n*e.y);t.x=i/l,t.y=a/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{o+=r[e.data.index]}while(e=e.next)}t.value=o}function d(t,a,h,c){if(!t.value)return!0;var u=t.x-e.x,d=t.y-e.y,m=c-a,p=u*u+d*d;if(m*m/l<p)return p<o&&(0===u&&(p+=(u=Ao(n))*u),0===d&&(p+=(d=Ao(n))*d),p<s&&(p=Math.sqrt(s*p)),e.vx+=u*t.value*i/p,e.vy+=d*t.value*i/p),!0;if(!(t.length||p>=o)){(t.data!==e||t.next)&&(0===u&&(p+=(u=Ao(n))*u),0===d&&(p+=(d=Ao(n))*d),p<s&&(p=Math.sqrt(s*p)));do{t.data!==e&&(m=r[t.data.index]*i/p,e.vx+=u*m,e.vy+=d*m)}while(t=t.next)}}return h.initialize=function(e,i){t=e,n=i,c()},h.strength=function(t){return arguments.length?(a="function"==typeof t?t:So(+t),c(),h):a},h.distanceMin=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.distanceMax=function(t){return arguments.length?(o=t*t,h):Math.sqrt(o)},h.theta=function(t){return arguments.length?(l=t*t,h):Math.sqrt(l)},h}().strength(-150).distanceMax(100),L=function(t){var e,n,i,r=So(.1);function a(t){for(var r,a=0,s=e.length;a<s;++a)(r=e[a]).vx+=(i[a]-r.x)*n[a]*t}function s(){if(e){var a,s=e.length;for(n=new Array(s),i=new Array(s),a=0;a<s;++a)n[a]=isNaN(i[a]=+t(e[a],a,e))?0:+r(e[a],a,e)}}return"function"!=typeof t&&(t=So(null==t?0:+t)),a.initialize=function(t){e=t,s()},a.strength=function(t){return arguments.length?(r="function"==typeof t?t:So(+t),s(),a):r},a.x=function(e){return arguments.length?(t="function"==typeof e?e:So(+e),s(),a):t},a}(E.width/2).strength(y),$=function(t){var e,n,i,r=So(.1);function a(t){for(var r,a=0,s=e.length;a<s;++a)(r=e[a]).vy+=(i[a]-r.y)*n[a]*t}function s(){if(e){var a,s=e.length;for(n=new Array(s),i=new Array(s),a=0;a<s;++a)n[a]=isNaN(i[a]=+t(e[a],a,e))?0:+r(e[a],a,e)}}return"function"!=typeof t&&(t=So(null==t?0:+t)),a.initialize=function(t){e=t,s()},a.strength=function(t){return arguments.length?(r="function"==typeof t?t:So(+t),s(),a):r},a.y=function(e){return arguments.length?(t="function"==typeof e?e:So(+e),s(),a):t},a}(E.height/2).strength(y),P=al(N).force("charge",C).force("link",function(t){var e,n,i,r,a,s,o=To,l=function(t){return 1/Math.min(r[t.source.index],r[t.target.index])},h=So(30),c=1;function u(i){for(var r=0,o=t.length;r<c;++r)for(var l,h,u,d,m,p,f,g=0;g<o;++g)h=(l=t[g]).source,d=(u=l.target).x+u.vx-h.x-h.vx||Ao(s),m=u.y+u.vy-h.y-h.vy||Ao(s),d*=p=((p=Math.sqrt(d*d+m*m))-n[g])/p*i*e[g],m*=p,u.vx-=d*(f=a[g]),u.vy-=m*f,h.vx+=d*(f=1-f),h.vy+=m*f}function d(){if(i){var s,l,h=i.length,c=t.length,u=new Map(i.map(((t,e)=>[o(t,e,i),t])));for(s=0,r=new Array(h);s<c;++s)(l=t[s]).index=s,"object"!=typeof l.source&&(l.source=Co(u,l.source)),"object"!=typeof l.target&&(l.target=Co(u,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(s=0,a=new Array(c);s<c;++s)l=t[s],a[s]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);e=new Array(c),m(),n=new Array(c),p()}}function m(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+l(t[n],n,t)}function p(){if(i)for(var e=0,r=t.length;e<r;++e)n[e]=+h(t[e],e,t)}return null==t&&(t=[]),u.initialize=function(t,e){i=t,s=e,d()},u.links=function(e){return arguments.length?(t=e,d(),u):t},u.id=function(t){return arguments.length?(o=t,u):o},u.iterations=function(t){return arguments.length?(c=+t,u):c},u.strength=function(t){return arguments.length?(l="function"==typeof t?t:So(+t),m(),u):l},u.distance=function(t){return arguments.length?(h="function"==typeof t?t:So(+t),p(),u):h},u}(z).distance(g).iterations(1)).force("center",T).force("x",L).force("y",$).force("collision",function(t){var e,n,i,r=1,a=1;function s(){for(var t,s,l,h,c,u,d,m=e.length,p=0;p<a;++p)for(s=Mo(e,zo,No).visitAfter(o),t=0;t<m;++t)l=e[t],u=n[l.index],d=u*u,h=l.x+l.vx,c=l.y+l.vy,s.visit(f);function f(t,e,n,a,s){var o=t.data,m=t.r,p=u+m;if(!o)return e>h+p||a<h-p||n>c+p||s<c-p;if(o.index>l.index){var f=h-o.x-o.vx,g=c-o.y-o.vy,y=f*f+g*g;y<p*p&&(0===f&&(y+=(f=Ao(i))*f),0===g&&(y+=(g=Ao(i))*g),y=(p-(y=Math.sqrt(y)))/y*r,l.vx+=(f*=y)*(p=(m*=m)/(d+m)),l.vy+=(g*=y)*p,o.vx-=f*(p=1-p),o.vy-=g*p)}}}function o(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var i,r,a=e.length;for(n=new Array(a),i=0;i<a;++i)r=e[i],n[r.index]=+t(r,i,e)}}return"function"!=typeof t&&(t=So(null==t?1:+t)),s.initialize=function(t,n){e=t,i=n,l()},s.iterations=function(t){return arguments.length?(a=+t,s):a},s.strength=function(t){return arguments.length?(r=+t,s):r},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:So(+e),l(),s):t},s}().radius(f)).stop();return P.tick(300),t.createElement(x,{className:n,width:s,height:o,cwidth:h,cheight:c,margins:b},z.map(((e,n)=>t.createElement("g",{key:`node_${r}_${n}`,className:"hago_graph_edges"},a?t.createElement("line",{x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y,stroke:"black"}):t.createElement("path",{d:sl(e),stroke:"black",fill:"none"})))),N.map(((e,n)=>t.createElement("g",{key:`node_${r}_${n}`,className:"hago_graph_nodes",transform:A(e.x,e.y)},t.createElement("circle",{stroke:"black",r:u,fill:"white"}),t.createElement("text",{fontSize:`${d}rem`,dx:m,dy:p,textAnchor:"middle"},e.id)))))}function ll({data:e=(t=>t**2+1),r:n=5,className:i="hago_sequence",id:r=S(i),width:a=500,height:s=500,scale:o=100,cwidth:l=o,cheight:h,marginTop:c=30,marginRight:u=30,marginBottom:d=30,marginLeft:m=50,margins:p=[c,u,d,m],start:f=0,end:g=20,tickSep:y=50,removeEndTicks:_=!1,removeEndTickX:v=_,removeEndTickY:w=_,renderLolly:M=!0}){const z=k(a,s,p),N=function(t,e=0,n=10){let i,r=[],a=0,s=0,o=e,l=n;if(t.constructor===Array&&t[0].constructor===Array){for(let e=0;e<t.length;e++)if(t[e].constructor===Array&&2===t[e].length){const n=t[e][0],h=t[e][1];a=Z(a,h),s=G(s,h),o=Z(o,n),l=G(l,n),i={x:n,y:h},r.push(i)}}else if(t.constructor===Array)for(let h=0;h<t.length;h++){const c=t[h].className?t[h].className:"hago_plot_point",u=t[h].start?t[h].start:e,d=t[h].end?t[h].end:n;for(let e=u;e<d;e++){const n=e,u=t[h].f(e);a=Z(a,u),s=G(s,u),o=Z(o,n),l=G(l,n),i={x:n,y:u,className:c},r.push(i)}}else{if(t.constructor!==Function)throw new Error("Invalid argument passed.");for(let h=e;h<n;h++){const e=h,n=t(h);a=Z(a,n),s=G(s,n),o=Z(o,e),l=G(l,e),i={x:e,y:n},r.push(i)}}return{data:r,xMin:o,xMax:l,yMin:a,yMax:s}}(e,f,g),T=N.data,C=N.xMin,L=N.xMax,$=N.yMin,P=N.yMax,R=hi().domain([C,L]).range([0,z.width]),B=hi().domain([$,P]).range([z.height,0]);return t.createElement(x,{className:i,width:a,height:s,cwidth:l,cheight:h,margins:p},t.createElement("g",{transform:A(0,B(0))},t.createElement(b,{domain:[C,L],range:[0,z.width],tickSep:y,removeEndTicks:v,dy:d/2,fitContent:!0,latex:!1})),t.createElement("g",{transform:A(R(0),0)},t.createElement(E,{domain:[$,P],range:[z.height,0],tickSep:y,fitContent:!0,dx:-m/4,dy:y/10/2,removeEndTicks:w,textAnchor:"end",latex:!1})),t.createElement("g",{className:"hago_sequence_plot_points"},T.map(((e,i)=>t.createElement("g",{className:e.className?e.className:"hago_plot_point",key:`${r}_${i}`},M?t.createElement(X,{start:{x:R(e.x),y:B(0)},end:{x:R(e.x),y:B(e.y)}}):t.createElement(t.Fragment,null),t.createElement("circle",{r:n,key:`${r}_${i}`,cx:R(e.x),cy:B(e.y),fill:"white",stroke:"black"}))))))}function hl({data:e=[["f"],["f","g"],["f","g","h"],["f","g","h","h"],["f","g","h","h","h"],["f","g","h","h"],["f","g","h"],["f","g"],["f"]],axisGroups:n=[],className:i="hago_stack",id:r=S(i),width:a=500,height:s=150,scale:o=100,cwidth:l=o,cheight:h,marginTop:c=10,marginRight:u=30,marginBottom:d=30,marginLeft:m=30,margins:p=[c,u,d,m]}){const f=k(a,s,p),g=function(t,e){let n=[],i=0,r=0,a=0,s=0;for(let o=0;o<t.length;o++){let l=e[o]?e[o]:o;if(Lt(t[o]))n.push(t[o]);else if(t.constructor===Array&&"string"==typeof t[o][0])for(let e=0;e<t[o].length;e++){a=Z(a,e),s=G(s,e);let i={x:o,y:e,id:t[o][e],group:l};n.push(i)}else{if(t.constructor!==Array||"number"!=typeof t[0])throw new Error("Improperly formatted data.");for(let e=0;e<t[o];e++){a=Z(a,e),s=G(s,e);let t={x:o,y:e,id:"",group:l};n.push(t)}}r=Z(r,o),i=G(i,o)}return{points:n,xMax:i,xMin:r,yMin:a,yMax:s}}(e,n),y=g.xMax,_=g.xMin,v=g.yMax,w=g.yMin,M=Fe().range([0,f.width]).domain(g.points.map((t=>`${t.x}`))).padding(.06),z=Fe().range([f.height,0]).domain(g.points.map((t=>`${t.y}`))),N=M.bandwidth(),T=z.bandwidth();return t.createElement(x,{className:i,width:a,height:s,cwidth:l,cheight:h,margins:p},t.createElement("g",{className:"stack_plot"},t.createElement("g",{className:"stack_plot_y_xis"},t.createElement(E,{domain:[w,v+1],range:[f.height,0],tickSep:T,dx:-m/4,dy:T/8,textAnchor:"end",removeEndTicks:!1,latex:!1})),t.createElement("g",{className:"stack_plot_x_axis",transform:A(0,f.height)},t.createElement(b,{domain:[_,y],range:[0,f.width-N/1.8],tickSep:N,dx:0,dy:d/2,fitContent:!1,removeEndTicks:!1,axisLabelArray:n,latex:!1})),g.points.map(((e,n)=>t.createElement("g",{key:`${r}_stack_plot_${n}`,transform:A(M(`${e.x}`),z(`${e.y}`))},t.createElement("rect",{width:N,height:T,stroke:"black",fill:"none"}),e.id&&t.createElement("text",{textAnchor:"middle",dy:T/1.5,dx:N/2},e.id))))))}function cl({data:e=[[1,2,3,4],[1,2,3],[4,5,6],[8,9],[7,3,2,5,8]],className:n="hago_jagged_array",id:i=S(n),width:r=300,height:a=r+100,fontSize:s=.8,scale:o=50,cwidth:l=o,cheight:h,marginTop:c=30,marginRight:u=30,marginBottom:d=30,marginLeft:m=30,margins:p=[c,u,d,m],padding:f=.3}){const g=k(r,a,p),y=ul(e),_=Fe().range([0,g.width]).domain(y.jaggedElementsArray.map((t=>`${t.group}`))),v=Fe().range([0,g.height]).domain(y.jaggedElementsArray.map((t=>`${t.id}`))).padding(f),w=_.bandwidth(),M=v.bandwidth();return t.createElement(x,{className:n,width:r,height:a,cwidth:l,cheight:h,margins:p},t.createElement(t.Fragment,null,y.jaggedIndicesArray.map(((e,n)=>t.createElement("g",{className:e.class,key:`jaggedIndex_${i}_${n}`,transform:A(-w/1.5,v(`${e.val}`))},t.createElement("text",{dy:M/(.9+s),dx:w/2,textAnchor:"middle",fontSize:s-.1+"rem"},e.val)))),y.jaggedElementsArray.map(((e,n)=>t.createElement("g",{key:`jaggedElement_${i}_${n}`,className:e.class,transform:A(_(`${e.group}`),v(`${e.id}`))},t.createElement("g",{className:"hago_JaggedArray_row_index"},t.createElement("text",{dy:M*(1+f),dx:w/2,fontSize:s-.1+"rem",textAnchor:"middle"},e.group)),t.createElement("rect",{stroke:"black",fill:"none",width:w,height:M}),t.createElement("text",{dx:w/2,dy:M/(.9+s),textAnchor:"middle",fontSize:`${s}rem`},e.val))))))}function ul(t){let e,n,i=[],r=[];for(let a=0;a<t.length;a++){e={val:a,class:"hago_jagged_array_index"},i.push(e);for(let e=0;e<t[a].length;e++)if(zt(t[a][e]))r.push(t[a][e]);else{if(!Ct(t[a][e]))throw new Error("Improper data format");n={val:t[a][e],id:a,group:e,class:"hago_jagged_array_element"},r.push(n)}}return{jaggedIndicesArray:i,jaggedElementsArray:r}}function dl({data:e=[[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,16]],className:n="hago_jagged_array",id:i=S(n),width:r=200,height:a=200,scale:s=100,cwidth:l=s,cheight:h,marginTop:c=30,marginRight:u=30,marginBottom:d=30,marginLeft:m=30,margins:p=[c,u,d,m],order:f="row"}){const g=k(r,a,p),y=o(e[0].length),_=ml(e,f),v=Fe().range([0,g.width]).domain(_.jaggedElementsArray.map((t=>`${t.group}`))).padding(.05),w=Fe().range([0,g.height]).domain(_.jaggedElementsArray.map((t=>`${t.id}`))).padding(.05),M=v.bandwidth(),b=w.bandwidth();return t.createElement(x,{className:n,width:r,height:a,cwidth:l,cheight:h,margins:p},t.createElement(t.Fragment,null,_.jaggedIndicesArray.map(((e,n)=>t.createElement("g",{className:"hago_matrix_row_index",key:`jaggedIndex_${i}_${n}`,transform:A(-10,w(`${e.val}`))},t.createElement("text",{fontSize:"0.6rem",dy:M/2,textAnchor:"end"},e.val)))),y.map(((e,n)=>t.createElement("g",{className:"hago_matrix_column_index",key:`jaggedIndex_${i}_${n}`,transform:A(v(`${n}`),0)},t.createElement("text",{fontSize:"0.6rem",dx:M/2,dy:-M/4,textAnchor:"middle"},e)))),_.jaggedElementsArray.map(((e,n)=>t.createElement("g",{key:`hago_matrix_element_${i}_${n}`,className:`hago_matrix_data ${e.class}`,transform:A(v(`${e.group}`),w(`${e.id}`))},t.createElement("rect",{stroke:"black",fill:"none",width:M,height:b}),t.createElement("text",{fontSize:"0.8rem",dx:M/2,dy:b/1.5,textAnchor:"middle"},e.val))))))}function ml(t,e){let n,i,r=[],a=[];for(let s=0;s<t.length;s++){n={val:s,class:"jagged_array_index"},r.push(n);for(let n=0;n<t[s].length;n++)if(zt(t[s][n]))a.push(t[s][n]);else{if(!Ct(t[s][n]))throw new Error("Improper data format");i={val:"row"===e?t[s][n]:t[n][s],id:s,group:n,class:"jagged_array_element"},a.push(i)}}return{jaggedIndicesArray:r,jaggedElementsArray:a}}function pl({data:e=(t=>t**2+1),className:n="hago_sequence",id:i=S(n),width:r=500,height:a=500,scale:s=100,cwidth:o=s,cheight:l,marginTop:h=40,marginRight:c=40,marginBottom:u=40,marginLeft:d=60,margins:m=[h,c,u,d],start:p=0,end:f=20,tickSep:g=50,removeEndTicks:y=!1,removeEndTickX:_=y,removeEndTickY:v=y}){const w=k(r,a,m),M=function(t,e,n){let i=0,r=[],a=e,s=e,o=e,l=e;if(B(t))for(let h=0;h<t.length;h++)if(Nt(t[h])){let c=t[h].f;for(let t=e;t<n;t++){let e=c(t);i+=e,l=Z(l,i),o=G(o,i),s=Z(s,t),a=G(a,t);let n={x:t,y:i,t:e};r.push(n)}}else{if(!Lt(t[h]))throw new Error("Improperly formatted array data");{let e={x:t[h].x,y:t[h].y};l=Z(l,i),o=G(o,i),s=Z(s,t[h].x),a=G(a,t[h].x),r.push(e)}}else{if(!P(t))throw new Error("Improperly formatted data.");for(let h=e;h<n;h++){let e=t(h);i+=e,l=Z(l,i),o=G(o,i),s=Z(s,h),a=G(a,h);let n={x:h,y:i,t:e};r.push(n)}}return{dataPoints:r,xMin:s,xMax:a,yMin:l,yMax:o}}(e,p,f),z=M.dataPoints,N=M.xMin,T=M.xMax,C=M.yMin,L=M.yMax,$=hi().domain([N,T]).range([0,w.width]),R=Fe().range([0,w.width]).domain(z.map((t=>`${t.x}`))).padding(.06).bandwidth(),I=hi().domain([C,L]).range([w.height,0]);return t.createElement(x,{className:n,width:r,height:a,cwidth:o,cheight:l,margins:m},t.createElement("g",{transform:A($(N),I(N))},t.createElement(b,{domain:[N,T],range:[0,w.width],tickSep:g,removeEndTicks:_,latex:!1,dy:u/2})),t.createElement(E,{domain:[C,L],range:[w.height,0],tickSep:g,removeEndTicks:v,textAnchor:"end",dx:-d/4,dy:2,latex:!1}),t.createElement("g",{className:"hago_sum_plot_points"},z.map(((e,n)=>t.createElement("g",{key:`hago_sum_${i}_${n}`},t.createElement(X,{start:{x:$(e.x),y:I(p)},end:{x:$(e.x),y:I(e.y)},strokeWidth:R,color:"tomato"}))))))}function fl(t,e,n){let i=e,r=e,a=e,s=n,o=[];if(!B(t))throw new Error("Improper data format.");for(let e=0;e<t.length;e++)if(Rt(t[e])){let n=t[e];i=Z(i,n.x),r=G(r,n.x),a=Z(a,n.y),s=G(s,n.y),o.push(t[e])}else if(Bt(t[e])){let n=t[e][0],l=t[e][1],h={x:n,y:l,g:e};i=Z(n,i),a=Z(l,a),r=G(n,r),s=G(l,s),o.push(h)}else{if(!B(t[e]))throw new Error("Improper array data format.");for(let n=0;n<t[e].length;e++){let l=t[e][e][n],h=t[e][e][n],c={x:l,y:h,g:e};i=Z(l,i),a=Z(h,a),r=G(l,r),s=G(h,s),o.push(c)}}return{xMin:i,xMax:r,yMin:a,yMax:s,dataPoints:o}}function gl(t){const e=t.length;let n=0,i=0,r=0,a=0,s=0,o=0;for(let s=0;s<e;s++){let e=t[s].x,o=t[s].y;n+=e,i+=o,r+=Math.pow(e,2),a+=e*o}let l=n/e,h=i/e,c=(a-n*h)/(r-n*l),u=h-c*l,d=u<0?"-":"+",m=t=>c*t+u;for(let n=0;n<e;n++){let e=t[n].y,i=m(e);s+=Math.pow(e-i,2),o+=Math.pow(s-h,2)}let p=1-s/o,f=`𝑅² = ${p}`;return{f:m,label:`𝑦 = ${c}𝑥 ${d} ${Math.abs(u)}`,rsquared:p,rsquaredLabel:f}}function yl({data:e=[[0,0],[0,1],[0,2],[0,8]],regression:n,r:i=2,className:r="hago_sequence",id:a=S(r),width:s=500,height:o=500,scale:l=100,cwidth:h=l,cheight:c,marginTop:u=30,marginRight:d=30,marginBottom:m=100,marginLeft:p=50,margins:f=[u,d,m,p],start:g=0,end:y=20,tickSep:_=50,removeEndTicks:v=!1,removeEndTickX:w=v,removeEndTickY:z=v}){const N=k(s,o,f),T=fl(e,g,y),C=T.dataPoints,L=T.xMin,$=T.xMax,P=T.yMin,R=T.yMax,B=hi().domain([L,$]).range([0,N.width]),I=hi().domain([P,R]).range([N.height,0]);let O;if("basicLinear"===n)O=gl(C);else O=!1;return t.createElement(x,{className:r,width:s,height:o,cwidth:h,cheight:c,margins:f},t.createElement("clipPath",{id:`${a}_scatter_clipPath`},t.createElement("rect",{width:N.width,height:N.height})),t.createElement("g",{transform:A(0,I(0))},t.createElement(b,{domain:[L,$],range:[0,N.width],tickSep:_,dy:m/4,removeEndTicks:w,latex:!1})),t.createElement("g",{transform:A(B(0),0)},t.createElement(E,{domain:[P,R],range:[N.height,0],tickSep:_,removeEndTicks:z,dy:_/10/2,dx:-p/4,latex:!1,textAnchor:"end"})),t.createElement("g",{className:"hago_sequence_plot_points"},C.map(((e,n)=>t.createElement("g",{className:e.className?e.className:"hago_plot_point",key:`${a}_${n}`},t.createElement("circle",{r:i,key:`${a}_${n}`,cx:B(e.x),cy:I(e.y),fill:"white",stroke:"black"})))),O?t.createElement(t.Fragment,null,t.createElement("g",{clipPath:`url(#${a}_scatter_clipPath)`},pe({f:O.f},B,I,1e3,[L,$],[P,R])),t.createElement("g",{transform:A(0,N.height+m/4)},t.createElement(M,{val:O.label,width:N.width,textAlign:"center"}),t.createElement(M,{val:O.rsquaredLabel,pos:{x:0,y:N.height/15},width:N.width,textAlign:"center"}))):t.createElement(t.Fragment,null)))}function xl({data:e=[["val1"],[],[],["val2","val3"],["val4","val5","val6"],["val7","val8","val9","val10","val11"],[],["val10"]],className:n="hago_HashTable",id:i=S(n),fontsize:a=.7,width:s=350,height:o=s,scale:h=70,cwidth:c=h,cheight:u,marginTop:d=50,marginRight:m=50,marginBottom:p=50,marginLeft:f=50,margins:g=[d,m,p,f],padding:y=.12}){const v=k(s,o,g),w=function(t){let e,n=[],i=0,r=[];for(let a=0;a<t.length;a++){let s=t[a];i=G(i,s.length),n.push({x:0,y:a}),0===s.length&&(e={val:"",group:a},r.push(e));for(let n=0;n<s.length;n++)e={val:t[a][n],group:a,id:n},r.push(e)}return{keys:n,values:r,xMax:i}}(e),M=w.keys,b=w.values,E=e.length,z=w.xMax,N=r().domain([0,E]).range([0,v.height]),T=r().domain([0,z]).range([0,v.width]),C=l().domain(b.map((t=>`${t.id}`))).range([0,v.width-50]).padding(y),L=C.bandwidth();return t.createElement(x,{className:n,width:s,height:o,cwidth:c,cheight:u,margins:g},t.createElement("defs",null,t.createElement(_,{id:"hash_table_pointer",refX:9}),t.createElement(U,{id:"hash_table_pointer_start",type:"circle",circleFillColor:"black",radius:4,refX:5,refY:5,width:6,height:6,cx:5,cy:5,viewbox:"0 0 10 10"})),M.map(((e,n)=>t.createElement("g",{key:`hk_${i}_${n}`,transform:A(T(0),N(e.y))},t.createElement("text",{dx:-L/4,dy:L/1.5,textAnchor:"end",fontSize:a-.1+"rem"},e.y),t.createElement("rect",{width:L,height:L,stroke:"black",fill:"none"}),t.createElement(X,{start:{x:L/2,y:L/2},end:{x:2*L+3*T(y),y:L/2},markerEnd:"hash_table_pointer",markerStart:"hash_table_pointer_start"})))),b.map(((e,n)=>e.id&&t.createElement("g",{key:`hv_${i}_${n}`,transform:A(T(y),N(e.group))},t.createElement("rect",{width:L,x:C(`${e.id}`),y:L/4,height:L/2,stroke:"black",fill:"none"}),t.createElement("text",{dx:C(`${e.id}`)+L/2,dy:L/1.5,textAnchor:"middle",fontSize:"0.7rem"},e.val)))))}function _l({data:e=[1,2,3,4,5,6,7,8,9],className:n="hago_queue",id:i=S(n),fontSize:r=.6,width:a=300,height:s=a,scale:o=100,cwidth:h=o,cheight:c=.5,marginTop:u=20,marginRight:d=50,marginBottom:m=20,marginLeft:p=50,margins:f=[u,d,m,p]}){const g=F(e),y=g.length,_=k(a,s,f),v=l().domain(g).range([0,_.width]),w=l().domain(g).range([_.height/2,0]),M=v.bandwidth(),b=w.bandwidth();return t.createElement(x,{className:n,width:a,height:s,cwidth:h,cheight:c,margins:f},t.createElement(X,{start:{x:-f[3]/4,y:b},end:{x:_.width+f[1]/4,y:b}}),g.map(((e,n)=>t.createElement("g",{key:`${i}_${n}`,transform:A(v(e),b)},t.createElement("rect",{width:M,height:b,fill:"white",stroke:"black"}),t.createElement("text",{textAnchor:"middle",dx:M/2,dy:b/1.5,fontSize:`${r}rem`},y-1-n),t.createElement("g",{className:"hago_Deque_indices"},t.createElement("g",{className:"hago_Dequeue_front_index"},t.createElement("text",{textAnchor:"middle",dx:M/2,dy:-b/2,fontSize:r-.1+"rem"},y-1-n)),t.createElement("g",{className:"hago_Dequeue_rear_index"},t.createElement("text",{textAnchor:"middle",dx:M/2,dy:2*b,fontSize:r-.1+"rem"},y-1-n)))))),t.createElement(X,{start:{x:-f[3]/4,y:2*b},end:{x:_.width+f[1]/4,y:2*b},shapeRendering:"geometricPrecision"}))}function vl({data:e=[{val:1,ant:"p"},2,3,4,{val:71,ant:"c"},6,7,8,9],index:n=!1,className:i="hago_queue",id:r=S(i),width:a=500,fontSize:s=.8,height:o=250,iradius:l=70,oradius:u=90,scale:d=100,cwidth:m=d,cheight:p,padding:f=.05,marginTop:g=50,marginRight:y=50,marginBottom:_=50,marginLeft:v=50,margins:w=[g,y,_,v]}){const M=h().padAngle(f).value((t=>t.data))(F(e)),b=k(a,o,w),E=c().innerRadius(l).outerRadius(u),z=c().innerRadius(l).outerRadius(1.5*u),N=c().innerRadius(l/1.5).outerRadius(l);return t.createElement(x,{className:i,width:a,height:o,cwidth:m,cheight:p,margins:w},M.map(((e,i)=>t.createElement("g",{key:`cq${r}_${i}`,transform:A(b.width/2,b.height/2)},t.createElement("path",{d:E(e),fill:"none",stroke:"black"}),t.createElement("g",{transform:`translate(${E.centroid(e)})`},t.createElement("text",{textAnchor:"middle",fontSize:`${s}rem`,dx:0,dy:3+s},e.data.val)),e.data.ant&&t.createElement("g",{transform:`translate(${z.centroid(e)})`},t.createElement("text",{textAnchor:"middle",fontSize:s-.1+"rem",dx:0,dy:2+s},e.data.ant)),n&&t.createElement("g",{transform:`translate(${N.centroid(e)})`},t.createElement("text",{textAnchor:"middle",fontSize:s-.1+"rem",dx:0,dy:2+s},i))))))}function wl(t){const[e,...n]=t;let i=[],r=t.length-1;for(let t=0;t<n.length;t++){let r=n[t],a=[];for(let t=0;t<r.length;t++){let n=r[t],i=[e[t],n];a.push(i)}i.push(a)}let a=[];for(let t=0;t<i.length;t++){let e=Object.fromEntries(i[t]);a.push(e)}return{headings:e,rows:n,dataset:a,sampleSize:r}}function Ml(t,e){let n=t.dataset.map((t=>t[e])),i=[];i.push(["Value","Cumulative Relative Frequency"]);let r=at(n);for(let t in r){let e=[t,r[t]];i.push(e)}return wl(i)}function bl(t,e){let n=t.dataset.map((t=>t[e])),i=[];i.push(["Value","Frequency"]);let r=it(n);for(let t in r){let e=[t,r[t]];i.push(e)}return wl(i)}function El(t,e){let n=t,i=n.sampleSize,r=n.dataset.map((t=>t[e])),a={},s=[];s.push(["Value","Relative Frequency"]);for(let t=0;t<r.length;t++){let e=r[t];e in a?a[e]+=1:a[e]=1}for(let t in a){let e=[t,a[t]/i];s.push(e)}return wl(s)}const kl=It((t=>t),["f"]);function Sl({data:e=[["x","y"],["A",5],["B",6],["C",3],["D",3],["E",2],["F",4],["G",7],["H",5]],className:n="hago_table",id:i=S(n),latex:r=!1,output:a=["raw"],include:s}){const o=r?e=>t.createElement(v,{val:e,block:!1}):t=>t;let l;if(kl(e)){let t=function(t){const e=t.f;if(B(e)){const n=t.step?t.step:1,i=e.length;let r=[],a=[];if(t.inputLabel){const e=t.inputLabel,n=e.length;for(let t=0;t<n;t++)r.push(e[t])}else r.push("x");if(t.fLabels){const e=t.fLabels,n=e.length;for(let t=0;t<n;t++)r.push(e[t])}else for(let t=0;t<i;t++){let e=`function ${t}`;r.push(e)}a.push(r);const s=t.domain&&2===t.domain.length?t.domain:[-10,10],o=s[0],l=s[1];for(let t=o;t<l;t+=n)a.push([t]);const h=a.length;for(let t=1;t<h;t++)for(let n=0;n<i;n++){let i=(0,e[n])(a[t][0]);a[t].push(i)}return a}throw new Error("Expected an array of functions.")}(e);l=wl(t)}else l=wl(function(t){if(Array.isArray(t[0]))return t;{let e=[["x","y"]];for(let n=0;n<t.length;n++){let i=[`${n}`,t[n]];e.push(i)}return e}}(e));let h=[];for(let t=0;t<a.length;t++){let e,n=a[t];if(Array.isArray(n)){if(2===n.length){let t=n[0],i=n[1];switch(t){case"frequency":e=bl(l,i);break;case"relative frequency":e=El(l,i);break;case"cumulative relative frequency":e=Ml(l,i)}}}else e=l;h.push(e)}if(s){const t=h.length-1;let e,n=h[t].rows.map((t=>t[1]));for(let i=0;i<s.length;i++){let r=s[i];if("mean"===r){e=["Mean",lt(n)],h[t].rows.push(e)}else if("max"===r){e=["Max",K(n).max],h[t].rows.push(e)}else if("min"===r){e=["Min",et(n).min],h[t].rows.push(e)}else if("median"===r){e=["Median",mt(n).median],h[t].rows.push(e)}}}return h.map(((e,r)=>{let a=e.headings,s=e.rows;return function(e,n,i,r,a,s){return t.createElement("div",{className:e,key:`ht${s}${i}`},t.createElement("table",null,function(e,n,i){return t.createElement("thead",null,function(e,n,i){return t.createElement("tr",null,e.map(((e,r)=>function(e,n,i,r){return t.createElement("th",{key:`th_${e}_${n}`},r(i))}(n,r,e,i))))}(e,n,i))}(n,i,r),function(e,n,i){return t.createElement("tbody",null,e.map(((e,r)=>function(e,n,i,r){return t.createElement("tr",{key:`tr_${e}_${n}`,className:`hago_row_${i[0]}`},i.map(((n,i)=>function(e,n,i,r){return t.createElement("td",{key:`td_${e}_${n}`},r(i))}(e,i,n,r))))}(n,r,e,i))))}(a,i,r)))}(n,a,i,o,s,r)}))}function Al({data:e=[[2,.15],[3,.25],[4,.15],[5,.3],[6,.1],[7,.05]],className:n="hago_histogram",id:i=S(n),width:a=500,height:s=500,scale:o=100,cwidth:h=o,cheight:c,marginTop:u=30,marginRight:d=30,marginBottom:m=30,marginLeft:p=50,margins:f=[u,d,m,p],tickSep:g=50,removeEndTicks:y=!1,removeEndTickX:_=y,removeEndTickY:v=y}){const w=function(t){let e=[];const n=t.length;for(let i=0;i<n;i++)if($t(t[i]))e.push(t[i]);else{let n={x:t[i][0],y:t[i][1]};e.push(n)}const i=e.map((t=>t.x)),r=e.map((t=>t.y)),a=nt(i),s=tt(i),o=et(r).min,l=K(r).max,h=st(n),c=[];let u=a;c.push(u);for(let t=1;t<e.length;t++)u+=h,c.push(u);return{dataset:e,minX:a,minY:o,maxX:s,maxY:l,intervalWidth:h,axisLabels:c}}(e),M=k(a,s,f),z=w.minX,N=w.maxX,T=w.minY,C=w.maxY,L=w.dataset,$=w.axisLabels,P=w.intervalWidth,R=l().range([0,M.width]).domain(L.map((t=>`${t.x}`))),B=R.bandwidth(),I=r().domain([T,C]).range([2,M.height]);return t.createElement(x,{className:n,width:a,height:s,cwidth:h,cheight:c,margins:f},t.createElement("g",{transform:A(0,M.height)},t.createElement(b,{domain:[z,N],range:[0,M.width],tickSep:30*P,tx:-B/2,dy:m/2,axisLabelArray:$,removeEndTicks:_,latex:!1})),t.createElement("g",null,t.createElement(E,{domain:[T,C],range:[M.height,0],tickSep:g,removeEndTicks:v,dy:g/10/2,dx:-p/4,latex:!1})),L.map(((e,n)=>t.createElement("g",{key:`hh${i}_${n}`,transform:A(R(`${e.x}`),M.height-I(e.y))},t.createElement("rect",{width:B,height:I(e.y),stroke:"black",fill:"none"}),t.createElement("text",{textAnchor:"middle",dx:B/2,dy:-2},e.y)))))}function zl({data:e=[1,2,3,4,5],className:n="LinkedList",id:i=S(n),width:r=30.1049*e.length+70.1515,height:a=40,scale:s=100,cwidth:o=s,cheight:l,marginTop:h=10,marginRight:c=40,marginBottom:u=10,marginLeft:d=20,margins:m=[h,c,u,d]}){const p=k(r,a,m),f=F(e),g=Fe().domain(f).rangeRound([0,p.width]).paddingInner(.5),y=g.bandwidth(),_=10,v=g.bandwidth()/3,w=t=>A(g(t),0),M=A(0,0),b=A(g.bandwidth()/3,0),E=A(g.bandwidth(),0),z=-y+(y+y/5),N=y/1.8-y,T=y+y/8,C=y+y/1.3;return t.createElement(x,{className:n,width:r,height:a,cwidth:o,cheight:l,margins:m},t.createElement("defs",null,t.createElement(U,{id:"DLinkedList_Arrowhead",refX:0,refY:0,width:3,height:3,orient:"auto"}),t.createElement(U,{id:"DLinkedList_LinkOrigin",type:"circle",circleFillColor:"black",radius:1,refX:3,refY:3,width:4,height:4,cx:3,cy:3,viewbox:"0 0 6 6"})),f.map(((e,n)=>t.createElement("g",{key:`dlk${i}_${n}`,transform:w(e)},t.createElement("g",{className:"prev_field",transform:M},t.createElement(Qt,{w:v,h:_}),t.createElement("g",{transform:A(y/1.5,_/1.3)},t.createElement("text",{fontSize:"0.45rem",textAnchor:"middle"},e.val))),t.createElement("g",{className:"data_field",transform:b},t.createElement(Qt,{w:y,h:_})),t.createElement("g",{className:"next_field",transform:E},t.createElement(Qt,{w:v,h:_})),t.createElement("g",{className:"prev_link"},t.createElement(X,{start:{x:z,y:6.666666666666667},end:{x:N,y:6.666666666666667},markerEnd:"DLinkedList_Arrowhead",markerStart:"DLinkedList_LinkOrigin"})),t.createElement("g",{className:"prev_link"},t.createElement(X,{start:{x:T,y:2.5},end:{x:C,y:2.5},markerEnd:"DLinkedList_Arrowhead",markerStart:"DLinkedList_LinkOrigin"}))))))}const Nl=It((t=>t),["val","p"]);function Tl(t){let e={};if(Array.isArray(t)){let n=[];const i=t.length;for(let r=0;r<i;r++){let i=t[r],a=i;if(Nl(i))!(`${a.p}`in e)&&(e[`${a.p}`]={}),a.order=a.order?a.order:r,n.push(a);else{let t=i.length;!(`${r}`in e)&&(e[`${r}`]={});for(let e=0;e<t;e++){let t={val:i[e],p:r,order:e};n.push(t)}}}return{output:n,priorities:Object.keys(e)}}throw new Error("Improper data format.")}function Cl({data:e=[[1,2,3,8,2],[7,5,0,1],[2,9,1,7],[1,9,8,0,3,5,6,8,9]],className:n="hago_PriorityQueue",id:i=S(n),fontSize:r=.6,width:a=400,height:s=400,scale:o=100,cwidth:l=o,cheight:h,marginTop:c=20,marginRight:u=50,marginBottom:d=20,marginLeft:m=50,margins:p=[c,u,d,m]}){const f=k(a,s,p),g=Tl(e),y=g.output,_=g.priorities,v=Fe().domain(y.map((t=>`${t.order}`))).range([0,f.width]).paddingInner(.1),w=Fe().domain(y.map((t=>`${t.p}`))).range([0,f.width/4]).paddingInner(.2),M=v.bandwidth(),b=w.bandwidth(),E=A(M/2,b/1.5),z=M/4,N=-p[3]/4;return t.createElement(x,{className:n,width:a,height:s,cwidth:l,cheight:h,margins:p},_.map(((e,n)=>t.createElement("g",{key:`pqp${i}_${n}`,transform:A(N,w(e)+b/2)},t.createElement("circle",{fill:"none",stroke:"black",r:z}),t.createElement("text",{fontSize:`${r}rem`,textAnchor:"middle",dy:z/2},e)))),y.map(((e,n)=>t.createElement("g",{key:`pqd${i}_${n}`,transform:A(v(`${e.order}`),w(`${e.p}`))},t.createElement(Qt,{w:M,h:b}),t.createElement("g",{className:"data_field",transform:E},t.createElement("text",{fontSize:`${r}rem`,textAnchor:"middle"},e.val))))))}function Ll(t){let e=[];for(let n=0;n<t.length;n++){let i=t[n],r={name:i.c,id:i.id?i.id:i.c,parentId:i.p,val:i.v,h:!!i.h&&i.h,i:`${n}`,className:i.className||"MTree_node"};e.push(r)}return e}function $l({data:e=[],className:n="hago_queue",id:i=S(n),fontSize:r=.7,kw:a=.8,edgeLength:s=100,width:o=500,height:h=o,scale:c=100,cwidth:m=c,cheight:p,marginTop:f=50,marginRight:g=50,marginBottom:y=50,marginLeft:_=50,margins:v=[f,g,y,_],nsep:w=[1,1.1]}){const{width:M,height:b}=k(o,h,v),E=Ll(e),z=u().id((t=>t.id)).parentId((t=>t.parentId))(E),N=s||W(z),T=z.height;p=p||Math.min(.1*(T+2),1);const C=d().size([M,N]).separation(((t,e)=>t.parent===e.parent?w[0]:w[1]));C(z);let L=z.links(),$=z.descendants();for(let t=0;t<$.length;t++){let e=$[t];e.val=e.data.val,e.h=e.data.h,e.className=e.data.className}const P=l().domain(E.map((t=>t.i))).range([0,M/(T/a)]),R=P.bandwidth();return t.createElement(x,{className:n,width:o,height:h,cwidth:m,cheight:p,margins:v},t.createElement("g",{className:"MTree_links"},L.map(((e,n)=>t.createElement("g",{key:`mtl${i}_${n}`},t.createElement("line",{x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y,display:e.h&&"none",stroke:"currentColor"}))))),t.createElement("g",{className:"MTree_nodes"},$.map(((e,n)=>t.createElement("g",{key:`mtn${i}_${n}`,transform:A(e.x,e.y)},e.val.map(((a,s)=>t.createElement("g",{key:`mtnk${i}${n}${s}`,transform:A(-R*e.val.length/2,0)},t.createElement("g",{transform:A(P(`${s}`),0)},t.createElement(Qt,{w:R,h:R,fill:"white"}),t.createElement("text",{textAnchor:"middle",fontSize:`${r}rem`,dx:R/2,dy:R/1.5},`${a}`))))))))))}function Pl(t){let e,n;if(t.isLeaf)e=t.height+1,n=t.height+1;else{let i=t.children[0],r=t.children[1];e=z(i)&&!i.h?i.height+1:0,n=z(r)&&!r.h?r.height+1:0}return e-n}const Rl=It((t=>t),["c","p"]);function Bl(t,e){let n=[],i={};for(let e=0;e<t.length;e++){let r=t[e];if(Rl(r)){let t={name:r.c,id:r.id?r.id:r.c,parentId:r.p,h:!!r.h&&r.h,i:`${e}`,className:r.className||"AVLTree_node"},a=`${t.parentId}`;""!==a&&(i[a]=i[a]||0,i[a]+=1),n.push(t)}}let r={},a=Object.keys(i);for(let t=0;t<a.length;t++){let s=a[t];1===i[s]&&(r={name:e,id:e,parentId:`${s}`,h:!0,i:`${t}`,className:"hidden_AVLTree_node"},n.push(r))}return n}function Il({data:e=[],className:n="hago_AVLTree",id:i=S(n),r:r=10,fontSize:a=.7,width:s=500,height:o=s/2,tw:l,th:h,scale:c=100,cwidth:f=c,cheight:g,marginTop:y=50,marginRight:_=50,marginBottom:v=50,marginLeft:w=50,narrow:M=50,margins:b=[y,_,v,w],layout:E="vertical",cluster:z=!0,sibsep:N=1,nsibsep:T=1.1,render:C=["bf","h"]}){b=[b[0],b[1]+M,b[2],b[3]+M];const{width:L,height:$}=k(s,o,b),P=Bl(e,i),R=C.includes("bf"),B=C.includes("h"),I=u().id((t=>t.id)).parentId((t=>t.parentId))(P);h=h||$,l=l||L;const O=(z?p:d)().size([l,h]).separation(((t,e)=>t.parent===e.parent?N:T));O(I);let D=I.links(),F=I.descendants();for(let t=0;t<F.length;t++){let e=F[t];e.h=e.data.h,e.className=e.data.className,e.isLeaf=!e.children,e.hbf=Pl(e),e.name=e.data.name}for(let t=0;t<D.length;t++){let e=D[t];e.h=e.source.data.h||e.target.data.h}const V=m().x((t=>"horizontal"===E?t.y:t.x)).y((t=>"horizontal"===E?t.x:t.y)),j=t=>"horizontal"===E?A(t.y,t.x):A(t.x,t.y);return t.createElement(x,{className:n,width:s,height:o,cwidth:f,cheight:g,margins:b},t.createElement("g",{className:"AVLTree_links"},D.map(((e,n)=>!e.h&&t.createElement("g",{key:`avL${i}_${n}`},t.createElement("path",{d:V(e),fill:"none",stroke:"black"}))))),t.createElement("g",{className:"AVLTree_nodes"},F.map(((e,n)=>!e.h&&t.createElement("g",{key:`avN${i}_${n}`,transform:j(e)},R&&t.createElement("text",{textAnchor:"middle",fontSize:`${a}rem`,dx:0,dy:-r-2},`${e.hbf}`),B&&t.createElement("text",{textAnchor:"middle",fontSize:`${a}rem`,dx:0,dy:2*r},`${e.height}`),t.createElement("circle",{r:r,stroke:"black",fill:"white"}),t.createElement("text",{textAnchor:"middle",fontSize:`${a}rem`,dx:0,dy:r/2.5},`${e.name}`))))))}function Ol(t,e){return`translate(${e.x} ${e.y}) rotate(${t} ${e.y} ${e.x})`}function Dl({className:e="Hago_Surface",width:n=500,height:i=500,scale:r=100,cwidth:a=r,domain:s=[-10,10],range:o=[-10,10],xTicks:l=10,yTicks:h=10,cheight:c,marginTop:u=30,marginRight:d=30,marginBottom:m=30,marginLeft:p=30,margins:f=[u,d,m,p]}){const{width:g,height:y}=k(n,i,f),_=10*l,v=10*h,w=hi().domain(s).range([0,g]),M={x:0,y:hi().domain(o).range([y,0])(0)},S={x:w(0),y:0};return t.createElement(x,{className:e,width:n,height:i,cwidth:a,cheight:c,margins:f},t.createElement("g",{transform:A(M.x,M.y)},t.createElement(b,{domain:s,range:[0,g],tickSep:_,dx:0,dy:20,latex:!1})),t.createElement("g",{transform:A(S.x,S.y)},t.createElement(E,{domain:s,range:[y,0],dy:5,dx:-10,tickSep:v,latex:!1})),t.createElement("g",{transform:Ol(-45,{x:M.x,y:M.y})},t.createElement(b,{domain:s,range:[0,g],tickSep:_,dx:0,dy:20,latex:!1})))}function Fl(t,e,n,i){if("number"==typeof t)return`${t}`;if(null===t)return"{\\text{DNE}}";if(1===t.length&&1===t[0].length)return`~~${t[0][0]}~~`;let r=i?i+=`= \\begin{${n}}`:`\\begin{${n}}`;e=`${e}em`;const a=t.length,s=t[0].length;for(let n=0;n<a;n++){r+=`${t[n][0]}`;for(let e=1;e<s;e++){let i=t[n][e];i!==1/0&&i!==-1/0||(i="\\text{undefined}"),r+=e%2!=0?e!==s-1?`& ${i} &`:`& ${i}`:`${i}`}r+=n!==a-1?` \\\\[${e}]`:""}return r+=`\\end{${n}}`,r}class Vl{constructor(t){this._matrix=t}matrix(){return this._matrix}rowCount(){return this._matrix.length}isSquare(){return this.colCount()===this.rowCount()}colCount(){const t=this.matrix()[0].length,e=this.rowCount();for(let n=0;n<e;n++){if(this._matrix[n].length!==t)return-1}return t}op(t,e){const n=this.matrix(),i=t._matrix,r=[],a=this.rowCount(),s=t.rowCount();for(let t=0;t<a;t++){const a=[];for(let r=0;r<s;r++){const s=e(n[t][r],i[t][r]);a.push(s)}r.push(a)}return new Vl(r)}similar(t,e){const n=t.rowCount(),i=e.rowCount(),r=t.colCount(),a=e.colCount();return n===i&&r===a}verify_same_order(t,e){const n=t.rowCount(),i=e.rowCount(),r=t.colCount(),a=e.colCount();if(-1===r||-1===a)throw new Error("LogicError: Matrix operands are not of the same order. Jagged matrix passed.");if(n!==i)throw new Error("LogicError: Matrix operands are not of the same order. Unequal columns.")}verify_dot_productability(t,e){const n=t.colCount(),i=e.rowCount(),r=n===i,a=1===e.rowCount()&&1===i,s=this.similar(t,e);if(!(r||a||s))throw new Error("LogicError: Invalid operands.")}verify_productability(t,e){const n=e.rowCount(),i=t.colCount(),r=e.colCount();if(-1===i||-1===r)throw new Error("LogicError: Matrix operands are not of the same order. Jagged matrix passed.");if(i!==n)throw new Error("LogicError: First matrix column count not equal to second matrix row count.")}add(t){return this.verify_same_order(this,t),this.op(t,((t,e)=>t+e))}sub(t){return this.verify_same_order(this,t),this.op(t,((t,e)=>t-e))}divide(t){return this.op(t,((t,e)=>t/e))}isConstant(t){return t.colCount()===t.rowCount()}constantOp(t){const e=this.colCount(),n=this.rowCount();let i=this.matrix();for(let r=0;r<n;r++)for(let n=0;n<e;n++)i[r][n]=t(this._matrix[r][n]);return new Vl(i)}vectorOp(t,e,n){const i=t.colCount(),r=e.rowCount();let a=t.matrix(),s=e.matrix();for(let t=0;t<r;t++){let e=s[t][0];for(let r=0;r<i;r++)a[t][r]=n(a[t][r],e)}return new Vl(a)}dotProduct(t){if(this.verify_dot_productability(this,t),this.similar(this,t))return this.op(t,((t,e)=>t*e));if(this.isConstant(t)){const e=t.matrix()[0][0];return this.constantOp((t=>t*e))}return this.vectorOp(this,t,((t,e)=>t*e))}modulo(t){return this.op(t,((t,e)=>t%e))}matrixProduct(t){this.verify_productability(this,t);const e=this.matrix(),n=t.matrix(),i=this.rowCount(),r=this.colCount(),a=t.colCount(),s=[];for(let t=0;t<i;++t){let t=[];for(let e=0;e<a;++e)t.push(0);s.push(t)}for(let t=0;t<i;++t)for(let i=0;i<a;++i)for(let a=0;a<r;++a)s[t][i]=s[t][i]+e[t][i]*n[a][i];return new Vl(s)}power(t){return this.op(t,((t,e)=>t**e))}matrixMinor(t=0,e=0){if(!this.isSquare())throw new Error("LogicError: Matrix minors are only defined for square matrices.");if(t>this.rowCount()||t<=0)throw new Error("ArgumentError: Invalid row index.");if(e>this.colCount()||e<=0)throw new Error("ArgumentError: Invalid column index.");let n=[];const i=this.rowCount(),r=this.colCount();for(let a=0;a<i;a++){if(a===t-1)continue;let i=[];for(let t=0;t<r;t++)t!==e-1&&i.push(this._matrix[a][t]);n.push(i)}return new Vl(n)}cofactor(){let t=0;const e=this.rowCount();for(let n=0;n<e;n++){t+=(-1)**n*this._matrix[0][n]*this.matrixMinor(1,n+1).determinant()}return t}determinant(){const t=this._matrix,e=this.rowCount(),n=this.colCount();if(2===e&&2===n){return t[0][0]*t[1][1]-t[0][1]*t[1][0]}return this.cofactor()}comatrix(){if(!this.isSquare())throw new Error("LogicError: Comatrices are not defined for non-square matrices.");let t=[];const e=this.rowCount(),n=this.colCount();if(2===e&&2===n){const e=this.determinant();return t.push([e]),new Vl(t)}for(let n=0;n<e;n++){let i=[];for(let t=0;t<e;t++){const e=(-1)**(n+t)*this.matrixMinor(n+1,t+1).determinant();i.push(e)}t.push(i)}return new Vl(t)}adjugate(){return this.comatrix().transpose()}inverse(){if(!this.isSquare())throw new Error("LogicError: Inverses are not defined for non-square matrices.");const t=this.determinant();if(0===t)return null;const e=this.rowCount(),n=this.colCount();if(2===e&&2===n){const e=this._matrix[1][1]/t,n=-1*this._matrix[0][1]/t,i=-1*this._matrix[1][0]/t,r=this._matrix[0][0]/t;return new Vl([[e,n],[i,r]])}let i=[];const r=this.adjugate().rowCount();for(let e=0;e<r;e++)for(let n=0;n<r;n++)i[e][n]=i[e][n]/t;return new Vl(i)}transpose(){const t=this.rowCount(),e=this.colCount(),n=this._matrix;let i=[];for(let r=0;r<e;r++){let e=[];for(let i=0;i<t;i++){const t=n[i][r];e.push(t)}i.push(e)}return new Vl(i)}}function jl(e,n,i,r,a){let s="=";const o={add:{type:"add",symbol:"+"},sub:{type:"sub",symbol:"-"},divide:{type:"divide",symbol:"\\div"},dotProduct:{type:"dotProduct",symbol:"{\\Large\\cdot}"},matrixProduct:{type:"matrixProduct",symbol:"\\times"},modulo:{type:"modulo",symbol:"\\text{rem}"},power:{type:"power",symbol:"*"},transpose:{type:"transpose",symbol:"^{\\text{T}}"},matrixMinor:{type:"matrixMinor",symbol:"_{\\text{Minor}}"},determinant:{type:"determinant",symbol:""},inverse:{type:"inverse",symbol:"^{-1}"},comatrix:{type:"comatrix",symbol:"^{\\text{C}}"},adjugate:{type:"adjugate",symbol:"^{\\text{A}}"}}[n],l=(h=e,t.Children.toArray(h));var h;const c=l.length,u=l[0];let d=u.props.originalType.displayName;let m,p=[],g=o.symbol;if(l[0].props.data){let t=l[0].props.data;p.push(t),m=new Vl(t)}if(1===c)"matrixMinor"===o.type?(m=m[o.type](r,a),g=`{\\large M_{${r},${a}}}`):m=m[o.type](),"determinant"===o.type&&(d="Determinant");else for(let t=1;t<c;t++)if(l[t].props.data){let e=l[t].props.data;p.push(e);const n=new Vl(e);m=m[o.type](n)}const y="number"==typeof m||null===m?m:m.matrix();null===m&&(s="\\implies");const x=function(t,e,n,i,r,a="="){let s="";const o=t.length;if("left"===r){s=n+Fl(t[0],.1,e)}else if("right"===r){s=Fl(t[0],.1,e)+n}else for(let i=0;i<o;i++){const r=Fl(t[i],.1,e);s+=i%o!=0?n+r:r}s+=a;const l=Fl(i,.1,e);return s+=l,s}(p,eh[d],g,y,i,s);return t.createElement(f,{math:x,block:!0})}function ql({children:t}){return jl(t,"add")}function Hl({children:t}){return jl(t,"sub")}function Ul({children:t}){return jl(t,"divide")}function Wl({children:t}){return jl(t,"dotProduct")}function Yl({children:t}){return jl(t,"matrixProduct")}function Xl({children:t}){return jl(t,"modulo")}function Zl({children:t}){return jl(t,"power")}function Gl({children:t}){return jl(t,"transpose","right")}function Jl({children:t,row:e,col:n}){return jl(t,"matrixMinor","left",e,n)}function Ql({children:t}){return jl(t,"adjugate","right")}function Kl({children:t}){return jl(t,"inverse","right")}function th({children:t}){return jl(t,"comatrix","right")}const eh={Pmatrix:"pmatrix",BoxMatrix:"bmatrix",Determinant:"vmatrix",Norm:"Vmatrix",BracedMatrix:"Bmatrix"};function nh({data:e=[[1,2,3],[4,5,6],[8,9,10]],linespace:n=.3,name:i}){const r=Fl(e,n,"pmatrix",i);return t.createElement(f,{math:r,block:!0})}function ih({data:e=[[1,2,3],[4,5,6],[8,9,10]],linespace:n=.3,name:i}){const r=Fl(e,n,"bmatrix",i);return t.createElement(f,{math:r,block:!0})}function rh({data:e=[[1,2,3],[4,5,6],[8,9,10]],linespace:n=.3,name:i,children:r}){if(r)return jl(r,"determinant");const a=Fl(e,n,"vmatrix",i);return t.createElement(f,{math:a,block:!0})}function ah({data:e=[[1,2,3],[4,5,6],[8,9,10]],linespace:n=.3,name:i}){const r=Fl(e,n,"Vmatrix",i);return t.createElement(f,{math:r,block:!0})}function sh({data:e=[[1,2,3],[4,5,6],[8,9,10]],linespace:n=.3,name:i}){const r=Fl(e,n,"Bmatrix",i);return t.createElement(f,{math:r,block:!0})}function oh({x:e=[1,2,3,4],y:n=[1,2,3,4],className:i="CartProd",id:r=S(i)}){const a=[];for(let t=0;t<e.length;t++){let i=[];for(let r=0;r<n.length;r++)i.push([e[t],n[r]]);a.push(i)}return t.createElement("table",{className:"hago_CartProd"},t.createElement("tbody",null,t.createElement("tr",null,t.createElement("td",{style:{visibility:"hidden"}}),n.map(((e,n)=>t.createElement("td",{key:`${r}y${n}`,className:"y_variable"},e)))),a.map(((e,n)=>t.createElement("tr",{key:`${r}c${n}`},t.createElement("td",{className:"x_variable"},e[0][0]),e.map((e=>t.createElement("td",{key:`${r}d${n}`},`(${e[0]}, ${e[1]})`))))))))}function lh({data:e=[2,"a",3,"b",1,1,"a"],pointers:n={}}){const i=function(t,e){const n=t.length;let i=["\\begin{array}{:"];for(let t=0;t<n;t++)i.push("c:");i.push("}");for(let t=0;t<n;t++)e[t]||t===n-1?t===n-1?e[t]?i.push(`${e[t]}`):i.push("~"):i.push(`${e[t]} &`):i.push("~ &");i.push("~\\\\ \\hdashline ");for(let e=0;e<n;e++)e===n-1?i.push(`${t[e]} \\\\ \\hdashline`):i.push(`${t[e]} & `);for(let t=0;t<n;t++)t===n-1?i.push(`{\\scriptsize ${t}} \\\\`):i.push(` {\\scriptsize ${t}} & `);return i.push("\\end{array}"),i.join("")}(e,n);return t.createElement("div",{className:"hago_Array"},t.createElement(f,{math:`${i}`}))}function hh({data:e=[[0,0],[1,0],[1,1],[1,2],[1,3],[1,4],[2,4],[2,5],[3,5],[3,6],[4,6],[4,7],[5,7],[6,7],[7,7],[7,8],[8,8],[8,9],[9,9]],className:n="Hago_Lattice",id:i=S(n),width:r=300,height:a=300,xMax:s=10,yMax:o=10,scale:l=100,cwidth:h=l,cheight:c,marginTop:u=10,marginRight:d=10,marginBottom:m=10,marginLeft:p=10,margins:f=[u,d,m,p]}){const g=k(r,a,f),y=hi().domain([0,s]).range([0,g.width]),_=hi().domain([0,o]).range([g.height,0]);let v=[],w=s>o?s:o;for(let t=0;t<w;t++)for(let e=0;e<w;e++)v.push({r:3,fill:"none",stroke:"black",cx:t,cy:e});let M=[];for(let t=0;t<e.length-1;t++){let n=e[t][0],i=e[t][1],r=e[t+1][0],a=e[t+1][1];M.push({x1:n,y1:i,x2:r,y2:a,stroke:"black",width:1})}return t.createElement(x,{className:n,width:r,height:a,cwidth:h,cheight:c,margins:f},t.createElement("g",{className:"Hago_Lattice_Path"},M.map(((e,n)=>t.createElement("line",{x1:y(e.x1),y1:_(e.y1),x2:y(e.x2),y2:_(e.y2),stroke:e.stroke,strokeWidth:e.width,id:`latticeLine${i}${n}`})))),t.createElement("g",{className:"Hago_Lattice_Point"},v.map(((e,n)=>t.createElement("circle",{r:e.r,fill:e.fill,stroke:e.stroke,cx:y(e.cx),cy:_(e.cy),id:`LatticeCircle${i}${n}`})))))}function ch(t,e){let n=t;if(t.d&&(n=t.d),e)return`{\\boxed{~${n}~}}{\\mathclap{~}{\\rightleftarrows}}`;if(t.d){let e="\\longrightarrow";return t.p&&(e="\\nearrow"),`{\\boxed{~${n}~}}{\\mathclap{~}{${e}}}`}return`{\\boxed{~${n}~}}{\\mathclap{~}{\\longrightarrow}}`}function uh(t){return`\\overset{\\normalsize{${t}}}`}function dh({data:e=[2,3,4,5],pointers:n={},double:i=!1}){const r=function(t,e,n){const i=t.length;let r=[];for(let a=0;a<i;a++)e[a]&&r.push(uh(e[a])),r.push(ch(t[a],n));return r.push("\\varnothing"),r.join("")}(e,n,i);return t.createElement("div",{className:"hago_Array"},t.createElement(f,{math:r}))}export{Il as AVLTree,Ql as Adjugate,lh as Arr,_ as ArrowHead,b as AxisHorizontal,E as AxisVertical,x as Board,ih as BoxMatrix,sh as BracedMatrix,Bl as BuildAVLTreeNodes,Ll as BuildMTreeNodes,Tl as BuildPriorityQueueData,oh as CartProd,Qt as Cell,vl as CircularQueue,th as Comatrix,Sl as DataTable,_l as Deque,rh as Determinant,Wl as DotProduct,zl as DoublyLinkedList,ol as Graph,xl as HashTable,Al as Histogram,Kl as Inverse,P as IsAFunction,Tt as IsALinkObject,Lt as IsANamedPoint,$t as IsAPoint,Bt as IsATupleXY,B as IsAnArray,At as IsAnEdgeObject,St as IsBinaryTreeNode,z as IsDefined,ct as IsEven,ht as IsInteger,Ct as IsLiteral,T as IsNonNull,C as IsNull,_t as IsOdd,Nl as IsPriorityQueueDatum,Pt as IsRegisterObject,N as IsUndefined,zt as IsaDatum,Nt as IsaFunctionDatum,R as IsaNumber,Rt as IsaScatterDatumObject,L as IsaString,cl as JaggedArray,hh as Lattice,X as Line,gl as LinearRegression,mo as LinkedList,dh as List,$l as MTree,ul as MakeJaggedArrayData,ml as MakeMatrixData,fl as MakeScatterData,U as Marker,v as Maths,dl as Matrix,Hl as MatrixDifference,Jl as MatrixMinor,Xl as MatrixModulo,Zl as MatrixPower,Yl as MatrixProduct,Ul as MatrixQuotient,ql as MatrixSum,yo as Mem,yi as Multiplot,ah as Norm,vt as Normalize,Jt as Path,we as Plot,Os as Plot3D,nh as Pmatrix,ci as Polar,Cl as PriorityQueue,po as Queue,dt as Quicksort,G as ReturnLarger,Z as ReturnSmaller,yl as Scatter,ll as Sequence,I as SetClassName,O as SetConditionalValue,di as Stack,hl as StackPlot,co as StaticArray,It as StructGuard,pl as Sum,Dl as Surface,M as Text,wt as ToBinary,Mt as ToHex,A as Translate,Gl as Transpose,ho as Tree,W as calculateTreeSize,D as formatStackData,j as generateBinaryTreeData,F as generateElements,V as generateTreeData,tt as getConvenientEndPoint,nt as getConvenientStartingPoint,at as getCumulativeRelativeFrequencies,it as getFrequencies,st as getIntervalWidth,kt as getLowestFraction,K as getMax,Q as getMaxPrecision,lt as getMean,mt as getMedian,et as getMin,pt as getMinPrecision,ft as getMostPrecise,yt as getMostPreciseMax,xt as getMostPreciseMin,J as getPrecision,gt as getPrecisionBoundedList,rt as getRelativeFrequencies,ot as getSum,$ as isObjectLiteral,S as makeId,Y as shouldHide,k as svg};
